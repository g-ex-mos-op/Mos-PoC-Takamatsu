<html xmlns:m="http://www.seasar.org/maya" m:extends="/jsf/layout/layoutNoNavi.html" m:action="#{accounteditCheckAction.initialize}">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>アカウント情報変更（編集画面）</title>
</head>
<body>
<span m:converter="#{characterEncodingConverter}" m:inject="f:param" m:name="layoutTitle" m:value="#{accounteditDto.gamenTitle}（編集画面）"/>
<span m:inject="s:insert" m:name="bodyTitleName">■アカウント情報変更（編集画面）</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBA001V04"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load();"/>
<span m:inject="s:insert" m:name="body">
<STYLE type="text/css">
 <!--
table.body_table2 tr td.putInnerTable, table.body_table2 tr th.putInnerTable {
	padding:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2, table.body_table2 tr th.putInnerTable table.body_table2 {
	width        :100%;
	border-width :0px;
	margin       :-1px;
	border-spacing:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2 tr td, table.body_table2 tr th.putInnerTable table.body_table2 tr th{
	border-right-width :0px;
	border-bottom-width :0px;
}
-->
</STYLE>
<SCRIPT LANGUAGE="javascript">
<!--
function load() {
	focusElement("accountInput");
}

function inputControl(checkElm, index) {
	var statusFlg = (checkElm.checked ==false);
	if(document.accountInput.elements['onerCd'].length >= 2) {
		document.accountInput.elements['onerCd'][index].readOnly = statusFlg;
		document.accountInput.elements['searchOnerBtn'][index].disabled = statusFlg;
		if(statusFlg) {
			document.accountInput.elements['onerCd'][index].value = "";
		}
	} else {
		document.accountInput.elements['onerCd'].readOnly = statusFlg;
		document.accountInput.elements['searchOnerBtn'].disabled = statusFlg;
		if(statusFlg) {
			document.accountInput.elements['onerCd'].value = "";
		}
	}
}
/**
 * オーナー選択ボタン処理
 */
function searchOner(companyCd) {
	//オーナーコード設定処理
	settingOnerCd();
	var onerSearchAnchorId = "";
	var objs = document.accountInput.getElementsByTagName('a');
	for (i = 0; i < objs.length; i++) {
		var classNm = objs[i].className;
		var startIndex = classNm.indexOf('searchOnerAnchor');
		if(startIndex >= 0) {
			classNm = classNm.substring(startIndex);
			if(classNm.indexOf(companyCd) >= 0){
				onerSearchAnchorId = objs[i].id;
				break;
			}
		}
	}
	document.accountInput.onerSearchCompanyCd.value=companyCd;
	document.accountInput.elements['accountInput:__link_clicked__'].value="accountInput:searchOner";
	document.accountInput.submit();
	return false;
}
/**
 * オーナーコード設定処理
 *
 */
function settingOnerCd() {
	var objs = document.accountInput.getElementsByTagName('input');
	for (i = 0; i < objs.length; i++) {
		var idNm = objs[i].id;
		var startIndex = idNm.indexOf('userOnerCd');
		if(startIndex >= 0) {
			idNm = idNm.substring(startIndex-2,startIndex-1);
			//オーナーコードのエレメントの場合、
			//テキストエリアで入力された値を設定します。
			var elementCompanys = document.accountInput.onerCd;
			for(c = 0; c<elementCompanys.length; c++) {
				var companyCd = elementCompanys[c].value;
				if(idNm == c){
					objs[i].value=document.accountInput.elements['onerCd'][c].value;
					break;
				}
			}//end of for
		}
	}
}
//-->
</SCRIPT>

<form m:id="accountInput" onKeyDown="return setDefaultSubmitButton('accountInput','executeBt')";>
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" m:id="windowId" m:value="#{accounteditReqDto.windowId}"/>
	<input type="hidden" m:id="sessionKey" m:value="#{accounteditReqDto.sessionKey}"/>
	<input type="button" value="戻る" m:action="#{accounteditCheckAction.back}"/>&nbsp;&nbsp;
	<input type="button" value="確認" m:id="executeBt" class="operation_button" m:action="#{accounteditCheckAction.update_check}" onClick="settingOnerCd();" />
	<a m:id="searchOner" m:action="#{accounteditCheckAction.searchOner}"/>
	<input type="hidden" name="onerSearchCompanyCd" value="" m:passthrough="true"/>
	<div m:inject="s:forEach" m:items="#{accounteditDto.userOnerList}" m:var="bm06" m:varindex="i">
		<input type="hidden" id="userOnerCd" m:value="#{bm06.onerCd}"/>
	</div>
	<table class="body_table2" style="margin-top:4px;width:910px;border-bottom-width:0px;">
	<tr>
		<th style="width:180px;">ユーザータイプ</th>
		<td colspan="3" width="721px">オーナー</td>
	</tr>
	<tr>
		<th>ユーザーID (アカウント)</th>
		<td><span m:inject="h:outputText" m:value="#{accounteditDto.uIUser.userId}" />
			&nbsp;&nbsp;<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" style="color:red;" m:value="#{accounteditDto.pwLockMsg}"/></td>
	    <th>ロック解除</th>
		<td><input type="checkbox" m:value="#{accounteditDto.pwLockResetFlg}"/>&nbsp;&nbsp;ロック解除</td>
	</tr>
	<tr>
		<th>ご利用者名</th>
		<td><input m:id="userNameKj" class="imeon width_235" type="text" m:maxlength="40" size="45"
		           m:value="#{accounteditDto.uIUser.userNameKj}" /></td>
		<th>ご利用者名(カナ)</th>
		<td><input m:id="userNameKana" class="imeon width_235" type="text" m:maxlength="20" size="45"
		           m:value="#{accounteditDto.uIUser.userNameKana}" /></td>
	</tr>
	<tr>
		<th>会社</th>
		<td colspan="3">
			<div m:inject="s:forEach" m:items="#{accounteditDto.userOnerList}" m:var="bm06" m:varindex="i">
			<input type="checkbox" onclick="inputControl(this, '#{i}')" value="#{bm06.checked}"/>
			<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{bm06.companyName}"/>&nbsp;&nbsp;
			</div>
		</td>
	</tr>
	<div m:inject="s:forEach" m:items="#{accounteditDto.userOnerScreenList}" m:var="list1Row" m:varindex="r">
	<tr>
		<div m:inject="s:forEach" m:items="#{list1Row}" m:var="bm06" m:varindex="i">
			<th m:rendered="#{i==0}" style="width:180px;">
				<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{bm06.companyName}"/>
				<br/>オーナーコード&nbsp;
			</th>
		</div>
		<td colspan="3" class="putInnerTable">
		<table class="body_table2">
			<tr>
			<div m:inject="s:forEach" m:items="#{list1Row}" m:var="bm06" m:varindex="i">
				<th m:rendered="#{i>=1}" style="width:140px;">
					<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{bm06.companyName}"/>
					<br/>オーナーコード&nbsp;
				</th>
				<td style="width:#{i==2?'*':'140'}px; border-bottom-width:1px;" >
					<input type="text" name="onerCd" m:value="#{bm06.onerCd}"
					       size="15" m:maxlength="5" class="imenotuse width_86"  readonly="#{bm06.checked==false}"
					       m:converter="#{accounteditCodeConverter}" m:passthrough="true" /><br/>
					       <input type="button" name="searchOnerBtn" value="オーナー選択" class="width_90"
				            onClick="searchOner('#{bm06.companyCd}');"
				            onDblClick="return false;"
				            disabled="#{bm06.checked==false}" m:passthrough="true"/>
					</td>
				</div>
			</tr>
		</table>
		</td>
	</tr>
	</div>
		<tr class="non_top_border">
			<th style="width:180px;">業態</th>
			<td style="border-right-width:0px;">
		  		<div m:inject="s:forEach" m:items="#{accounteditDto.userGyotaiList}" m:var="e" m:varindex="i">
	        	<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.gyotaiName}"/><br/>
		  		</div>
			</td>
			<td colspan="2" style="border-left-width:0px;">
		  	<input type="button"  m:id="gyoutaiButton"
			                                    value="業態選択"
			       m:action="#{accounteditCheckAction.businessSearch}" onClick="settingOnerCd();"/>&nbsp;<input type="button" value="クリア"
		  	       m:action="#{accounteditCheckAction.businessDelete}" onClick="settingOnerCd();"/>
			</td>
		</tr>
		<tr>
			<th width="180px">ご請求フラグ</th>
			<td colspan="3" width="721px">
			<span m:inject="s:selectOneRadio2" m:value="#{accounteditDto.uIUser.sekyuFlg}">
				<input type="radio" m:value="1"/>請求する
				<input type="radio" m:value="2"/>請求しない
			</span>
			</td>
		</tr>
	</table>
	<table class="body_table2" style="width:910px;border-top-width:0px;">
		<tr class="non_top_border">
			<th width="180px">ご請求開始日</th>
			<td width="160px"><input m:id="seikyuDt"
			           type="text" m:value="#{accounteditDto.uIUser.seikyuDt}"
			           m:maxlength="10" size="15" class="imenotuse width_85"/></td>
			<th width="154px">ご請求変更予定日</th>
			<td width="155px"><input m:id="seikyuUpdtDt"
			           type="text" m:value="#{accounteditDto.uIUser.seikyuUpdtDt}"
			            m:maxlength="10" size="15" class="imenotuse width_85"/></td>
			<th width="135px">お申込日</th>
			<td  width="105px"><input m:id="appliedDt"
			           type="text" m:value="#{accounteditDto.uIUser.appliedDt}"
			            m:maxlength="10" size="15" class="imenotuse width_85" /></td>
		</tr>
		<tr>
			<th width="180px">メールアドレス</th>
			<td colspan="3" width="435px"><input m:id="mailAdd"
			                       type="text" m:value="#{accounteditDto.uIUser.mailAdd}"
			                       m:maxlength="60" size="60" class="imenotuse width_310"/></td>
			<th width="135px">ご利用停止</th>
			<td width="105px"><input type="checkbox" m:value="#{accounteditDto.checkStopFLg}"/>&nbsp;&nbsp;使用停止</td>
		</tr>
		<tr class="non_top_border">
			<th >パスワードリセット</th>
	        <td><input id="password" type="password" m:size="20" style="height:15px;"  class="width_140"
	      	           m:value="#{accounteditDto.userPassWordImple}"/></td>
	        <th>確認用パスワード</th>
	        <td><input id="password2" type="password" m:size="20" style="height:15px;" class="width_140"
	    	           m:value="#{accounteditDto.userPassWordKakuninImple}"/></td>
		    <th class="font_size_15">マトリクスリセット</th>
		    <td><input type="checkbox" m:value="#{accounteditDto.matrixResetFlg}"/>&nbsp;&nbsp;リセット</td>
		</tr>
	</table>
	<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>

</body>
</html>
