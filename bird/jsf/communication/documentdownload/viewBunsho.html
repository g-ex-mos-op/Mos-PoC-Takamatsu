<html xmlns:m="http://www.seasar.org/maya" m:action="#{documentDownloadAction.initialize}" m:extends="/jsf/layout/layout.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>情報共有（文書）</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="情報共有（文書）"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
<span m:inject="s:insert" m:name="naviarea" m:src="/jsf/communication/documentdownload/cateNavi.html"/>
<span m:converter="#{characterEncodingConverter}" m:inject="s:insert" m:name="bodyTitleName">■情報共有（文書）<span m:converter="#{characterEncodingConverter}" m:value="#{documentDownloadDto.viewCateName}"></span></span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCM003V01"/>
<span m:inject="s:insert" m:name="body">
<script type="text/javascript">
<!--
function load(){
	focusElement("documentDownload");
}
function setViewIndex(index) {
    document.documentDownload.elements["documentDownload:indexEntityViewDetail"].value=index;
}
function downloadMode(index) {
    document.documentDownload.elements["documentDownload:downloadMode"].value=index;
}
function downloadFile(index) {
    downloadMode(2);
    document.documentDownload.elements["documentDownload:downloadFileIndex"].value=index;
}



//-->
</script>
<STYLE type="text/css" media="screen">
    <!--
table.header_table{
  width				: 97%;
}
table.body_table2{
  width				: 97%;
}

.list_tab_pane {
    width               : 97%;
}
.list_tab {
    width               : 24.5%;
}

.scroll_area {
	height				: 182px;
	width				: 100%;
}
div.scroll_detaile_area {
	overflow				: auto;
	height				: 133px;
	width				: 100%;
	margin-top:-2px;
}
/** 発信元幅 */
.col_puborgname {
	width				: 170px;
}

@media print {
.scroll_area {
}
div.scroll_detaile_area {
	height					: auto;
	overflow				: visible;
}
//-->
</STYLE>

<form m:id="documentDownload">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="indexEntityViewDetail" m:value="#{documentDownloadDto.indexEntityViewDetail}"/>
<input type="hidden" m:id="downloadMode" m:value="#{documentDownloadDto.downloadMode}"/>
<input type="hidden" m:id="downloadFileIndex" m:value="#{documentDownloadDto.downloadFileIndex}"/>

<!-- 検索条件 -->
<table width="100%" cellpadding="0" cellspacing="0">
	<tr valign="top">
		<td>
			<div class="search_condition">
				<table class="body_table">
				    <tr>
				        <th>タイトル</th>
				        <td>
				            <input class="imeon" type="text" m:value="#{documentDownloadDto.condTitle}" m:maxlength="80" m:size="52"/>
				            <input type="submit" value="検索" class="operation_button" m:action="#{documentDownloadAction.searchByTitle}" onDblClick="return false;"/>
				        </td>
				    </tr>
				</table>
			</div>
		</td>
        <!-- ページ操作 -->
        <div m:rendered="#{documentDownloadDto.viewListFlg}">
		<td align="right" valign="bottom">
                <input type="submit" value="最初へ" m:action="#{documentDownloadAction.changePage}" m:disabled="#{documentDownloadDto.firstPage}">
                    <span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentDownloadDto.firstPageNumber}"/>
                </input>
                <input type="submit" value="前へ" m:action="#{documentDownloadAction.changePage}" m:disabled="#{!documentDownloadDto.existPreviousPage}">
                    <span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentDownloadDto.previousPageNumber}"/>
                </input>
                <input type="submit" value="次へ" m:action="#{documentDownloadAction.changePage}" m:disabled="#{!documentDownloadDto.existNextPage}">
                    <span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentDownloadDto.nextPageNumber}"/>
                </input>
                <input type="submit" value="最後へ" m:action="#{documentDownloadAction.changePage}" m:disabled="#{documentDownloadDto.lastPage}">
                    <span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentDownloadDto.lastPageNumber}"/>
                </input>
                &nbsp;
                <span m:value="#{documentDownloadDto.currentPageNumber}"/> / <span m:value="#{documentDownloadDto.lastPageNumber}"/>&nbsp;ページ
		</td>
		</div>
	</tr>
</table>
<div m:rendered="#{documentDownloadDto.viewListFlg}">
<!--カテゴリー検索の場合 -->
<div m:rendered="#{documentDownloadDto.searchMode == 1}">
    <div class="list_tab_pane" style="margin-top:7px;">
        <ul class="list_tab_area">
            <div m:inject="s:forEach" m:items="#{documentDownloadDto.listSubCate}" m:var="e" m:varindex="i">
                <li class="list_tab">
                    <div m:rendered="#{e.subCateId == documentDownloadDto.condSubCateId}" class="selected_tab">
                            <span m:converter="#{characterEncodingConverter}" m:value="#{e.subCateName}"/>
                    </div>
                    <div m:rendered="#{e.subCateId != documentDownloadDto.condSubCateId}">
                        <a m:action="#{documentDownloadAction.changeTab}" class="list_tab">
                            <span m:converter="#{characterEncodingConverter}" m:value="#{e.subCateName}"  />
                            <span m:inject="f:param" m:name="condSubCateId" m:value="#{e.subCateId}"/>
                        </a>
                    </div>
                </li>
            </div>
        </ul>
        <ul class="list_tab_area">
            <table width="100%" cellspacing="0" cellpadding="0">
                <tr style="height:5px;"><td class="body_caption"></td></tr>
            </table>
        </ul>
    </div>
    <table class="body_table2">
	    <tr class="header_row">
	        <th width="*">登録タイトル一覧</th>
	        <th width="100px">関連ファイル</th>
	        <th width="200px">発信元</th>
	    </tr>
    </table>
    <div class="scroll_area">
        <table class="body_table2">
            <div m:inject="s:forEach" m:items="#{documentDownloadDto.listBunsho}" m:var="e" m:varindex="i">
                <tr>
                    <td width="*">
                        <a m:action="#{documentDownloadAction.viewDetail}" m:onClick="setViewIndex(#{i})">
                            <span m:converter="#{characterEncodingConverter}" m:value="#{e.title}"/>
                        </a>
                    </td>
                    <td width="100px" align="center">
                    	<span m:value="#{(e.listDownloadFileSize != 0) == true ? '有' : '無'}"/>
                    </td>
                    <td width="200px">
                    	<span m:converter="#{characterEncodingConverter}" m:value="#{e.pubOrgName}"/>
                    </td>
                </tr>
            </div>
        </table>
    </div>
</div>

<!--タイトル検索の場合 -->
<div m:rendered="#{documentDownloadDto.searchMode == 2}">
<table class="header_table" cellspacing="0" style="margin-top:10px;">
    <tr>
        <td class="body_caption" colspan=2>検索結果一覧</td>
    </tr>
</table>
<!-- 文書一覧 -->
    <table class="body_table2">
	    <tr class="header_row">
	        <th width="110px">カテゴリー</th>
	        <th width="110px">サブカテゴリー</th>
	        <th width="*">登録タイトル一覧</th>
	        <th width="100px">関連ファイル</th>
	        <th class="col_puborgname">発信元</th>
	    </tr>
    </table>
    <div class="scroll_area">
        <table class="body_table2">
            <div m:inject="s:forEach" m:items="#{documentDownloadDto.listBunsho}" m:var="e" m:varindex="i">
                <tr>
                    <td width="110px">
                        <span m:converter="#{characterEncodingConverter}" m:value="#{e.cateName}"/>
                    </td>
                    <td width="110">
                        <span m:converter="#{characterEncodingConverter}" m:value="#{e.subCateName}"/>
                    </td>
                    <td width="*">
                        <a m:action="#{documentDownloadAction.viewDetail}" m:onClick="setViewIndex(#{i})">
                            <span m:converter="#{characterEncodingConverter}" m:value="#{e.title}"/>
                        </a>
                    </td>
                    <td width="100px" align="center">
                    	<span m:value="#{(e.listDownloadFileSize != 0) == true ? '有' : '無'}"/>
                    </td>
                    <td class="col_puborgname">
                    	<span m:converter="#{characterEncodingConverter}" m:value="#{e.pubOrgName}"/>
                    </td>
                </tr>
            </div>
        </table>
    </div>
</div>

<div m:rendered="#{documentDownloadDto.entityViewDetail != null}">
    <table class="header_table" cellspacing="0" style="margin-top:7px;">
        <tr>
            <td class="body_caption" colspan=2>文書内容</td>
        </tr>
    </table>
<div class="scroll_detaile_area">
    <table class="body_table2">
        <tr>
            <th width="130px">選択文書タイトル</th>
            <td width="*">
                <a m:action="#{documentDownloadFileDownlodAction.download}" title="#{documentDownloadDto.entityViewDetail.fileName}" m:onclick="downloadMode(1)">
                    <span m:converter="#{characterEncodingConverter}" m:value="#{documentDownloadDto.entityViewDetail.title}"/>
                </a>
            </td>
        </tr>
        <tr>
            <th>公開対象</th>
            <td>
            	<span m:converter="#{characterEncodingConverter}" m:value="#{documentDownloadDto.viewShozoku}"/>
            </td>
        </tr>

        <tr>
        	<th>関連ファイル</th>
        	<td>
	        	<div m:rendered="#{documentDownloadDto.entityViewDetail.listDownloadFileSize != 0}">
					<table cellpadding="0" cellspacing="0">
						<tr>
							<td>
					<div class="hideArea">
	                    <select class="condition_field"
	                            m:value="#{documentDownloadDto.viewSelectedAttachFileIndex}"
	                            m:items="#{documentDownloadDto.entityViewDetail.listDownloadFile}"
	                            m:itemValue="value"
	                            m:itemLabel="label"
	                            m:nullLabel="">
	                    </select>
                   </div>
							</td>
							<td>
	                    <input type="button" value="ダウンロード" class="operation_button" m:action="#{documentDownloadFileDownlodAction.download}" m:onclick="downloadMode(3)">
	                        <span m:converter="#{characterEncodingConverter}" m:inject="f:param" m:name="selectedIndex" m:value="#{documentDownloadDto.selectIndex}"/>
	                    </input>
							</td>
						</tr>
					</table>
 	        	</div>
        	</td>
        </tr>
        <tr>
            <th>発信元</th>
            <td><span m:converter="#{characterEncodingConverter}" m:value="#{documentDownloadDto.entityViewDetail.pubOrgName}"/></td>
        </tr>
        <tr>
            <th>掲載期間</th>
            <td><span m:value="#{documentDownloadDto.entityViewDetail.pubDateFrom}" m:converter="#{dateConverter}"/>〜
                <span m:value="#{documentDownloadDto.entityViewDetail.pubDateTo}" m:converter="#{dateConverter}"/>
            </td>
        </tr>
        <tr>
            <th>説明</th>
            <td><span m:value="#{documentDownloadDto.entityViewDetail.discription}" m:converter="#{changeLineRefConverter}" m:escape="false"/></td>
        </tr>
    </table>
</div>
</div>
</div>
<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>
</body>
</html>
