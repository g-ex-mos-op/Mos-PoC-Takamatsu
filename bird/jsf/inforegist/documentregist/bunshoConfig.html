<html xmlns:m="http://www.seasar.org/maya" m:action="#{documentRegistRegistAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>情報共有（文書登録）（編集画面）</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="情報共有（文書登録）（編集画面）"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load();"/>
<span m:inject="s:insert" m:name="bodyTitleName">■情報共有（文書登録）（編集画面）</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BIF003V02"/>
<span m:inject="s:insert" m:name="body">
<SCRIPT LANGUAGE="javascript">
<!--
function onChangeCate() {
    document.docRegist.elements['docRegist:__link_clicked__'].value='docRegist:changeCategory';
	document.forms['docRegist'].submit();
	return false;
}
function load(){
}
function upload(index) {
	document.docRegist.elements["docRegist:uploadIndex"].value=index;
}
function downloadKanren(index) {
	document.docRegist.elements["docRegist:downloadKanrenIndex"].value=index;
}
//-->
</SCRIPT>
<STYLE type="text/css">
 <!--
table.body_table2 tr td.putInnerTable, table.body_table2 tr th.putInnerTable {
	padding:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2, table.body_table2 tr th.putInnerTable table.body_table2 {
	width        :100%;
	border-width :0px;
	margin       :-1px;
	border-spacing:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2 tr td, table.body_table2 tr th.putInnerTable table.body_table2 tr th{
	border-right-width :0px;
}
-->
</STYLE>

<form m:id="docRegist" enctype="multipart/form-data" onKeyDown="return setDefaultSubmitButton('docRegist','dummyEnter');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="uploadIndex" m:value="#{documentRegistRegistFormDto.uploadIndex}"/>
<input type="hidden" m:id="downloadKanrenIndex" m:value="#{documentRegistRegistFormDto.downloadKanrenIndex}"/>
<a m:id="changeCategory" m:action="#{documentRegistRegistAction.changeCategory}"/>
<input type="button" value="戻る" class="operation_button" m:action="#{documentRegistRegistAction.cancel}"/>&nbsp;
<input type="button" value="確認" class="operation_button" m:action="#{documentRegistRegistAction.regist}"/>&nbsp;
<!-- タブ -->
<!-- 文書内容 -->

	<table class="body_table2" style="width:885px;margin-top:4px;border-bottom-width:0px;">
		<!--登録モード-->
		<tr>
			<th width="160px">登録モード</th>
			<td colspan="4" width="716px">
				<span m:converter="#{characterEncodingConverter}" m:value="#{documentRegistConditionDto.regModeName}"/>
			</td>
		</tr>
		<!--カテゴリー-->
		<tr>
			<th width="160px">カテゴリー</th>
			<td colspan="2">
				<div class="hideArea">
					<select m:id="bunshoCate"
							m:value="#{uiBunshoInfo.cateId}"
							m:items="#{documentRegistRegistFormDto.listCategory}"
							m:itemValue="cateId"
							m:itemLabel="cateName"
							m:onchange="onChangeCate()">
						<option value="">カテゴリ１</option>
						<option value="">カテゴリ２</option>
						<option value="">カテゴリ３</option>
					</select>
				</div>
			</td>
			<th width="120px" class="width_130">サブカテゴリー</th>
			<td width="267px">
				<div class="hideArea">
					<select class="condition_field"
					        m:id="bunshoSubCate"
							m:value="#{uiBunshoInfo.subCateId}"
							m:items="#{documentRegistRegistFormDto.listSubCategory}"
							m:itemValue="subCateId"
							m:itemLabel="subCateName">
						<option value="">サブカテゴリ１</option>
						<option value="">サブカテゴリ２</option>
						<option value="">サブカテゴリ３</option>
					</select>
				</div>
			</td>
		</tr>
		<!--タイトル-->
		<tr>
			<th>タイトル</th>
			<td colspan="4">
				<input class="imeon width_570" m:id="bunshoTitle" type="text" m:value="#{uiBunshoInfo.title}" m:maxlength="40" m:size="100"/>
			</td>
		</tr>
		<!--説明-->
		<tr>
			<th>説明</th>
			<td colspan="4">
				<textarea class="width_580" m:rows="5" m:id="bunshoDiscription" m:cols="75" wrap="soft"
				          m:value="#{uiBunshoInfo.discription}"
				          m:converter="#{changeLineEditConverter}"></textarea>
			</td>
		</tr>
		<!--文書ファイル登録-->
		<tr>
			<th rowspan="2" nowrap="true">文書ファイル登録</th>
			<td colspan="4" class="putInnerTable">
				<div class="divManeTableLeft">
					<span m:inject="x:inputFileUpload" id="uploadFile"
					      m:value="#{documentRegistRegistFormDto.uploadedMainFile}"
					      m:size="80"  m:disabled="#{!documentRegistRegistFormDto.addMainFile}"></span>
				</div>
				<div class="divManeTable">
						<input type="button" value="決定" m:onclick="upload(1)"
							           m:action="#{documentRegistRegistAction.uploadMainFile}"
							           m:disabled="#{!documentRegistRegistFormDto.addMainFile}"/>
				</div>
			</td>
		</tr>
		<tr>
			<td colspan="4" class="putInnerTable">
				<div class="divManeTableLeft">
					<span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.fileName}"></span>
				</div>
				<div class="divManeTable">
						<input type="button" value="削除" m:onclick="upload(1)"
						       m:action="#{documentRegistRegistAction.deleteMainFile}"/>
				</div>
			</td>
		</tr>
		<!--既存文書にリンク-->
		<tr>
			<th rowspan="#{documentRegistRegistFormDto.listKanrenBunshoSize+1}"
			   >既存文書にリンク</th>
			<th style="width:20px;"></th>
			<th colspan="3">タイトル
					<input type="button" m:value="リンクファイル選択" m:action="#{documentRegistRegistAction.callFormKanrenBunsho}"/>
					<input type="button" m:value="削除" m:action="#{documentRegistRegistAction.deleteKanrenBunsho}"/></th>
		</tr>
		<div m:inject="s:forEach" m:items="#{documentRegistRegistFormDto.listKanrenBunsho}" m:var="e" m:varindex="i">
		<tr>
			<td style="width:20px;text-align:center;">
				<input type="checkbox" m:value="#{e.checkedDoc}"/></td>
			<td colspan="3">
				<a m:action="#{documentRegistDownloadKanrenAction.download}" onClick="downloadKanren(#{i})">
					<span m:converter="#{characterEncodingConverter}" m:value="#{e.title}" m:title="#{e.fileName}"/></a>
			</td>
		</tr>
		</div>
<!--添付ファイル-->
	<tr>
	    <th rowspan="5" width="160px">添付ファイル登録</th>
	    <th colspan="2" width="323px">添付ファイルタイトル</th>
	    <td colspan="2" widht="*"></td>
	</tr>
	<tr>
		<td colspan="2"><input class="imeon width_280" id="uploadFileTenpuTitle" type="text"
		           m:value="#{documentRegistRegistFormDto.attachName}"
		           m:maxlength="40" m:size="53"/></td>
		<td colspan="2" class="putInnerTable">
			<div class="divManeTableLeft">
				<span m:inject="x:inputFileUpload" id="uploadFileTenpu"
			    	  m:value="#{documentRegistRegistFormDto.uploadedAttachFile}"
			      	m:size="33" m:disabled="#{!documentRegistRegistFormDto.addAttachFile}"></span>
			</div>
			<div class="divManeTable">
				<input type="button" value="決定"
				       m:action="#{documentRegistRegistAction.uploadAttachFile}"
				       m:disabled="#{!documentRegistRegistFormDto.addAttachFile}"/>&nbsp;
				<input type="button" value="削除"
	                   m:action="#{documentRegistRegistAction.deleteAttachFile}"/>&nbsp;
            </div>
		</td>
	</tr>
	<tr>
		<td style="width:20px;text-align:center;">
			<input type="checkbox" m:value="#{documentRegistRegistFormDto.cmbDelFlg1}"/>
		</td>
		<td style="width:300px;"><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachName1}"/></td>
		<td colspan="2"><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachFl1}"/>&nbsp;</td>
	</tr>
	<tr>
		<td align="center">
			<input type="checkbox" m:value="#{documentRegistRegistFormDto.cmbDelFlg2}" title=""/>
		</td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachName2}"/></td>
		<td colspan="2"><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachFl2}"/>&nbsp;</td>
	</tr>
	<tr>
		<td align="center">
			<input type="checkbox" m:value="#{documentRegistRegistFormDto.cmbDelFlg3}" title=""/>
		</td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachName3}"/></td>
		<td colspan="2"><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.attachFl3}"/>&nbsp;</td>
	</tr>
</table>
<table class="body_table2" style="width:885px;border-top-width:0px;">
		<tr class="non_top_border">
			<th width="160px" class="width_157_f" colspan="2">掲載期間FROM</th>
			<td width="160px">
				<div class="hideArea">
					<select m:id="bunshoFrom"
							m:value="#{uiBunshoInfo.pubDateFrom}"
							m:items="#{documentRegistRegistFormDto.listFrom}"
							m:itemValue="value"
							m:itemLabel="label" >
					</select>
				</div>
			</td>
			<th width="110px">掲載期間TO</th>
			<td width="109px">
				<div class="hideArea">
					<select class="condition_field"
					        m:id="bunshoTo"
							m:value="#{uiBunshoInfo.pubDateTo}"
							m:items="#{documentRegistRegistFormDto.listTo}"
							m:itemValue="value"
							m:itemLabel="label" >
						<option value="">2006/01/01</option>
					</select>
				</div>
			</td>
			<th width="109px">登録者</th>
			<td width="*"><span m:converter="#{characterEncodingConverter}" m:value="#{uiBunshoInfo.userNameKj}"/></td>
		</tr>
		<tr>
			<th rowspan="5" class="width_68_f" style="width:67px;">公開対象</th>
			<th class="width_85_f" width="87px">会社</th>
			<td colspan="2" width="273px">
			    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlCompany}" m:var="e" m:varindex="i">
			    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.companyName}"/></div>
			    </div>
			</td>
			<td rowspan="5" width="109px">
			<input type="button" m:value="公開対象選択"
				       m:action="#{documentRegistRegistAction.callForm}"/>
				       </td>
			<td rowspan="5" colspan="2"></td>
		</tr>
		<tr>
			<th>所属</th>
			<td colspan="2">
			    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlShozoku}" m:var="e" m:varindex="i">
			    	<span m:converter="#{characterEncodingConverter}" m:value="#{e.shozokuName}"/><br/>
			    </div>
			</td>
		</tr>
		<tr>
			<th>業態</th>
			<td colspan="2">
			    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlGyotai}" m:var="e" m:varindex="i">
			    	<span m:converter="#{characterEncodingConverter}" m:value="#{e.gyotaiKbnName}"/><br/>
			    </div>
			</td>
		</tr>
		<tr>
			<th>業態別設定</th>
			<td colspan="2">
				<div m:rendered="#{publicTargetDto.listTrnControlGyotaiKobetuSize > 0}">有</div>
				<div m:rendered="#{publicTargetDto.listTrnControlGyotaiKobetuSize <= 0}">無</div>
			</td>
		</tr>
		<tr>
			<th>個店別設定</th>
			<td colspan="2">
                <div m:rendered="#{publicTargetDto.listTrnControlGyotaiTenpoSize > 0}">
                    <span style="float:left;">有</span>
                    <span style="float:right;"><input type="button"  m:value="指定店舗ダウンロード" m:action="#{documentregistCsvAction.download}"/></span>
                    <span style="clear:both;"/>
                </div>
				<div m:rendered="#{publicTargetDto.listTrnControlGyotaiTenpoSize <= 0}">無</div>
			</td>
		</tr>
	</table>


<script type="text/javascript">
<!--
	focusElement("docRegist");
-->
</script>
<input type="text" m:id="dummyEnter" style="display:none"/>

</form>
</span>
</body>
</html>
