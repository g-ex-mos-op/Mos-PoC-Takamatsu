<html xmlns:m="http://www.seasar.org/maya" m:action="#{notificationRegistAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html" >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>お知らせ登録（編集画面）</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="お知らせ登録（編集画面）"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load();"/>
<span m:inject="s:insert" m:name="bodyTitleName">■お知らせ登録（編集画面）</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BIF002V02"/>
<span m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
.col_checkbtn {
	width				: 20px;
}
table.body_table2 tr td.putInnerTable, table.body_table2 tr th.putInnerTable {
	padding:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2, table.body_table2 tr th.putInnerTable table.body_table2 {
	width        :100%;
	border-width :0px;
	margin       :-1px;
	border-spacing:0px;
}
table.body_table2 tr td.putInnerTable table.body_table2 tr td, table.body_table2 tr th.putInnerTable table.body_table2 tr th{
	border-right-width :0px;
}

-->
</style>
<SCRIPT LANGUAGE="javascript">
<!--
function load(){
}
function upload(index) {
	document.notificationRegist.elements["notificationRegist:uploadIndex"].value=index;
}
function downloadKanren(index) {
	document.notificationRegist.elements["notificationRegist:downloadKanrenIndex"].value=index;
}
//-->
</SCRIPT>
<STYLE type="text/css" media="screen">
<!--
-->
</STYLE>

<form m:id="notificationRegist" enctype="multipart/form-data" onKeyDown="return setDefaultSubmitButton('notificationRegist','dummyEnter');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="uploadIndex" m:value="#{notificationRegistFormDto.uploadIndex}"/>
<input type="hidden" m:id="downloadKanrenIndex" m:value="#{notificationRegistFormDto.downloadKanrenIndex}"/>
<input type="button" value="戻る" class="operation_button" m:action="#{notificationRegistAction.cancel}" m:immediate="true"/>&nbsp;
<input type="button" value="確認" class="operation_button" m:action="#{notificationRegistAction.regist}" />&nbsp;
<table class="body_table2" style="width:890px;margin-top:4px;border-bottom-width:0px;">
	<tr>
		<th width="165px">登録モード</th>
		<td colspan="3" width="716px">
			<span m:converter="#{characterEncodingConverter}" m:value="#{notificationRegistConditionDto.regModeName}"/>
		</td>
	</tr>
	<tr>
		<th>カテゴリー</th>
		<td colspan="3">
			<div class="hideArea">
			    <select class="field_category"
			            m:id="cateId"
		    			m:value="#{uiTutatuInfo.cateId}"
                	    m:items="#{notificationRegistFormDto.listCategory}"
	                    m:itemValue="cateId"
    	               	m:itemLabel="cateName">
        	        <option value="">全社</option>
            	    <option value="">モスフードサービス</option>
	            </select>
			</div>
		</td>
	</tr>
	<tr>
		<th>タイトル</th>
		<td colspan="3">
			<input class="imeon width_480" type="text" m:id="titlename"
			       m:value="#{uiTutatuInfo.title}" m:maxlength="40" m:size="100" /></td>
	</tr>
	<tr>
		<th>サブタイトル</th>
		<td colspan="3">
			<input class="imeon width_480" m:id="subtitle" type="text"
			       m:value="#{uiTutatuInfo.subTitle}" m:maxlength="40" m:size="100"/></td>
	</tr>
	<tr>
		<th rowspan="2">お知らせファイル登録</th>
		<td colspan="3" class="putInnerTable">
			<div class="divManeTableLeft">
				<span m:converter="#{characterEncodingConverter}" m:inject="x:inputFileUpload" id="uploadFile" m:value="#{notificationRegistFormDto.uploadedMainFile}" m:size="80" m:disabled="#{!notificationRegistFormDto.addMainFile}"></span>
			</div>
			<div class="divManeTable">
				<input type="button" value="決定" m:onclick="upload(1)" m:action="#{notificationRegistAction.uploadMainFile}" m:disabled="#{!notificationRegistFormDto.addMainFile}"/>
			</div>
		</td>
	</tr>
	<tr>
		<td colspan="3" class="putInnerTable">
			<div class="divManeTableLeft">
				&nbsp;&nbsp;<span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.fileName}"></span>
			</div>
			<div class="divManeTable">
				<input type="button" value="削除" m:onclick="upload(1)" m:action="#{notificationRegistAction.deleteMainFile}"/>
			</div>
		</td>
	</tr>
	<tr class="non_top_border">
		<th rowspan="#{notificationRegistFormDto.listKanrenBunshoSize+1}"
		    width="165px">既存文書にリンク</th>
		<th colspan="3" width="716px">タイトル
			<input type="button" m:value="リンクファイル選択" m:action="#{notificationRegistAction.callFormKanrenBunsho}"/>
			<input type="button" m:value="削除" m:action="#{notificationRegistAction.deleteKanrenBunsho}"/>
		</th>
	</tr>
	<span m:rendered="#{notificationRegistFormDto.listKanrenBunshoSize > 0}">
	<div  m:inject="s:forEach" m:items="#{notificationRegistFormDto.listKanrenBunsho}" m:var="e" m:varindex="i">
	<tr>
		<td class="col_checkbtn"><input type="checkbox" m:value="#{e.checkedDoc}"/></td>
		<td colspan="2" width="693px">
			<a m:action="#{notificationRegistDownloadKanrenAction.download}" onClick="downloadKanren(#{i})">
				<span m:converter="#{characterEncodingConverter}" m:value="#{e.title}"/></a>
		</td>
	</tr>
	</div>
	</span>
<!--添付ファイル-->
	<tr>
	    <th rowspan="5" width="165px">添付ファイル登録</th>
	    <th colspan="2" width="318px">添付ファイルタイトル</th>
	    <td widht="*"></td>
	</tr>
	<tr>
		<td colspan="2">
          <input class="width_285" type="text" m:id="attachName" style="margin:0px;"
                 m:value="#{notificationRegistFormDto.attachName}"
                 m:disabled="#{!notificationRegistFormDto.addAttachFile}"
                 m:maxlength="40" m:size="53" />
		</td>
		<td>
		  <span m:converter="#{characterEncodingConverter}" m:inject="x:inputFileUpload" id="uploadFileTenpu" m:value="#{notificationRegistFormDto.uploadedAttachFile}"
		        m:disabled="#{!notificationRegistFormDto.addAttachFile}" m:size="33"/>
     	  <input type="button" type="button" value="決定" m:action="#{notificationRegistAction.uploadAttachFile}" m:disabled="#{!notificationRegistFormDto.addAttachFile}"/>&nbsp;
          <input type="submit" value="削除" m:action="#{notificationRegistAction.deleteAttachFile}"/>
		</td>
	</tr>
	<tr>
		<td width="20px"><input type="checkbox" m:value="#{notificationRegistFormDto.cmbDelFlg1}" title=""/></td>
		<td width="295px"><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachName1}"/></td>
		<td width="*"><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachFl1}"/></td>
	</tr>
	<tr>
		<td><input type="checkbox" m:value="#{notificationRegistFormDto.cmbDelFlg2}" title=""/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachName2}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachFl2}"/></td>
	</tr>
	<tr>
		<td><input type="checkbox" m:value="#{notificationRegistFormDto.cmbDelFlg3}" title=""/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachName3}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.attachFl3}"/></td>
	</tr>
</table>
<table class="body_table2" style="width:890px;border-top-width:0px;">
	<tr class="non_top_border">
		<th colspan="2" width="165px">公開開始日</th>
		<td width="125px">
			<div class="hideArea">
				<select m:id="nengetu"
						m:value="#{uiTutatuInfo.pubDate}"
						m:items="#{notificationRegistFormDto.listKokaiKaisi}"
						m:itemValue="value"
						m:itemLabel="label">
					<option value="">選択</option>
				</select>
			</div>
		</td>
		<th width="125px">お知らせ管理No</th>
		<td width="124px"><input m:id="kanriNo" type="text" m:value="#{uiTutatuInfo.kanriNo}"
		           size="18" m:maxlength="24"  class="imenotuse width_100"/></td>
		<th width="57px">登録者</th>
		<td width="273px"><span m:converter="#{characterEncodingConverter}" m:value="#{uiTutatuInfo.userNamekj}">海山 太郎</span></td>
	</tr>
	<tr class="non_top_border">
		<th style="width:70px;" rowspan="5">公開対象</th>
		<th style="width:92px;">会社</th>
		<td width="247px" colspan="2">
		    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlCompany}" m:var="e" m:varindex="i">
		    	<span m:converter="#{characterEncodingConverter}" m:value="#{e.companyName}"/><br/>
		    </div>
		</td>
		<td rowspan="5">
			<input type="submit" value="公開対象選択" m:action="#{notificationRegistAction.callForm}"/>
		</td>
		<td  rowspan="5" colspan="2"></td>
	</tr>
	<tr>
		<th>所属</th>
		<td colspan="2">
		    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlShozoku}" m:var="e" m:varindex="i">
		    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.shozokuName}"/></div>
		    </div>
  		</td>
	</tr>
	<tr>
		<th>業態</th>
		<td colspan="2">
		    <div m:inject="s:forEach" m:items="#{publicTargetDto.listTrnControlGyotai}" m:var="e" m:varindex="i">
		    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.gyotaiKbnName}"/></div>
		    </div>
		</td>
	</tr>
	<tr>
		<th>業態別設定</th>
		<td colspan="2">
           	<span m:value="#{(publicTargetDto.listTrnControlGyotaiKobetuSize > 0) == true ? '有' : '無'}"/>
		</td>
	</tr>
	<tr>
		<th>個店別設定</th>
		<td colspan="2">
            <div m:rendered="#{publicTargetDto.listTrnControlGyotaiTenpoSize > 0}">
				<span style="float:left;">有</span>
				<span style="float:right;"><input type="button"  m:value="指定店舗ダウンロード" m:action="#{notificationRegistCsvAction.download}"/></span>
            </div>
			<div m:rendered="#{publicTargetDto.listTrnControlGyotaiTenpoSize <= 0}">無</div>
		</td>
	</tr>
</table>

<input type="text" m:id="dummyEnter" style="display:none"/>

</form>
<script type="text/javascript">
<!--
	focusElement("notificationRegist");
-->
</script>

</span>
</body>
</html>
