<html xmlns:m="http://www.seasar.org/maya"
      m:action="#{ruijitenSearchAction.initialize}"
      m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>類似店検索</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="類似店検索"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load#{ruijitenCommonDto.userTypeCd}();"/>
<span m:inject="s:insert" m:name="bodyTitleName">■類似店検索</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBS008V01"/>
<span m:inject="f:param" m:name="isHonbu" m:value="#{ruijitenCommonDto.userTypeCd == '01'}"/>
<span m:inject="f:param" m:name="isOner" m:value="#{ruijitenCommonDto.userTypeCd == '02'}"/>
<span m:inject="s:insert" m:name="body">
<script type="text/javascript">
<!--

/**　本部ユーザー時初期処理 **/
function load01(){
	focusElement("ruijitenRef");
}
/**　オーナーユーザー時初期処理 **/
function load02(){
	if( document.ruijitenRef.elements[ 'ruijitenRef:miseCombo'] != null ){
		miseChg();
	}
}
/**　店舗ユーザー時初期処理 **/
function load03(){
}

function miseChg(){

	//選択された店コード
	var miseCd = document.ruijitenRef.elements[ 'ruijitenRef:miseCombo'].value;

	//選択された店の売上、オープン日をセット
	var objForm = document.ruijitenRef;
	var type;
	for (i = 0; i < objForm.elements.length; i++) {
		type = objForm.elements[i].type;
		if ('hidden' == type) {
			var nameLength = objForm.elements[i].name.length;
			if (miseCd != "" &&
				objForm.elements[i].name.substring(nameLength - 8, nameLength) == "infoMise" &&
				objForm.elements[i].value == miseCd){
				var uriage = objForm.elements[i].name.substring(0, nameLength - 8)+"infoUriage";
				document.ruijitenRef.URIAGE.value = objForm.elements[uriage].value;
				var opendt = objForm.elements[i].name.substring(0, nameLength - 8)+"infoOpenDt";
				document.ruijitenRef.OPENDT.value = objForm.elements[opendt].value;
				return;
			}
		}
	}
}


//-->
</script>

<form m:id="ruijitenRef" onkeydown="return setDefaultSubmitButton('ruijitenRef', 'research');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="userTypeCd" m:value="#{ruijitenCommonDto.userTypeCd}"/>
<!-- ウィンドウID -->
<input type="hidden" m:id="windowId" m:value="#{ruijitenCommonDto.windowId}"/>

<div m:rendered="#{ruijitenCommonDto.userTypeCd == '02' && ruijitenCommonDto.mstOnerHoyuMiseListSize==0}"
      style="font-weight:bold;">
  <p/>該当店舗が存在しません。Ｐ／Ｌが登録されていない可能性があります。</div>
<table m:rendered="#{ruijitenCommonDto.userTypeCd != '02' || ruijitenCommonDto.mstOnerHoyuMiseListSize>=1}" class="hiddenBody">
	<tr>
		<td>
		<table class="body_table" width="740">
		    <tr>
		      <th width="80">店舗情報</th>
		      <td m:rendered="#{ruijitenCommonDto.userTypeCd == '01'}" width="*" colspan="5">
				<input type="text" m:id="miseCd" m:size="7" m:maxlength="5" m:value="#{ruijitenReferenceDto.miseCd}"/>
				<input type="button" value="店選択" class="operation_button" m:action="#{ruijitenSearchAction.callMiseForm}"/>
		      </td>
		    <div m:rendered="#{ruijitenCommonDto.userTypeCd == '02'}">
		      <td width="*">
		      <div class="hideArea">
		      	<select m:onchange = miseChg(); m:id="miseCombo"
		      			m:value="#{ruijitenReferenceDto.miseCd}"
		           		m:items="#{ruijitenCommonDto.mstOnerHoyuMiseList}"
		           		m:itemValue="miseCd"
		           		m:itemLabel="miseNameKj">
		       		<option value="">MOS</option>
		        </select>
		      </div>
		      </td>

		      <th width="100">売上情報</th>
		      <td width="*">
		       	<INPUT TYPE="text" m:name="URIAGE" m:disabled="true" STYLE="text-align:right" class="width_86"size="15" />
		      </td>
		      <th width="80">オープン日</th>
		      <td width="*">
		      	<INPUT TYPE="text" m:name="OPENDT" m:disabled="true" class="width_86"size="15" />
		      </td>

		    </div>
		    </tr>
		    <tr>
		      <th width="80">営業エリア</th>
		      <td width="*">
		      	<div class="hideArea">
		        <select m:value="#{ruijitenReferenceDto.area}" m:id="area" size="1">
		        <option value="">全国</option>
		        <option value="NOTALLAREA">所属エリア</option>
		        </select>
		        </div>
		      </td>
		      <th width="100">店舗形態</th>
		      <td width="*">
		      	<div class="hideArea">
		        <select m:value="#{ruijitenReferenceDto.tenpoKeitai}" m:id="misekeitai" size="1">
		        <option value="">指定しない</option>
		        <option value="DOUITU_KEITAI">同一形態</option>
		        </select>
		        </div>
		      </td>
		      <th width="80">立地</th>
		      <td width="*">
		      	<div class="hideArea">
		        <select m:value="#{ruijitenReferenceDto.ritti}" m:id="ritti" size="1">
		        <option value="">指定しない</option>
		        <option value="DOUITU_RITTI">同一立地</option>
		        </select>
		        </div>
		      </td>
		    </tr>
		    <tr>
		      <th width="80">売上差</th>
		      <td width="*">
		      	<div class="hideArea">−
		        <select m:value="#{ruijitenReferenceDto.uriageFrom}" m:id="uriagemin" size="1">
		        <option value="">指定しない</option>
		        <option value="0">０万</option>
		        <option value="1000000">１００万</option>
		        <option value="2000000">２００万</option>
		        <option value="3000000">３００万</option>
		        <option value="4000000">４００万</option>
		        <option value="5000000">５００万</option>
		        <option value="6000000">６００万</option>
		        <option value="7000000">７００万</option>
		        <option value="8000000">８００万</option>
		        <option value="9000000">９００万</option>
		        <option value="10000000">１０００万</option>
		        </select>　＋
		        <select m:value="#{ruijitenReferenceDto.uriageTo}" m:id="uriagemax" size="1">
		        <option value="">指定しない</option>
		        <option value="0">０万</option>
		        <option value="1000000">１００万</option>
		        <option value="2000000">２００万</option>
		        <option value="3000000">３００万</option>
		        <option value="4000000">４００万</option>
		        <option value="5000000">５００万</option>
		        <option value="6000000">６００万</option>
		        <option value="7000000">７００万</option>
		        <option value="8000000">８００万</option>
		        <option value="9000000">９００万</option>
		        <option value="10000000">１０００万</option>
		        </select>
		        </div>
		      </td>
		      <th width="100">オープン年差</th>
		      <td width="*" colspan=3>
		      	<div class="hideArea">−
		        <select m:value="#{ruijitenReferenceDto.openDtFrom}" m:id="openmin" size="1">
		        	<option value="">指定しない</option>
		        	<option value="0">０年</option>
		        	<option value="1">１年</option>
		        	<option value="2">２年</option>
		        	<option value="3">３年</option>
		        	<option value="4">４年</option>
		        	<option value="5">５年</option>
		        	<option value="6">６年</option>
		        	<option value="7">７年</option>
		        	<option value="8">８年</option>
		        	<option value="9">９年</option>
		        	<option value="10">１０年</option>
		        </select>　＋
		        <select m:value="#{ruijitenReferenceDto.openDtTo}" m:id="openmax" size="1">
		        	<option value="">指定しない</option>
		        	<option value="0">０年</option>
		        	<option value="1">１年</option>
		        	<option value="2">２年</option>
		        	<option value="3">３年</option>
		        	<option value="4">４年</option>
		        	<option value="5">５年</option>
		        	<option value="6">６年</option>
		        	<option value="7">７年</option>
		        	<option value="8">８年</option>
		        	<option value="9">９年</option>
		        	<option value="10">１０年</option>
		        </select>
		        </div>
		      </td>
		    </tr>
		</table>
		</td>
		<td valign="bottom" style="padding-left:3px;">
			<input id="research" name="research" type="submit" value="実行"
			       m:action="#{ruijitenSearchAction.execute}"/></td>
	</tr>
</table>
<div m:rendered="#{ruijitenCommonDto.userTypeCd == '02'}"
     m:inject="s:forEach" m:items="#{ruijitenCommonDto.mstOnerHoyuMiseList}" m:var="e" m:varindex="i">
	<input type="hidden" m:id="infoMise" m:value="#{e.miseCd}"/>
	<input type="hidden" m:id="infoUriage" m:value="#{e.uriagedaka}" m:converter="#{NumericConverter}"/>
	<input type="hidden" m:id="infoOpenDt" m:value="#{e.openDt}" m:converter="#{dateConverter}"/>
</div>

<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>
</body>
</html>