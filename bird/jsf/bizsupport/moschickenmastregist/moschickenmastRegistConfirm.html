<html xmlns:m="http://www.seasar.org/maya" m:action="#{mosChickenMstEditAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>予約販売管理マスタ登録</title>
<span m:inject="f:param" m:name="layoutTitle" m:value="予約販売管理マスタ登録(確認画面)"/>
<span m:inject="s:insert" m:name="bodyTitleName">■予約販売管理マスタ登録(確認画面)</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBS015V05"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
</head>
<body>
<span m:inject="s:insert" m:name="body" >
<STYLE type="text/css">
<!--
//-->
</STYLE>
<script type="text/javascript">
<!--
var userTypeHONBU = "01";
var userTypeONER = "02";
var userTypeMISE = "03";

/**
 * ウィンドウロードステータス取得処理
 *
 */
function returnLoadingStatus(){
	if(isLoadingFlgOFF()) {
		setLoadingFlg();
		return true;
	}
	return false;
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function isLoadingFlgOFF(){
	return (document.conditionForm.elements['conditionForm:loadingFlg'].value != "ON");
}


/**
 * ウィンドウロードフラグ設定処理
 *
 *
 */
function setLoadingFlg() {
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "ON";
}

/**
 * ユーザータイプ判断処理
 *
 */
function isUserType(code){
	var userType = document.conditionForm.elements['conditionForm:usertypeCd'].value;
	return (code == userType);
}

/**
 * 画面表示完了時初期化処理
 */
function load(){
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
	document.conditionForm.elements['conditionForm:executeBt'].disabled = false;
	if(document.conditionForm.elements['execRegistBt'] != null){
		document.conditionForm.elements['execRegistBt'].disabled = false;
	}
  	changeTaB('tab_area_0','tab_title_area_0','tab_anchor_area_0', 'tab_data_area_0');
}
/**
 * タブフォーカス制御処理
 */
function changeTaB(tabarea, titlearea, anchorarea, dataarea) {
	if(isLoadingFlgOFF()){
	  	bodyTabChange('div',tabarea, titlearea, dataarea, 'th');
	  	bodyAnchorStyleChange(anchorarea);
  	}
}
function bodyTabChange(checkTab,tabarea,titlearea, dataarea, tabTag) {
  var objs = document.conditionForm.getElementsByTagName(checkTab);
  var tabObjs = document.conditionForm.getElementsByTagName(tabTag);
  var dispArea

//Data area Change
  for (i = 0; i < objs.length; i++) {
    if (objs[i].className == titlearea) {
      if(objs[i].style.display == "inline"){
        dispArea = objs[i].className;
      }
      objs[i].style.display = "inline";
    }else if (objs[i].className == dataarea) {
      if(objs[i].style.display == "inline"){
        dispArea = objs[i].className;
      }
      objs[i].style.display = "inline";
      objs[i].style.width = "975px";
      objs[i].style.height = "250px";
      objs[i].style.overflow = "auto";
    }else if(objs[i].className.substring(0,15) == 'tab_title_area_'){
      objs[i].style.display = "none";
    }else if(objs[i].className.substring(0,14) == 'tab_data_area_'){
      objs[i].style.display = "none";
    }else{
    }
  }
//Tab area Change
  for (t = 0; t < tabObjs.length; t++) {
    if(tabObjs[t].className == 'body_active_cell' && tabarea != tabObjs[t].id){
      tabObjs[t].className = 'body_non_active_cell';
    }else if(tabObjs[t].className == 'body_non_active_cell' && tabObjs[t].id == tabarea){
      tabObjs[t].className = 'body_active_cell';
    }
  }
}
// body area tab anchor style change (color etc)
function bodyAnchorStyleChange(anchorarea){
  var objs = document.conditionForm.getElementsByTagName('a');
  for (t = 0; t < objs.length; t++) {
  	var targetObjId = objs[t].id;
  	var targetName = targetObjId.substring((targetObjId.lastIndexOf(":")+1));
    if(targetName == anchorarea){
      objs[t].className = 'body_selected_link';
    }else if(objs[t].className == "body_selected_link"){
      objs[t].className = 'body_non_selected_link';
    }
  }
}
/**
 * 戻るボタン押下時処理
 *
 */
function execBack(confirmMsg){
	//実行前に確認アラートを出力
	document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:execBack';
	document.conditionForm.submit();
}
/**
 * 実行ボタン押下時処理
 *
 */
function execRegist(){
	document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:execRegist';
	document.conditionForm.submit();
}

//-->
</script>

<form m:id="conditionForm" onKeyDown="return setDefaultSubmitButton('conditionForm','executeBt');">
    <input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" id="loadingFlg" value="ON"/>
	<a id="execBack" m:action="#{mosChickenMstConfirmAction.back}"/>
	<a id="execRegist" m:action="#{mosChickenMstConfirmAction.regist}"/>
	<input type="button" name="conditionForm:executeBt" value="戻る" onClick="execBack();" onDblClick="return false"/>
	<span m:rendered="#{mosChickenMstRegistDto.modeType != null && mosChickenMstRegistDto.modeType != 'VIEW'}">
		<input type="button" name="execRegistBt" value="登録" onClick="execRegist();" onDblClick="return false"/>
	</span>
	<span m:inject="s:forEach" m:items="#{mosChickenMstRegistDto.listKanriKikan}" m:var="kikan" m:varindex="i">
	<table class="body_table" style="width:450px; margin:4px 0px;">
		<tr>
			<th width="80px">タイトル</th>
			<td><span m:converter="#{characterEncodingConverter}" m:value="#{kikan.title}"/></td>
		</tr>
	</table>
	</span>
	<table cellspacing="0" cellpadding="0">
	  <tr>
	    <td class="body_#{'init'==mosChickenMstRegistDto.compliteActionType?'':'non_'}active_cell tab_change_area_0" width="130px">
     		<a href="javaScript:changeTabArea('0')">対象期間</a>
	    </td>
	    <td class="body_#{'init'==mosChickenMstRegistDto.compliteActionType?'non_':''}active_cell tab_change_area_1" width="130px">
	    	<a href="javaScript:changeTabArea('1')">対象メニュー</a>
	    </td>
	  </tr>
	</table>


	<div class="tab_change_area_0 #{'init'==mosChickenMstRegistDto.compliteActionType?'':'in'}visible_tab">
	<!--対象期間-->
		<table  cellspacing="0" cellpadding="0" style="width:500px;">
		<tr class="body_caption" style="line-height:5px;"><td>&nbsp;</td></tr>
		</table>

		<table class="body_table2" width="500px">
			<tr class="header_row">
				<th width="200px">設定項目</th>
				<th>開始日</th>
				<th>終了日</th>
			</tr>
			<span m:inject="s:forEach" m:items="#{mosChickenMstRegistDto.listKanriKikan}" m:var="kikan" m:varindex="i">
				<tr>
					<th width="200px">対象期間</th>
					<td align="center"><span m:value="#{kikan.targetFrom}" m:converter="#{dateConverter}"/></td>
					<td align="center"><span m:value="#{kikan.targetTo}" m:converter="#{dateConverter}"/></td>
				</tr>
				<tr>
					<th width="200px" nowrap=" nowrap">デフォルト表示期間</th>
					<td align="center"><span m:value="#{kikan.defaultFrom}" m:converter="#{dateConverter}"/></td>
					<td align="center"><span m:value="#{kikan.defaultTo}" m:converter="#{dateConverter}"/></td>
				</tr>
			</span>
		</table>
	</div>
	<div class="tab_change_area_1 #{'init'==mosChickenMstRegistDto.compliteActionType?'in':''}visible_tab">
	<!--対象メニュー-->
		<table  cellspacing="0" cellpadding="0" style="width:955px;">
		<tr class="body_caption" style="line-height:5px;"><td>&nbsp;</td></tr>
		</table>
		<span m:rendered="#{mosChickenMstRegistDto.listKanriMenuGroup != null}">
		<div style="width:955px; height:370px;"class="scroll_area">
		<div m:inject="s:forEach" m:items="#{mosChickenMstRegistDto.listKanriMenuGroup}" m:var="menuGroup" m:varindex="g">
			<table class="body_table2" style="width:936px;margin:4px 0px;">
		      <tr class="defaultTR">
		      	<th width="150px">商品グループ</th>
			    <td><span m:converter="#{characterEncodingConverter}" m:value="#{menuGroup.menuGroupNm}" /></td>
		      </tr>
			</table>
			<table class="body_table2" style="width:936px;margin:4px 0px;">
	      		<tr class="header_row">
	      			<th width="*">対象メニュー</th>
	      			<th width="340px">対応食包材</th>
	      			<th width="90px">換算値</th>
	      			<th width="120px">集計グループ</th>
	      		</tr>
				<div m:inject="s:forEach" m:items="#{mosChickenMstRegistDto.listKanriMenu}" m:var="menu" m:varindex="i">
				<!--対象メニュー-->
	      		<tr m:rendered="#{menu.menuGroup == menuGroup.menuGroup}">
			    	<td><span m:converter="#{characterEncodingConverter}" m:value="#{menu.menuCd}"/>&nbsp;<span m:converter="#{characterEncodingConverter}" m:value="#{menu.menuNameKj}"/></td>
			    	<td><span m:converter="#{characterEncodingConverter}" m:value="#{menu.shokuCd}"/>&nbsp;<span m:converter="#{characterEncodingConverter}" m:value="#{menu.shokuNameKna}"/></td>
				    <td align="right"><span m:value="#{menu.convValue}"  m:converter="#{numConverter}"/></td>
				    <td align="center"><span m:converter="#{characterEncodingConverter}" m:value="#{menu.sumGroup}" />&nbsp;</td>
			    </tr>
			    </div>
			</table>
		</div>
		</div>
		</span>
	</div>
</form>
</span>
</body>
</html>
