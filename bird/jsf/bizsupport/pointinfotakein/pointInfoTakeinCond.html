<html xmlns:m="http://www.seasar.org/maya"
	m:action="#{pointInfoTakeinCondAction.initialize}"
	m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<meta http-equiv="Content-Style-Type" content="text/css" />
<title>ポイント情報取込</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="ポイント情報取込"></span>
<span m:inject="s:insert" m:name="bodyTitleName">■ポイント情報取込</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"></span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBS037V01" /></span>
<div m:inject="s:insert" m:name="body">

<style type="text/css">
<!--
table.csv_th {
	width: 700px;
}

table.csv_th tr th {
	width: 135px;
}
//
-->
</style>
<script type="text/javascript">
<!--
function bodyLoad() {
	var csvErrorName = document.pointInfotakeinCond.elements['pointInfotakeinCond:csvError'].value;
	if(csvErrorName != null && csvErrorName != "") {
		var msg = '取り込めない内容が含まれています。詳しくは'+ csvErrorName +'をご確認下さい。';
		if (confirm(msg)){
			errorDownloadAction();
		}
		document.pointInfotakeinCond.elements['pointInfotakeinCond:csvError'].value = '';
	}
}
function print_onclick(url) {
	return window.open(url,"_blank",
			"top=50,left=200,height=800,width=800,status=yes,toolbar=1,menubar=no,location=no,scrollbars=no");
}

function errorDownloadAction() {
	document.pointInfotakeinCond.elements['pointInfotakeinCond:__link_clicked__'].value='pointInfotakeinCond:errorDownload';
	document.pointInfotakeinCond.target = "_self";
	document.pointInfotakeinCond.submit();
}

function readIn(confirmMsg){
	if(confirm(confirmMsg)){
		document.pointInfotakeinCond.elements['pointInfotakeinCond:__link_clicked__'].value='pointInfotakeinCond:readIn';
		document.pointInfotakeinCond.submit();
	}
}

function executive(confirmMsg){
	if(confirm(confirmMsg)){
		document.pointInfotakeinCond.elements['pointInfotakeinCond:__link_clicked__'].value='pointInfotakeinCond:executive';
		document.pointInfotakeinCond.submit();
	}
}
//-->
</script>

<form m:id="pointInfotakeinCond" enctype="multipart/form-data">
	<a m:id="readIn"  m:action="#{pointInfoTakeinCondAction.upload}"></a>
	<a m:id="executive"  m:action="#{pointInfoTakeinCondAction.execute}"></a>
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" /> <input
		type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}" />
	<input type="hidden" m:id="initSubMenuId"
		m:value="#{menuAction.initSubMenuId}" />
	<!-- 画面操作エリア -->
	<input type="hidden" m:id="csvError" m:value="#{pointInfoTakeinDto.csvErrorName}"/>
	<a m:id="errorDownload" m:action="#{pointInfoTakeinCondAction.errorDownload}"></a>
	<div class="body_error_massage"
		m:style="#{pointInfoTakeinDto.uploadFinish == true ? 'display:inline;' : 'display:none;'}">
		<div style="margin: 5px 0px 5px 5px;">取込処理が正常に終了しました。</div>
	</div>
	<div class="body_error_massage"
		m:style="#{pointInfoTakeinDto.keisanFinish == true ? 'display:inline;' : 'display:none;'}">
		<div style="margin: 5px 0px 5px 5px;">業績ポイント作成処理が正常に終了しました。</div>
	</div>
	<!-- 固定条件エリア -->
	<table class="hiddenBody">
		<tr>
			<td><span m:inject="s:selectOneRadio2"
				m:value="#{pointInfoTakeinDto.processMode}" m:required="true">
					<table class="body_table csv_th">
						<tr>
							<th>処理選択</th>
							<td nowrap
								style="border-right-width: 0px; padding-right: 15px;"><input
								type="radio" m:name="processMode" m:value="1" />基本ポイント付与</td>
							<td nowrap
								style="border-left-width: 0px; border-right-width: 0px; padding-right: 15px;">
								<input type="radio" m:name="processMode" m:value="2" />海外赴任精算
							</td>
							<td nowrap
								style="border-left-width: 0px; border-right-width: 0px; padding-right: 15px;">
								<input type="radio" m:name="processMode" m:value="3" />退職
							</td>
							<td nowrap style="border-left-width: 0px; padding-right: 15px;">
								<input type="radio" m:name="processMode" m:value="4" />役員情報登録
							</td>
						</tr>
					</table>
			</span></td>
			<td style="padding-left: 3px;"><input type="submit"
				m:id="btnUpload" value="取込"  onclick="readIn('処理を実行します。よろしいですか？');return false;" onDblClick="return false"/></td>
		</tr>
	</table>

	<p />
	<table class="body_table csv_th">
		<tr>
			<th>CSVファイル</th>
			<td><span m:inject="x:inputFileUpload" style="width: 450px;"
				id="uploadedFile" m:value="#{pointInfoTakeinDto.uploadedFile}"></span></td>
		</tr>
	</table>
	<div style="margin: 10px 0px 0px 20px">
		<input type="submit" m:id="btnShowPdf" onclick="print_onclick('#{request.contextPath}/help/pointInfoLayout.pdf');"
			value="取込レイアウト説明" />
	</div>
	<p />
	<table class="hiddenBody">
		<tr>
			<td>
				<table class="body_table csv_th">
					<tr>
						<th>業績ポイント作成</th>
						<td style="border-right-width: 0px;"><select m:id="seidoCd"
							m:value="#{pointInfoTakeinDto.conSeidoCd}"
							m:items="#{pointInfoTakeinDto.listSeido}" m:itemValue="seidoCd"
							m:itemLabel="planName">
						</select></td>
					</tr>
				</table>
			</td>
			<td style="padding-left: 3px;"><input type="submit" onclick="executive('処理を実行します。よろしいですか？');return false;" onDblClick="return false"
				m:id="btnExecute"  value="実行" /></td>
		</tr>
	</table>

</form>
</div>
</body>
</html>