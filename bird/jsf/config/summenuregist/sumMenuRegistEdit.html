<html xmlns:m="http://www.seasar.org/maya" m:action="#{sumMenuRegistEditAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<meta http-equiv="Content-Style-Type" content="text/css"/>
<meta http-equiv="Content-Script-Type" content="text/javascript"/>
<title>メニュー集約マスタ設定（編集画面）</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="メニュー集約マスタ設定（編集画面）"/>
<span m:inject="s:insert" m:name="bodyTitleName">■メニュー集約マスタ設定（編集画面）</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCF009V03"/>
<span m:inject="f:param" m:name="onLoadName" m:value="onLoadFunction()"/>
<span m:inject = "f:param" m:name = "deleteMsg" m:value="に紐づく親子関係が全て削除されます。よろしいですか？"/>
<div m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
.scroll_area {
	width:	  570px;
	height:   420px;
	overflow: auto;
}
@media print {
}
-->
</style>

<script type="text/javascript">
<!--
function onLoadFunction() {
    focusElement('editForm');
}
function deleteOya() {
  var sumMenuName = document.editForm.elements['editForm:sumMenuName'].value;
  var deleteMsg = document.editForm.elements['editForm:deleteMsg'].value;
  if (!confirm(sumMenuName + deleteMsg)) {
    return false;
  }
  document.editForm.elements['editForm:__link_clicked__'].value='editForm:actionDeleteOya';
  document.editForm.submit();
}
function execute() {
  document.editForm.elements['editForm:__link_clicked__'].value='editForm:actionExecute';
  document.editForm.submit();
}
function back() {
  document.editForm.elements['editForm:__link_clicked__'].value='editForm:actionBack';
  document.editForm.submit();
}
-->
</script>

<form m:id="editForm" target="_self" onkeydown="setDefaultSubmitButton('editForm', 'confirmBtn');">
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" m:id="sessionKey" m:value="#{sumMenuRegistReqDto.sessionKey}"/>
	<input type="hidden" m:id="sumMenuName" m:value="#{sumMenuRegistDto.sumMenuName}"/>
	<input type="hidden" m:id="deleteMsg" m:value="#{deleteMsg}"/>
	<a m:id="actionDeleteOya" m:action="#{sumMenuRegistEditAction.deleteOya}"/>
	<a m:id="actionExecute" m:action="#{sumMenuRegistEditAction.confirm}"/>
	<a m:id="actionBack" m:action="#{sumMenuRegistEditAction.back}"/>
	<input type="text" value="aaa" style="display:none;"/>

	<input type="button"
	       m:name="editForm:backBtn" value="戻る"
	       onclick="return back();"
	       ondblclick="return false;"/>
	&nbsp;
	<input type="button"
	       m:name="editForm:confirmBtn"
	       value="確認"
	       onclick="return execute();"
	       ondblclick="return false;"/>
	&nbsp;
	<a m:action="#{sumMenuRegistEditAction.addKo}">[子メニュー追加]</a>
	<br/>
	<div style="clear:both;line-height:25%;"><br/></div>
	<table class="body_table2" style="width:550px;border-bottom:0px;">
		<span m:inject="s:forEach" m:items="#{sumMenuRegistDto.listKoMenu}" m:var="e" m:varindex="i">
		 <tr m:rendered="#{e.sumMenuFlg == '1'}">
		  <th width="115px;">集約先メニュー</th>
		  <td style="border-right:0px;"><span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.menuCd}"/>&nbsp;<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.menuName}"/></td>
		  <td style="text-align:right;border-left:0px;">
		    <a m:rendered="#{!e.insertFlg}" href="#" onClick="deleteOya();" onDblClick="return false">[削除]</a>
		  </td>
		 </tr>
		</span>
	</table>
	<table class="body_table2" style="width:550px;border-top:0px;border-bottom:0px;">
	 <colgroup>
	  <col style="width:*;"/>
	  <col style="width:50px;"/>
	  <col style="width:55px;"/>
	 </colgroup>
	 <tr class="header_row">
	  <th colspan="2">対象メニュー</th>
	  <th>換算数</th>
	 </tr>
	</table>
	<div class="scroll_area">
	<table class="body_table2" style="width:550px;border-top:0px;">
	 <colgroup>
	  <col style="width:*;"/>
	  <col style="width:50px;"/>
	  <col style="width:55px;"/>
	 </colgroup>
	<span m:inject="s:forEach" m:items="#{sumMenuRegistDto.listKoMenu}" m:var="e" m:varindex="i">
	 <tr m:rendered="#{e.sumMenuFlg != '1' && !e.sakujoFlg}">
	   <td style="border-right:0px;"><span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.menuCd}"/>&nbsp;<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.menuName}"/></td>
	   <td style="text-align:right;border-left:0px;">
	     <a m:action="#{sumMenuRegistEditAction.deleteKo}" onDblClick="return false">[削除]
	       <span m:converter="#{characterEncodingConverter}" m:inject="f:param" m:name="deleteIndex" m:value="#{i}"/>
	     </a>
	   </td>
	   <td style="text-align:right;"><input type="text" m:id="convValue" m:value="#{e.convValue}" m:maxlength="3" style="ime-mode:disabled;width:40px;"/></td>
	 </tr>
	</span>
	</table>
	</div>
	<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</div>
</body>
</html>
