<html xmlns:m="http://www.seasar.org/maya" m:action="#{userRegistEditOwnerAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>ユーザー登録</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="ユーザー登録"/>
<span m:inject="s:insert" m:name="bodyTitleName">■ユーザー登録</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BSA006V02"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load();"/>
<span m:inject="s:insert" m:name="body">
<SCRIPT LANGUAGE="javascript">
<!--
function load() {
	focusElement("userregist");
}

function inputControl(checkElm, index) {
	var statusFlg = (checkElm.checked ==false);
	if(document.userregist.elements['onerCd'].length >= 2) {
		document.userregist.elements['onerCd'][index].readOnly = statusFlg;
		document.userregist.elements['searchOnerBtn'][index].disabled = statusFlg;
		if(statusFlg) {
			document.userregist.elements['onerCd'][index].value = "";
		}
	} else {
		document.userregist.elements['onerCd'].readOnly = statusFlg;
		document.userregist.elements['searchOnerBtn'].disabled = statusFlg;
		if(statusFlg) {
			document.userregist.elements['onerCd'].value = "";
		}
	}
}
/**
 * オーナー選択ボタン処理
 */
function searchOner(companyCd) {
	//オーナーコード設定処理
	settingOnerCd();
	var onerSearchAnchorId = "";
	var objs = document.userregist.getElementsByTagName('a');
	for (i = 0; i < objs.length; i++) {
		var classNm = objs[i].className;
		var startIndex = classNm.indexOf('searchOnerAnchor');
		if(startIndex >= 0) {
			classNm = classNm.substring(startIndex);
			if(classNm.indexOf(companyCd) >= 0){
				onerSearchAnchorId = objs[i].id;
				break;
			}
		}
	}
	document.userregist.onerSearchCompanyCd.value=companyCd;
	document.userregist.elements['userregist:__link_clicked__'].value="userregist:searchOner";
	document.userregist.submit();
	return false;
}
/**
 * オーナーコード設定処理
 *
 */
function settingOnerCd() {
	var objs = document.userregist.getElementsByTagName('input');
	for (i = 0; i < objs.length; i++) {
		var idNm = objs[i].id;
		var startIndex = idNm.indexOf('userOnerCd');
		if(startIndex >= 0) {
			idNm = idNm.substring(startIndex-2,startIndex-1);
			//オーナーコードのエレメントの場合、
			//テキストエリアで入力された値を設定します。
			var elementCompanys = document.userregist.onerCd;
			for(c = 0; c<elementCompanys.length; c++) {
				var companyCd = elementCompanys[c].value;
				if(idNm == c){
					objs[i].value=document.userregist.elements['onerCd'][c].value;
					break;
				}
			}//end of for
		}
	}
}
//-->
</SCRIPT>
<STYLE type="text/css">
<!--
	table.body_table2 {
		width:900px;
	}
	@media print {
		table.body_table2 {
			width:100%;
		}
	}
-->
</STYLE>
<form m:id="userregist" onKeyDown="return setDefaultSubmitButton('userregist','executeBt')";>
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="submit" value="戻る" m:action="#{userRegistEditOwnerAction.cancel}"/>&nbsp;
	<input type="submit" value="確認" m:id="executeBt" class="operation_button"
	       m:action="#{userRegistEditOwnerAction.confirm}" onClick="settingOnerCd();"/>&nbsp;
	<a m:id="searchOner" m:action="#{userRegistEditOwnerAction.searchOner}"/>
	<input type="hidden" name="onerSearchCompanyCd" value="" m:passthrough="true"/>
	<div m:inject="s:forEach" m:items="#{userRegistDto.userOnerList}" m:var="bm06" m:varindex="i">
		<input type="hidden" id="userOnerCd" m:value="#{bm06.onerCd}"/>
	</div>
	<table class="body_table2" style="margin-top:4px;border-bottom-width:0px;">
	  <tr>
	    <th width="170px">ユーザータイプ</th>
	    <td colspan="5" width="723px">オーナー</td>
	  </tr>
	  <tr>
	    <th width="170px">ユーザーID</th>
	    <td width="130px"><input m:id="userId" class="imenotuse width_110" type="text" m:value="#{userRegistDto.uIUser.userId}" m:maxlength="8" m:size="20" /></td>
	    <th>初期パスワード</th>
	    <td width="140px"><input class="width_129" id="password" type="password" m:size="18" m:value="#{userRegistDto.userPassWord}"/></td>
	    <th>確認用パスワード</th>
	    <td width="140px"><input class="width_129" id="password2" type="password" m:size="18" m:value="#{userRegistDto.userPassWordKakunin}"/></td>

	  </tr>
	  <tr>
	    <th>ユーザー名</th>
	    <td colspan="2">
	      <input m:id="userNameKj" class="imeon width_235" type="text"
	             m:value="#{userRegistDto.uIUser.userNameKj}" m:maxlength="40" m:size="45" />
	    </td>
	    <th>ユーザー名(カナ)</th>
	    <td colspan="2">
	      <input m:id="userNameKana" class="imeon  width_235" type="text"
	             m:value="#{userRegistDto.uIUser.userNameKana}" m:maxlength="20" m:size="45" />
	    </td>
	  </tr>
		<tr>
			<th>会社</th>
			<td colspan="5">
				<div m:inject="s:forEach" m:items="#{userRegistDto.userOnerList}" m:var="bm06" m:varindex="i">
				<input type="checkbox" onclick="inputControl(this, '#{i}')" value="#{bm06.checked}"/>
				<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{bm06.companyName}"/>&nbsp;&nbsp;
				</div>
			</td>
		</tr>
		</table>
		<div m:inject="s:forEach" m:items="#{userRegistDto.userOnerScreenList}" m:var="list1Row" m:varindex="r">
			<table class="body_table2" style="border-top-width:0px;border-bottom-width:0px;">
			<tr class="non_top_border">
				<div m:inject="s:forEach" m:items="#{list1Row}" m:var="bm06" m:varindex="i">
					<th style="width:170px;" nowrap="true">
						<span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{bm06.companyName}"/><br/>
						オーナーコード&nbsp;<input type="button" name="searchOnerBtn" value="検索"
						            onClick="searchOner('#{bm06.companyCd}');"
						            onDblClick="return false;"
						            disabled="#{bm06.checked==false}" m:passthrough="true"/>
					</th>
					<td>
						<input type="text" name="onerCd" m:value="#{bm06.onerCd}"
						       size=15 m:maxlength="5" class="imenotuse width_85"  readonly="#{bm06.checked==false}"
						       m:converter="#{userRegistCodeConverter}" m:passthrough="true"/>
					</td>
				</div>
			</tr>
			</table>
		</div>
	<table class="body_table2" style="border-top-width:0px;border-bottom-width:0px;">
		<tr class="non_top_border">
		    <th style="width:170px;">
		    	業態&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="検索" id="gyoutaiButton" class="operation_button"
		    	           m:action="#{userRegistEditOwnerAction.searchGyotai}" onClick="settingOnerCd();"/>
		    </th>
	        <td style="border-right-width : 0px;" >
		      <div m:inject="s:forEach" m:items="#{userRegistDto.userGyotaiList}" m:var="e" m:varindex="i">
	            <span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{e.gyotaiName}"/><br>
		      </div>
		    </td>
		    <td style="border-left-width : 0px;"><input type="button" value="クリア"
		               m:action="#{userRegistEditOwnerAction.clearGyotai}"/>&nbsp;</td>
	      <!-- 2007/02/01 add start xamaruyama -->
		<th style="">契約タイプ
	      <td style="">
	   	    <div class="hideArea">
		      <select m:id="keiyakuType"
		    		  m:value="#{userRegistDto.keiyakuChoice}"
		    		  m:items="#{userRegistDto.keiyakuList}"
		    		  m:itemValue="keiyakuType"
		    		  m:itemLabel="keiyakuTypeNm"
		    		  m:nullLabel=" "/>
	        </div>
		  </td>
	    </th>
	    <!-- 2007/02/01 add end xamaruyama -->
	  </tr>
	  <tr>
	    <th>請求フラグ</th>
		<td colspan="2">
		<span m:inject="s:selectOneRadio2" m:value="#{userRegistDto.uIUser.sekyuFlg}">
			<input type="radio" m:value="1"/>請求する
			<input type="radio" m:value="2"/>請求しない
		</span>
		</td>
	      <!-- 2007/02/01 add start xamaruyama -->
	    <th>オプション選択</th>
	      <td>
	        <input m:id="optionChk" type="checkbox"
	               m:value="#{userRegistDto.optionFunctionFlg}"/>オプション機能&nbsp;&nbsp;
	 	    <input m:id="dataChk" type="checkbox"
	 	           m:value="#{userRegistDto.optionDataFlg}"/>データ提供&nbsp;&nbsp;
	      </td>
	      <!-- 2007/02/01 add end xamaruyama -->
	  </tr>
	  </table>
	<table class="body_table2" style="border-top-width:0px;">
	  <tr class="non_top_border">
	    <th width="170px">請求開始日</th>
	    <td><input m:id="seikyuDt" type="text" class="imenotuse width_110"
	               m:value="#{userRegistDto.uIUser.seikyuDt}" m:maxlength="10" m:size="20" />
	    </td>
	    <th>請求変更予定日</th>
	    <td><input m:id="seikyuUpdtDt" type="text" class="imenotuse width_110"
	               m:value="#{userRegistDto.uIUser.seikyuUpdtDt}" m:maxlength="10" m:size="20" />
	    </td>
	    <th>申込日</th>
	    <td><input m:id="appliedDt" type="text" class="imenotuse width_110"
	               m:value="#{userRegistDto.uIUser.appliedDt}" m:maxlength="10" m:size="20" />
	    </td>
	  </tr>
	  <tr>
	    <th>メールアドレス</th>
	    <td colspan="3">
	      <input m:id="mailAdd" class="imenotuse width_410" type="text" m:value="#{userRegistDto.uIUser.mailAdd}" m:maxlength="60" m:size="80" />
	    </td>
	    <th>使用停止</th>
	    <td><input type="checkbox" m:value="#{userRegistDto.stopFlg}" />&nbsp;使用停止</td>
	  </tr>
	</table>
</form>
</span>
</body>
</html>