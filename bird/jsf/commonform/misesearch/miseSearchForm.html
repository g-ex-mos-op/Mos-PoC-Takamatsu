<html xmlns:m="http://www.seasar.org/maya" m:action="#{miseSearchAction.initialize}" m:extends="/jsf/layout/layout.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<meta http-equiv="Content-Style-Type" content="text/css"/>
<title>店選択</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="店選択"/>
<span m:inject="s:insert" m:name="bodyTitleName">■店選択</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="s:insert" m:name="naviarea" m:src="/jsf/commonform/misesearch/miseSearchFormNavi.html"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCO008V01"/>
<div m:inject="s:insert" m:name="body">
	<style type="text/css">
	<!--
	.operation_pane {
	}
	.operation_button {
	    margin-right		: 10px;
	}
	.search_condition {
		margin-top			: 5px;
	}
	.search_condition table {
		width				: 770px;
	}
	.condition_col_header1 {
		width				: 115px;
	}
	.condition_col_field1 {
		width				: 270px;
	}
	.condition_col_header2 {
		width				: 115px;
	}
	.condition_col_field2 {
		width				: 270px;
	}
	.condition_field {
		width				: 281px;
	}

	.search_result {
		margin-top			: 5px;
	}
	.search_result table {
		width				: 770px;
	}
	.scroll_area {
		height				: 338px;
		width				: 789px;
	}
	.result_col_select {
		width				: 40px;
		text-align			: center;
	}
	.result_col_misecd {
		width				: 100px;
	}
	.col_misenamekj {
		width				: *;
	}
	-->
	</style>
	<script type="text/javascript">
	<!--
	function loadSibuList(){
		document.forms['miseSearch'].elements['miseSearch:__link_clicked__'].value='miseSearch:loadSibuList';
		document.forms['miseSearch'].submit();
		return false;
	}

	function selectMise(index){
		document.forms['miseSearch'].elements['miseSearch:index'].value=index;
		document.forms['miseSearch'].elements['miseSearch:__link_clicked__'].value='miseSearch:selectMise';
		document.forms['miseSearch'].submit();
		return false;
	}

	function clearForm(formobj) {
	    for (i = 0; i < formobj.elements.length; i++) {
	        if (formobj.elements[i].type == "text") {
	            formobj.elements[i].value = "";
	        } else if (formobj.elements[i].type == "select-one") {
	            for (j = 0; j < formobj.elements[i].options.length; j++) {
	                formobj.elements[i].options[j].selected = formobj.elements[i].options[j].defaultSelected;
	            }
	            formobj.elements[i].selectedIndex = 0;
	        }
	    }
	}

	function checkInfoMain() {
		var closeNum,sortNum;
		var closeFlg,sortFlg;

		closeNum = document.miseSearch.close.length;
		sortNum = document.miseSearch.sort.length;

		for(i = 0; i < closeNum; i++ ) {
			closeFlg = document.miseSearch.close[i].checked;
			if( closeFlg ) {
				document.miseSearch.elements['miseSearch:inClose'].value = document.miseSearch.close[i].value;
				break;
			}
		}
		for( i = 0; i < sortNum; i++ ) {
			sortFlg = document.miseSearch.sort[i].checked;
			if( sortFlg ) {
				document.miseSearch.elements['miseSearch:sortSeq'].value = document.miseSearch.sort[i].value;
				break;
			}
		}

	}

	function bodyLoad() {
		var closeNum,sortNum;
		var closeVal,sortVal;

		closeNum = document.miseSearch.close.length;
		sortNum = document.miseSearch.sort.length;

		for( i = 0; i < closeNum; i++ ) {
			closeVal = document.miseSearch.elements['miseSearch:inClose'].value;
			if ( closeVal == document.miseSearch.close[i].value ) {
				document.miseSearch.close[i].checked = true;
				break;
			}
		}

		for( i = 0; i < sortNum; i++ ) {
			sortVal = document.miseSearch.elements['miseSearch:sortSeq'].value;
			if ( sortVal == document.miseSearch.sort[i].value ) {
				document.miseSearch.sort[i].checked = true;
				break;
			}
		}

		naviLoad();
	}
	-->
	</script>
	<form m:id="miseSearch">
		<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
		<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
		<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>

		<input type="hidden" m:value="#{miseSearchConditionDto.windowId}"/>
		<input type="hidden" m:id="inClose" name="inClose" m:value="#{recentConditionMiseDto.inClose}"/>
		<input type="hidden" m:id="sortSeq" name="sortSeq" m:value="#{recentConditionMiseDto.sortSeq}"/>
		<input type="hidden" m:value="#{recentConditionMiseDto.resultDispSize}"/>

		<a id="selectMise" m:action="#{miseSearchAction.select}"/>
		<input type="hidden" m:id="index" m:value="#{miseSearchAction.index}"/>

		<div class="operation_pane">
		<input type="submit" value="検索" class="operation_button" m:action="#{miseSearchAction.search}" onclick="checkInfoMain();"/>
		<input type="submit" value="戻る" class="operation_button" m:action="#{miseSearchAction.cancel}"/>
		<input type="button" value="クリア" class="operation_button" onclick="clearForm(this.form);"/>
		</div>

		<div class="search_condition">
		<table class="body_table font_size_14">
		    <col class="condition_col_header1"/>
		    <col class="condition_col_field1"/>
		    <col class="condition_col_header2"/>
		    <col class="condition_col_field2"/>
		    <tr>
		        <th>会社</th>
		        <td>
					<div class="hideArea">
		            <select m:id="companyCd"
		                    m:value="#{recentConditionMiseDto.rCompanyCd}"
		                    m:items="#{miseSearchConditionDto.companyList}"
		                    m:itemValue="companyCd"
		                    m:itemLabel="companyName"
		                    m:onchange="loadSibuList()">
		                <option value="">モスフードサービス</option>
		                <option value="">四季菜</option>
		            </select>
		            </div>
		            <a id="loadSibuList" m:action="#{miseSearchAction.loadSibuList}"/>
		        </td>
		        <th>支部</th>
		        <td>
					<div class="hideArea">
		            <select m:name="sibuCd"
		                    m:value="#{recentConditionMiseDto.sibuCd}"
		                    m:items="#{miseSearchConditionDto.sibuList}"
		                    m:itemValue="sibuCd"
		                    m:itemLabel="sibuName"
		                    m:nullLabel=" ">
		                <option value="">選択</option>
		                <option value="">MOS</option>
		            </select>
		            </div>
		        </td>
		    </tr>
		    <tr>
		        <th>オーナーコード</th>
		        <td><input class="width_72" type="text" m:id="onerCd" m:value="#{recentConditionMiseDto.onerCd}" m:converter="#{codeConverterOwner}" m:size="10" maxlength="5" style="ime-mode:disabled"/></td>
		        <th>店コード</th>
		        <td><input class="width_72" type="text" m:id="miseCd" m:value="#{recentConditionMiseDto.miseCd}" m:converter="#{codeConverterMise}" m:size="10" maxlength="5" style="ime-mode:disabled"/></td>
		    </tr>
		    <tr>
		        <th>オーナー名</th>
		        <td><input class="oner_name width_235" type="text" m:id="onerNameKj" m:value="#{recentConditionMiseDto.onerNameKj}" m:size="45" maxlength="40"/></td>
		        <th>店舗名</th>
		        <td><input class="oner_name width_235" type="text" m:id="miseNameKj" m:value="#{recentConditionMiseDto.miseNameKj}" m:size="45" maxlength="40"/></td>
		    </tr>

			<tr>
				<th>クローズ店</th>
				<td>
					<input type="radio" name="close" value="outClose" m:passthrough="true" checked="checked"/>含まない&nbsp;
					<input type="radio" name="close" value="inClose" m:passthrough="true"/>含む
				</td>
				<th>ソート順</th>
				<td>
					<input type="radio" name="sort" value="MISE_CD"  m:passthrough="true" checked="checked"/>コード順&nbsp;
					<input type="radio" name="sort" value="MISE_NAME_KNA" m:passthrough="true"/>店舗名称順(カナ順)
				</td>
			</tr>
		</table>
		</div>
		<script type="text/javascript">
		<!--
			focusElement("miseSearch");
		-->
		</script>

		<div class="search_result" m:rendered="#{miseSearchConditionDto.miseSearchListSize > 0}">
			<table class="body_table2">
			    <col class="result_col_misecd"/>
			    <col class="col_misenamekj"/>
			    <tr class="header_row">
			        <th>店コード</th>
			        <th>店舗名</th>
				<div m:rendered="#{miseSearchConditionDto.inClose == 'inClose'}">
			        <th width="100">クローズ日</th>
				</div>
			    </tr>
			</table>

			<div class="scroll_area" style="margin-top:-1px;">
			<table class="body_table2" style="border-top-width:0px;">
			    <col class="result_col_misecd"/>
			    <col class="col_misenamekj"/>
			    <div m:inject="s:forEach" m:items="#{miseSearchConditionDto.miseSearchList}" m:var="e" m:varindex="i">
				<tr>
					<td><span m:value="#{e.miseCd}"/></td>
				    <td>
					  <a href="#" onclick="selectMise('#{i}')">
				        <span m:converter="#{characterEncodingConverter}" m:value="#{e.miseNameKj}"/>
					  </a>
				    </td>
					<div m:rendered="#{miseSearchConditionDto.inClose == 'inClose'}">
						<td width="100"><span m:value="#{e.closeKj}" m:converter="#{documentsearchDateConverter}"/></td>
					</div>
				</tr>
				</div>
			</table>
			</div>
		</div>
		<input type="text" m:id="dummyEnter" style="display:none"/>
	</form>
</div>
</body>
</html>
