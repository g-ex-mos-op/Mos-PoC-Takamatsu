<html xmlns:m="http://www.seasar.org/maya" m:action="#{eventListEntryAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<meta http-equiv="Content-Style-Type" content="text/css"/>
<title>各種イベント申込</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="各種イベント申込"/>
<span m:inject="s:insert" m:name="bodyTitleName">■各種イベント申込</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BEN091V01"/>
<div m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
.scroll_area {
	height				: 415px;
	width				: 957px;
}
table tr.close_event td {
	background-color	: #CCCCCC;
}
.visible_area {
	display				: block;
}
.invisible_area {
	display				: none;
}
-->
</style>

<script type="text/javascript">
<!--
function bodyLoad() {
	focusElement("eventListEntry");
}

function selectEvent(entryCd, entryYear, entryKai, viewId, entryTermKind, message) {

	/* アラート表示 */
	if (message != null && message.length > 0) {
		alert(message);
	}

	/* パラメータ設定 */
	document.forms['eventListEntry'].elements['eventListEntry:entryCd'].value = entryCd;
	document.forms['eventListEntry'].elements['eventListEntry:entryYear'].value = entryYear;
	document.forms['eventListEntry'].elements['eventListEntry:entryKai'].value = entryKai;
	document.forms['eventListEntry'].elements['eventListEntry:forwardViewId'].value = viewId;
	document.forms['eventListEntry'].elements['eventListEntry:entryTermKind'].value = entryTermKind;

	/* Action起動 */
	document.forms['eventListEntry'].elements['eventListEntry:__link_clicked__'].value = 'eventListEntry:selectEvent';
	document.forms['eventListEntry'].submit();

	return false;
}
-->
</script>

<form m:id="eventListEntry">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="windowId" m:value="#{eventListConditionDto.windowId}"/>

<a id="selectEvent" m:action="#{eventListEntryAction.selectEvent}"/>
<input type="hidden" m:id="entryCd" m:value="#{eventListEntryAction.entryCd}"/>
<input type="hidden" m:id="entryYear" m:value="#{eventListEntryAction.entryYear}"/>
<input type="hidden" m:id="entryKai" m:value="#{eventListEntryAction.entryKai}"/>
<input type="hidden" m:id="forwardViewId" m:value="#{eventListEntryAction.viewId}"/>
<input type="hidden" m:id="entryTermKind" m:value="#{eventListEntryAction.entryTermKind}"/>

<!-- オーナー選択フォーム -->
<div m:rendered="#{eventListConditionDto.viewMode == 1}" onkeydown="return setDefaultSubmitButton('eventListEntry', 'btnExecute');">
<table class="body_table" style="float:left;">
	<tr>
		<th>オーナー<input type="submit" value="検索" m:action="#{eventListEntryAction.callOwnerSearch}"/></th>
		<td><input type="text" m:id="onerCd" m:value="#{eventListConditionDto.onerCd}" class="imenotuse" maxlength="5" size="10"/></td>
	</tr>
</table>
<input type="submit" value="実行" id="btnExecute" m:action="#{eventListEntryAction.selectOwner}" style="margin-top:3px;margin-left:4px;"/>
</div>

<!-- イベント一覧表示 -->
<div m:rendered="#{eventListConditionDto.viewMode == 0}">
<!-- イベント一覧あり -->
<div m:class="#{(!eventListResultDto.emptyEventList) ? 'visible_area' : 'invisible_area'}">
<!-- ボタン -->
<div m:rendered="#{birdUserInfo.mstUser.userTypeCd == '01'}" style="margin-bottom:6px;">
	<input type="submit" value="戻る" m:action="#{eventListEntryAction.back}"/>
</div>
<span style="font-weight:bold;">※対象のイベント名称をクリックしてください。</span>
<!-- ヘッダ部 -->
<table  style="margin-top:4px" class="body_table2">

	<tr  class="header_row">
		<th style="width:160px;">対象名</th>
		<th style="width:250px;">開催日</th>
		<th style="width:330px;">イベント名称</th>
		<th style="width:90px;">申込開始</th>
		<th style="width:90px;">申込終了</th>
	</tr>
</table>

<!-- データ部 -->
<div class="scroll_area">
<table style="border-top-width:0px" class="body_table2">

	<div  m:inject="s:forEach" m:items="#{eventListResultDto.eventList}" m:var="e" m:varindex="i">
	<tr m:class="#{(birdDateInfo.sysDate < e.applyFromDt || birdDateInfo.sysDate > e.applyToDt) ? 'close_event' : ''} non_top_border" >
		<!-- 対象名 -->
		<td style="width:160px;"><span m:converter="#{characterEncodingConverter}" m:value="#{e.entryName}"/></td>
		<!-- 開催日 -->
		<td style="width:250px;">
			<!-- 開始日/終了日設定あり -->
			<span m:rendered="#{e.openFromDt != '' && e.openToDt != ''}">
				<span m:value="#{e.openFromDt}" m:converter="#{eventListDateConverter1}"/>
				〜
				<span m:value="#{e.openToDt}" m:converter="#{eventListDateConverter1}"/>
			</span>
			<!-- 終了日設定なし -->
			<span m:value="#{e.openFromDt}" m:converter="#{eventListDateConverter1}" m:rendered="#{e.openFromDt != '' && e.openToDt == ''}"/>
			<!-- 開催日設定なし -->
			<div style="text-align:center;" m:rendered="#{e.openFromDt == '' && e.openToDt == ''}">-</div>
		</td>
		<!-- 説明会名称 -->
		<td style="width:330px;">
			<!-- 申込開始以降 リンク表示 -->
			<div m:rendered="#{birdDateInfo.sysDate >= e.applyFromDt}">
				<!-- 通常イベント -->
				<a href="#" m:rendered="#{e.entryType != '5'}"
						onclick="selectEvent('#{e.entryCd}', '#{e.entryYear}', '#{e.entryKai}', '#{e.viewId}', #{(birdDateInfo.sysDate > e.applyToDt) ? 1 : 0}, '#{birdUserInfo.mstUser.userTypeCd == '02' ? '登録いただくデータは、申込手続き資料作成以外に使用致しません。' : ''}')">
					<span m:converter="#{characterEncodingConverter}" m:value="#{e.entryTitle}"/>
				</a>
				<!-- e-learning -->
				<a href="#{e.viewId}" m:rendered="#{e.entryType == '5'}" target="_blank">
					<span m:converter="#{characterEncodingConverter}" m:value="#{e.entryTitle}"/>
				</a>
			</div>
			<!-- 申込開始前 ラベル表示 -->
			<div m:rendered="#{birdDateInfo.sysDate < e.applyFromDt}">
				<span m:converter="#{characterEncodingConverter}" m:value="#{e.entryTitle}"/>
			</div>
		</td>
		<!-- 申込開始 -->
		<td  style="width:90px;"><span m:value="#{e.onerApplyFromDt}" m:converter="#{eventListDateConverter2}"/></td>
		<!-- 申込終了 -->
		<td  style="width:90px;"><span m:value="#{e.onerApplyToDt}" m:converter="#{eventListDateConverter2}"/></td>
	</tr>
	</div>
</table>
</div>
</div>
<!-- イベント一覧なし -->
<div m:class="#{(eventListResultDto.emptyEventList) ? 'visible_area' : 'invisible_area'}">
<!-- 固定文言 -->
<p>
	※申込対象が存在しません。
</p>
</div>
</div>

</form>
</div>
</body>
</html>
