<html xmlns:m="http://www.seasar.org/maya" m:action="#{mssOnerPointRankAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>ミステリーショッパーズ オーナー別獲得ポイントランク</title>
<span m:inject="f:param" m:name="layoutTitle" m:value="オーナー別獲得ポイントランク"/>
<span m:inject="s:insert" m:name="bodyTitleName">■オーナー別獲得ポイントランク</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BSM009V01"/>
<span m:inject="f:param" m:name="userTypeCd" m:value="#{mssOnerPointRankCsvDto.usertypeCd}"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
</head>
<body>
<span m:inject="s:insert" m:name="body" >
<STYLE type="text/css" media="screen">
<!--
/* テーブルヘッダデフォルト設定 パターン２*/
/* テーブルヘッダのセンタリング用 */
table.body_table2 tr th{
  text-align            : center;
  border                : 1px solid;
}
/* テーブル枠の設定 */
table.tab_table{
  border-style          : solid;
  border-width          : 2px;
  border-collapse       : collapse;
}
table.data_table{
  border-style          : solid;
  border-width          : 2px;
  border-collapse       : collapse;
}
/* テーブルヘッダデフォルト設定 パターン１*/
table.data_table tr.defaultTR{
  background-color      : #FFFFCC;
}
table.data_table tr th{
  border                : 1px solid;
  text-align            : center;
}
table.data_table tr td{
  border                : 1px solid;
  text-align            : right;
}
table.data_table tr td.centerWd{
  border                : 1px solid;
  text-align            : center;
}
table.data_table tr th a{
  color            : blue;
}
/* 表：比率項目表示 */
.hiritu_red{
  background-color      : #C0FFC0;
  color                 : red;
}
.hiritu{
  background-color      : #C0FFC0;
}
/* 表：合計欄表示（タイプ１） */
.body_sum1, table tr.body_sum1 td{
  background-color      : #FFD2E9;
}
/* 表：合計欄表示（タイプ５） */
.body_sum5, table tr.body_sum5 td{
  background-color      : #FFC0A0;
}

//-->
</STYLE>
<script type="text/javascript">
<!--
var userTypeHONBU = "01";
var userTypeONER = "02";
var userTypeMISE = "03";

function load(){
	var elmNendo = document.conditionForm.elements['conditionForm:nendo'];
	var elmKai = document.conditionForm.elements['conditionForm:kai'];
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
	if(elmNendo != null && elmKai != null) {
		document.conditionForm.svsearchbt.disabled = false;
		document.conditionForm.onersearchbt.disabled = false;
		document.conditionForm.misesearchbt.disabled = false;
		document.conditionForm.elements['conditionForm:downloadBt'].disabled = false;
	}
}
/**
 * 会社プルダウンリスト変更時処理
 *
 * 会社プルダウンの値毎に
 * 対象条件プルダウンの内容を変更し、
 * 対象条件プルダウンが変更されることにより表示対象オブジェクトも変更される。
 */
function changeCompanyCd(){
	if(returnLoadingStatus()){
		document.conditionForm.target ="_self";
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:changeCompanyCd';
		document.conditionForm.submit();
	}
}
/**
 * 支部プルダウンリスト変更時処理
 *
 */
function changeSibuCd(){
	document.conditionForm.elements['conditionForm:searchType'][0].click();
}
/**
 * SVテキストフィールド変更時処理
 */
function changeSvCd(){
	document.conditionForm.elements['conditionForm:searchType'][0].click();
}
/**
 * オーナーテキストフィールド変更時処理
 */
function changeOnerCd(){
	document.conditionForm.elements['conditionForm:searchType'][1].click();
}
/**
 * オーナーテキストフィールド変更時処理
 */
function changeMiseCd(){
	document.conditionForm.elements['conditionForm:searchType'][2].click();
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function returnLoadingStatus(){
	if(isLoadingFlgOFF()) {
		setLoadingFlg();
		return true;
	}
	return false;
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function isLoadingFlgOFF(){
	return (document.conditionForm.elements['conditionForm:loadingFlg'].value != "ON");
}
/**
 * ダウンローﾄﾞボタン押下時処理
 *
 */
function execDownLoad(){
	document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:downloadCsv';
	document.conditionForm.submit();
}
/**
 * SV検索ボタン押下時処理
 *
 */
function searchSv(){
	if(returnLoadingStatus()){
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:searchSv';
		document.conditionForm.submit();
	}
}
/**
 * オーナー検索ボタン押下時処理
 *
 */
function searchOner(){
	if(returnLoadingStatus()){
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:searchOner';
		document.conditionForm.target ="_self";
		document.conditionForm.submit();
	}
}
/**
 * 店検索ボタン押下時処理
 *
 */
function searchMise(){
	if(returnLoadingStatus()){
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:searchMise';
		document.conditionForm.target ="_self";
		document.conditionForm.submit();
	}
}


/**
 * ウィンドウロードフラグ設定処理
 *
 *
 */
function setLoadingFlg() {
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "ON";
}
//-->
</script>

<form m:id="conditionForm" onKeyDown="return setDefaultSubmitButton('conditionForm','downloadBt');">
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="hidden" m:id="usertypeCd" m:value="#{userTypeCd}"/>
	<input type="hidden" id="loadingFlg" value=""/>
	<div class="search_condition">
		<a id="changeCompanyCd" m:action="#{mssOnerPointRankAction.changeCompany}"/>
		<a id="searchSv" m:action="#{mssOnerPointRankAction.callSvForm}"/>
		<a id="searchOner" m:action="#{mssOnerPointRankAction.callOnerForm}"/>
		<a id="searchMise" m:action="#{mssOnerPointRankAction.callMiseForm}"/>
	<span m:converter="#{characterEncodingConverter}" m:inject="s:selectOneRadio2" m:id="searchType" m:value="#{mssOnerPointRankCsvDto.searchType}">
	<table>
		<tr>
		<td>
			<table class="body_table">
				<tr>
					<th colspan="2" nowrap=" nowrap">会社</th>
					<td colspan="3">
				        <div class="hideArea">
							<select class="condition_field" 
									m:id="honbuCompanyCd"
									m:value="#{mssOnerPointRankCsvDto.companyCd}"
									m:items="#{mssOnerPointRankCsvDto.companyList}"
									m:itemValue="companyCd"
									m:itemLabel="companyName"
									m:onchange="changeCompanyCd()">
								<option value="00">モスフードサービス</option>
								<option value="01">トモス</option>
								<option value="02">四季菜</option>
							</select>
					  </div>
					</td>
				</tr>
				<tr>
					<th nowrap=" nowrap"><input type="radio" name="searchType" m:value="SIBU" checked="checked"/></th>
					<th nowrap=" nowrap">支部</th>
					<td>
						<div class="hideArea">
							<select class="condition_field" 
									m:id="sibuCd"
									m:value="#{mssOnerPointRankCsvDto.sibuCd}"
									m:items="#{mssOnerPointRankCsvDto.sibuList}"
									m:itemValue="sibuCd"
									m:itemLabel="sibuName"					
									m:onchange="changeSibuCd()">
							    <option value="011">北海道支部</option>
							    <option value="012">東北支部</option>
							    <option value="020">新潟・群馬・栃木支部</option>
							    <option value="022">埼玉支部</option>
							    <option value="023">千葉・茨城支部</option>
							    <option value="031">東京支部</option>
							    <option value="041">神奈川支部</option>
							    <option value="045">甲信支部</option>
							    <option value="046">静岡支部</option>
							    <option value="051">中京北陸支部</option>
							    <option value="061">関西支部</option>
							    <option value="071">中・四国支部</option>
							    <option value="072">九州支部</option>
							    <option value="075">沖縄支部</option>
							    <option value="076">東北販社</option>
							    <option value="077">北関東販社</option>						   
							    <option value="078">南関東販社</option>
							    <option value="079">関西販社</option>
							    <option value="080">九州販社</option>
							    <option value="081">直営本部</option>
							    <option value="082">ＭＬ事業本部ＦＣ支部</option>
							    <option value="083">ＭＬ事業本部直営支部</option>
							    <option value="084">第一業態開発グループ</option>
							    <option value="085">第二業態開発グループ</option>
							    <option value="092">部門</option>
							    <option value="093">子会社トモス</option>
							    <option value="094">子会社なか卯</option>
							    <option value="095">子会社その他</option>
							    <option value="096">外販事業</option>
							    <option value="097">関連事業</option>
							    <option value="098">その他１</option>
							    <option value="099">その他２</option>
							    <option value="100">ちりめん亭ＦＣ</option>
							    <option value="101">ちりめん亭ＲＣ</option>
							    <option value="102">四季菜ＦＣ</option>
							    <option value="103">四季菜ＲＣ</option>
							</select>
						</div>
					</td>
					<th nowrap=" nowrap">
						ＳＶ&nbsp;<input type="button" name="svsearchbt" onClick="searchSv();" value="検索" onDblClick="return false;"  disabled=" disabled"/></th>
					<td>
						<input type="text" m:id="svCd" value="#{mssOnerPointRankCsvDto.svCd}" maxlength="8" size="10" class="imenotuse" onFocus="changeSvCd();"/></td>
				</tr>
				<tr>
					<th nowrap=" nowrap"><input type="radio" name="searchType" m:value="ONER"/></th>
					<th nowrap=" nowrap">
						オーナー&nbsp;<input type="button" name="onersearchbt" value="検索" onClick="searchOner();" onDblClick="return false;" disabled=" disabled"/></th>
					<td colspan="3">
						<input type="text" m:id="onerCd" value="#{mssOnerPointRankCsvDto.onerCd}" maxlength="5" size="10" class="imenotuse" onFocus="changeOnerCd();"/></td>
				</tr>
				<tr>
					<th><input type="radio" name="searchType" m:value="MISE"/></th>
					<th nowrap=" nowrap">個店&nbsp;<input name="misesearchbt" type="button" value="検索" onClick="searchMise();" onDblClick="return false;"  disabled=" disabled"/></th>
					<td colspan="3">
						<input type="text" m:id="miseCd" value="#{mssOnerPointRankCsvDto.miseCd}" maxlength="5" size="10" class="imenotuse" onFocus="changeMiseCd();"/>
					</td>
				</tr>
				<tr>
					<th nowrap=" nowrap" colspan="2">実施年度</th>
					<td colspan="3" nowrap=" nowrap">
			        	<span m:rendered="#{mssOnerPointRankCsvDto.nendoListSize > 0}">      	
							<div class="hideArea">
							<select class="condition_field" 
									m:id="nendo"
									m:value="#{mssOnerPointRankCsvDto.nendo}"
									m:items="#{mssOnerPointRankCsvDto.nendoList}"
									m:itemValue="nendo"
									m:itemLabel="nendoName"
									>
									<option value="2006">2006</option>
									<option value="2005">2005</option>
									<option value="2004">2004</option>
								</select>年度
							</div>
						</span>
					</td>
				</tr>
				<tr>
					<th nowrap=" nowrap" colspan="2">実施回数</th>
					<td nowrap=" nowrap" colspan="3">
			        	<span m:rendered="#{mssOnerPointRankCsvDto.kaiListSize > 0}">      	
							<div class="hideArea">
							第<select class="condition_field" 
									m:id="kai"
									m:value="#{mssOnerPointRankCsvDto.kai}"
									m:items="#{mssOnerPointRankCsvDto.kaiList}"
									m:itemValue="kai"
									m:itemLabel="kaiName"
									>
									<option value="2006">2006</option>
									<option value="2005">2005</option>
									<option value="2004">2004</option>
								</select>回
							</div>
						</span>
					</td>
					</tr>
				</table>
			</td>
		</tr>
		<tr>
			<td align="right">
				<input type="button" name="conditionForm:downloadBt" class="operation_button" value="ダウンロード" onClick="execDownLoad(); return false;" onDblClick="return false" disabled=" disabled"/>
			</td>
		</tr>
		<tr>
			<td align="right">※結果が表示されるまでには、少々時間がかかります。</td>
		</tr>
	</table>
</span>
	<a id="downloadCsv" m:action="#{mssOnerPointRankAction.downloadCsv}"/>
	</div>
</form>
</span>
</body>
</html>
