<html xmlns:m="http://www.seasar.org/maya" m:action="#{campNipoRefMiseListAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>キャンペーン日報結果(店舗一覧)</title>
<span m:inject="f:param" m:name="layoutTitle" m:value="キャンペーン日報"/>
<span m:inject="s:insert" m:name="bodyTitleName">■キャンペーン日報</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBR011V02"/>
<span m:inject="f:param" m:name="userTypeCd" m:value="#{campNipoRefSesDto.userTypeCd}"/>
<span m:inject="f:param" m:name="isHonbuUser" m:value="#{campNipoRefSesDto.userTypeCd=='01'}"/>
<span m:inject="f:param" m:name="isBlockExit" m:value="#{campNipoRefSesDto.userTypeCd=='01' && campNipoRefViewDto.shukeiKbn == 'SIBU'}"/>
<span m:inject="f:param" m:name="isTotal" m:value="#{campNipoRefViewDto.menuTotaledKbn == 'TOTAL'}"/>
<span m:inject="f:param" m:name="isDay" m:value="#{campNipoRefViewDto.taishoKikan == 'DAY'}"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
<span m:inject = "f:param" m:name = "msg" m:value="結果が表示されるまでに時間がかかります。よろしいですか？"/>
</head>
<body>
<span m:inject="s:insert" m:name="body" >
<STYLE type="text/css">
<!--
table.body_table2 tr td.nameArea{
  font-weight           : bold;
}
table.body_table2 tr td.cenArea{
  text-align            : center;
}
/* 表：比率項目表示 */
.default_bkgColor td.hiritu{
  background-color      : #C0FFC0;
}
.scroll_area {
    width:*;
	height:	  385px;
}
.data_table_width {
    width:98%;
}
.width_TotalBlock {
    width:87px;
}
.width_Block {
    width:72px;
}
.width_Mise {
    width:*;
}
.width_Menu {
    width:200px;
}
.width_Uriage {
    width:90px;
}
.width_MenuUriage {
    width:80px;
}
.width_KazuKei {
    width:50px;
}
.width_KoseiHi {
	width:56px;
}
.width_Hiritu {
    width:55px;
}
.width_Rank_Sibu {
    width:70px;
}
.width_Rank {
    width:89px;
}
.width_Tenko {
    width:38px;
}
//-->
</STYLE>
<script type="text/javascript">
<!--
var userTypeHONBU = "01";
var userTypeONER = "02";
var userTypeMISE = "03";
var scrollMaxHeight = 379;
function load(){
	if(document.conditionForm != null && document.conditionForm.elements['conditionForm:windowId'] != null) {
		document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
		if(document.conditionForm.elements['downloadBt'] != null) {
			document.conditionForm.elements['downloadBt'].disabled = "";
		}
	  	if("KINGAKU_KOSEIHI"==document.conditionForm.elements['conditionForm:view_rankKind'].value) {
	  		scrollMaxHeight = 362;
	  	}
	  	loadScroll("result_0:campNipoScroll", scrollMaxHeight);
  	}
}
/**
 * 会社プルダウンリスト変更時処理
 *
 * 会社プルダウンの値毎に
 * 対象条件プルダウンの内容を変更し、
 * 対象条件プルダウンが変更されることにより表示対象オブジェクトも変更される。
 */
function changeCompanyCd(){
	if(returnLoadingStatus()){
		setJokenData();
		document.conditionForm.target ="_self";
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:changeCompanyCd';
		document.conditionForm.submit();
	}
}
/**
 * キャンペーンプルダウンリスト変更時処理
 *
 * キャンペーンプルダウンの値毎に
 * 対象日プルダウンの内容を変更される。
 */
function changeCampaign(myElemtnt){
    //対象日プルダウン変更処理
    var sIndex = myElemtnt.selectedIndex;
    var campId = myElemtnt.options[sIndex].value;
    var taishoKikanElem = document.conditionForm.elements['conditionForm:taishoKikan'];
    var taishoKikan = taishoKikanElem.options[taishoKikanElem.selectedIndex].value;
    if("TOTAL"!=taishoKikan) {
	    //キャンペーン別対象日プルダウン設定処理
	    changeDisplay("div", "pdwn_taishoDt_", campId);
	}
	//対象日プルダウンリストエレメント取得処理
	var	elementPullDown = getPullDownElement("select", "pdwn_taishoDt_", campId);
	elementPullDown.selectedIndex=0;
	//対象支部設定
	if(isUserType(userTypeHONBU)) {
		elementTarget = document.conditionForm.elements['conditionForm:shukeiKbn'];
	    var shukeiKbn = elementTarget.options[elementTarget.selectedIndex].value;
		document.conditionForm.elements['conditionForm:shukeiKbn'].value= shukeiKbn;
	    //対象支部プルダウン設定
	   	changeDisplay("div", "pdwn_hyojiTaisho_", campId+shukeiKbn);
	    //対象支部プルダウンリストエレメント取得処理
		elementPullDown = getPullDownElement("select", "pdwn_hyojiTaisho_", campId+shukeiKbn);
		elementPullDown.selectedIndex=0;
	}
}
/**
 * 店舗種別プルダウン変更処理
 *
 * 店舗種プルダウンの値毎に
 * 前年データ種別のプルダウンの内容を変更
 *
 */
function changeTenposShu(myElemtnt) {
    var sIndex = myElemtnt.selectedIndex;
    var selectedCd = myElemtnt.options[sIndex].value;
    //前年データ種別プルダウン設定
//   	changeDisplay("div", "pdwn_zds_", selectedCd);
	//前年データ種別プルダウンリストエレメント取得処理
//	var	elementPullDown = getPullDownElement("select", "pdwn_zds_", selectedCd);
//	elementPullDown.selectedIndex=0;
}
/**
 * 集計区分プルダウン変更処理
 *
 * 集計区分プルダウンの値毎に
 * 対象支部のプルダウンの内容を変更
 *
 */
function changeShukeiKbn(myElemtnt) {
	var elementTarget = document.conditionForm.elements['conditionForm:campId'];
    var campId = elementTarget.options[elementTarget.selectedIndex].value;
    var sIndex = myElemtnt.selectedIndex;
    var shukeiKbn = myElemtnt.options[sIndex].value;
    if(isUserType(userTypeHONBU)) {
	    //対象支部プルダウン設定
	   	changeDisplay("div", "pdwn_hyojiTaisho_", campId+shukeiKbn);
	   	document.conditionForm.elements['conditionForm:taishoJoken'].value = shukeiKbn;
	    //プルダウンリストエレメント取得処理
		var elementPullDown = getPullDownElement("select", "pdwn_hyojiTaisho_", campId+shukeiKbn);
		elementPullDown.selectedIndex=0;
   	}
}

/**
 * 検索ボタン押下時処理
 *
 */
function search(){
	if(returnLoadingStatus()){
		setJokenData();
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:search';
		if(document.conditionForm.newWinFlg != null
				&& document.conditionForm.newWinFlg.checked) {
			document.conditionForm.elements['conditionForm:newWindowFlg'].value=true;
			document.conditionForm.target ="_blank";
			document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
		}else{
			document.conditionForm.elements['conditionForm:newWindowFlg'].value=false;
			document.conditionForm.target ="_self";
		    document.conditionForm.elements["conditionForm:btnExecute"].disabled = true;
		    if(document.getElementById("conditionForm:pane_result") != null) {
		    	document.getElementById("conditionForm:pane_result").style.display = "none";
		   	}
		    document.getElementById("conditionForm:pane_waitmsg").style.display = "inline";
		}
		document.conditionForm.submit();
	}
}
/**
 * 指定店舗一覧画面表示処理
 */
function linkUp(miseCd) {
	document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:linkUp';
	document.conditionForm.target ="_blank";
	document.conditionForm.elements['conditionForm:newWindowFlg'].value=false;
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
	document.conditionForm.submit();
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function returnLoadingStatus(){
	if(isLoadingFlgOFF()) {
		setLoadingFlg();
		return true;
	}
	return false;
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function isLoadingFlgOFF(){
	return (document.conditionForm.elements['conditionForm:loadingFlg'].value != "ON");
}
/**
 * ダウンローﾄﾞボタン押下時処理
 *
 */
function execDownLoad(){
	if(isLoadingFlgOFF()){
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:downloadCsv';
		document.conditionForm.target ="_self";
		document.conditionForm.submit();
	}
}

/**
 * ユーザータイプ判別処理
 *
 */
function isUserType(code){
	var userType = document.conditionForm.elements['conditionForm:userTypeCd'].value;
	return (code == userType);
}
/**
 * 会社コードモスフード判別処理
 *
 */
function isCompanyCdMos(){
	var companyCd = "";
    companyCd = document.conditionForm.elements['conditionForm:companyCd'].value;
	return (companyCd == "00");
}

/**
 * ウィンドウロードフラグ設定処理
 *
 *
 */
function setLoadingFlg() {
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "ON";
}
/**
 * 検索条件値設定処理
 *
 */
function setJokenData(){
	//対象日設定
	var elementTarget = document.conditionForm.elements['conditionForm:campId'];
    var campId = elementTarget.options[elementTarget.selectedIndex].value;
    elementTarget = document.conditionForm.elements['conditionForm:taishoKikan'];
    var taishoKikan = elementTarget.options[elementTarget.selectedIndex].value;
    var taishoDtFrom = "";
    var taishoDtTo = "";
    if("DAY"==taishoKikan || "DAYS"==taishoKikan) {
    //プルダウンリストエレメント取得処理
		var taishoDtPullDown = getPullDownElement("select", "pdwn_taishoDt_", campId+"_FROM");
		taishoDtFrom = taishoDtPullDown.options[taishoDtPullDown.selectedIndex].value;
		taishoDtPullDown = getPullDownElement("select", "pdwn_taishoDt_", campId+"_TO");
		taishoDtTo = taishoDtPullDown.options[taishoDtPullDown.selectedIndex].value;
	}
	document.conditionForm.elements['conditionForm:taishoDt'].value=taishoDtFrom;
	document.conditionForm.elements['conditionForm:taishoDtTo'].value=taishoDtTo;

	//店舗種別設定
	elementTarget = document.conditionForm.elements['conditionForm:pldwnTenpoShubetu'];
	if(elementTarget != null) {
	    var targetCode = elementTarget.options[elementTarget.selectedIndex].value;
		document.conditionForm.elements['conditionForm:tenpoShubetu'].value= targetCode;
	}
	var tenpoShubetu = document.conditionForm.elements['conditionForm:tenpoShubetu'].value;
	//前年データ種別設定
    //プルダウンリストエレメント取得処理
//	elementPullDown = getPullDownElement("select", "pdwn_zds_", tenpoShubetu);
//	var zenDataShubetu = elementPullDown.options[elementPullDown.selectedIndex].value;
//	document.conditionForm.elements['conditionForm:zennenDataShubetu'].value=zenDataShubetu;

	//対象支部設定
	if(isUserType(userTypeHONBU)) {
		elementTarget = document.conditionForm.elements['conditionForm:shukeiKbn'];
	    var shukeiKbn = elementTarget.options[elementTarget.selectedIndex].value;
	    //プルダウンリストエレメント取得処理
		elementPullDown = getPullDownElement("select", "pdwn_hyojiTaisho_", campId+shukeiKbn);
		var targetSibu = elementPullDown.options[elementPullDown.selectedIndex].value;
		document.conditionForm.elements['conditionForm:hyojiTaisho'].value=targetSibu;
	}
}
/**
 * プルダウンリストエレメント取得処理
 */
function getPullDownElement(targetTag, commonClassName, targetCode) {
	var objsDiv = document.conditionForm.getElementsByTagName(targetTag);
	for (i = 0; i < objsDiv.length; i++) {
		var classNm = objsDiv[i].className;
		if(classNm.indexOf(commonClassName)>=0){
			if(classNm.indexOf(targetCode)>=0) {
				return elementPullDown = objsDiv[i];
			}
		}
	}
	return null;
}
/*
 * 対象期間タブ切り替え
 */
function changeTab(taishoKikan, isSearched) {
	document.conditionForm.elements['conditionForm:loadingFlg'].value = "";
	document.conditionForm.elements['conditionForm:view_taishoKikan'].value= taishoKikan;
	if(isSearched) {
		var firstCalssNm ="view_";
		changeDisplay("div", firstCalssNm, taishoKikan);
		var objs = document.conditionForm.getElementsByTagName("table");
		firstCalssNm =firstCalssNm+"tab_";
		for (i = 0; i < objs.length; i++) {
			var classNm = objs[i].className;
			if(classNm.substring(0,firstCalssNm.length) == firstCalssNm){
				var lastClassNm = classNm.substring(firstCalssNm.length, (firstCalssNm.length+taishoKikan.length));
				if(lastClassNm == taishoKikan) {
					objs[i].className = firstCalssNm+lastClassNm+" body_active_cell";
				}else{
					objs[i].className = firstCalssNm+lastClassNm+" body_non_active_cell";
				}
			}
		}
	    objs = document.conditionForm.getElementsByTagName("a");
		for (i = 0; i < objs.length; i++) {
			var classNm = objs[i].className;
			if(classNm.substring(0,firstCalssNm.length) == firstCalssNm){
				var lastClassNm = classNm.substring(firstCalssNm.length, (firstCalssNm.length+taishoKikan.length));
				if(lastClassNm == taishoKikan) {
					objs[i].className = firstCalssNm+lastClassNm+" body_selected_link";
				}else{
					objs[i].className = firstCalssNm+lastClassNm+" body_non_selected_link";
				}
			}
		}
	}
	else {
		setLoadingFlg();
		setJokenData();
		document.conditionForm.elements['conditionForm:view_taishoKikan'].value= taishoKikan;
		document.conditionForm.elements['conditionForm:__link_clicked__'].value='conditionForm:changeTab';
		document.conditionForm.target ="_self";
//		if(taishoKikan == "DAYS") {
		    document.conditionForm.elements["conditionForm:btnExecute"].disabled = true;
		    if(document.getElementById("conditionForm:pane_result") != null) {
		    	document.getElementById("conditionForm:pane_result").style.display = "none";
		   	}
		    document.getElementById("conditionForm:pane_waitmsg").style.display = "inline";
//	    }
		document.conditionForm.submit();
	}
}
/*
 * 条件フォーム用表示ステータス変更処理
 */
function changeDisplay(targetTag, firstCalssNm, lastClassNm) {
	var objs = document.conditionForm.getElementsByTagName(targetTag);
	for (i = 0; i < objs.length; i++) {
		var classNm = objs[i].className;
		if(classNm.indexOf(firstCalssNm)>=0){
			if(lastClassNm != "" && classNm.indexOf(lastClassNm)>=0) {
				objs[i].style.display     = "inline";
			}else{
				objs[i].style.display   = "none";
			}
		}
	}
}
/**
 * 対象期間プルダウン変更時処理
 *
 */
function changeTaishoKikan(myElemtnt) {
    var sIndex = document.conditionForm.elements['conditionForm:campId'].selectedIndex;
    var campId = document.conditionForm.elements['conditionForm:campId'].options[sIndex].value;
    sIndex = myElemtnt.selectedIndex;
    var selectedCd = myElemtnt.options[sIndex].value;
	var fromPullDown = getPullDownElement("select", "pdwn_taishoDt_"+campId, "FROM");
	fromPullDown.selectedIndex = 0;
	var toPullDown = getPullDownElement("select", "pdwn_taishoDt_"+campId, "TO");
	toPullDown.selectedIndex = 0;
    //期間指定日プルダウン表示制御処理
    if("DAY" == selectedCd) {
   		changeDisplay("div", "pdwn_taishoKikan", "");
	    //キャンペーン別対象日プルダウン設定処理
	    changeDisplay("div", "pdwn_taishoDt_", campId);
   	}
   	else if("TOTAL" == selectedCd) {
   		changeDisplay("div", "pdwn_taishoDt_", "");
   	}
   	else if("DAYS" == selectedCd) {
   		changeDisplay("div", "pdwn_taishoKikan_", "DAYS");
	    //キャンペーン別対象日プルダウン設定処理
	    changeDisplay("div", "pdwn_taishoDt_", campId);
   	}
}
//-->
</script>
<div m:rendered="#{campNipoRefReqDto.listsCamp == null}">
  <p/>
  <span style="font-weight:bold;">現在表示期間中のキャンペーンは存在しません。</span>
</div>
<span m:rendered="#{campNipoRefReqDto.listsCamp != null}">
	<form m:id="conditionForm" onKeyDown="return setDefaultSubmitButton('conditionForm','btnExecute');">
		<input type="hidden" id="viewId" m:value="#{campNipoRefReqDto.viewId}" />
		<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
		<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
		<input type="hidden" id="windowId" m:value="#{campNipoRefReqDto.windowId}"/>
		<input type="hidden" id="userTypeCd" m:value="#{campNipoRefSesDto.userTypeCd}" m:passthrough="true"/>
		<input type="hidden" id="loadingFlg" value=""/>
		<input type="hidden" id="nendo" m:value="#{campNipoRefReqDto.nendo}"/>
		<input type="hidden" id="companyCd" m:value="#{campNipoRefReqDto.companyCd}"/>
		<input type="hidden" id="newWindowFlg" m:value="#{campNipoRefReqDto.newWindowFlg}"/>
	    <input type="hidden" id="jyokenMsg" m:value="#{msg}"/>
			<a id="changeCompany" m:action="#{campNipoRefMiseListAction.changeCompany}"/>
			<a id="changeCamp" m:action="#{campNipoRefMiseListAction.changeCamp}"/>
			<a id="search" m:action="#{campNipoRefMiseListAction.search}"/>
		<table class="table_hidden">
		<tr><td rowspan="2">
			<table class="body_table element_browser"
		       style="margin-bottom:4px;">
		    <tr>
		      <th>キャンペーン</th>
		      <td colspan="2">
		        <div class="hideArea">
					<select m:id="campId"
							m:value="#{campNipoRefReqDto.campId}"
							m:items="#{campNipoRefReqDto.listsCamp}"
							m:itemValue="campId"
							m:itemLabel="campTitle"
							m:onchange="changeCampaign(this)">
						<option value="00">モスフードサービス</option>
						<option value="01">トモス</option>
						<option value="02">四季菜</option>
					</select>
					<select m:id="menuTotaledKbn"
							m:value="#{campNipoRefReqDto.menuTotaledKbn}"
							m:items="#{campNipoRefSesDto.listMenuTotaled}"
							m:itemValue="code"
							m:itemLabel="name"
							>
						<option value="TOTAL">メニュー合計</option>
						<option value="TANPIN">単品</option>
						<option value="SHUYAKU">単品(集約)</option>
					</select>
				  </div></td>
		      <th m:rendered="#{isHonbuUser}">店舗種別</th>
		      <td m:rendered="#{isHonbuUser}">
		          <div class="hideArea">
					<select m:id="pldwnTenpoShubetu"
							m:value="#{campNipoRefReqDto.tenpoShubetu}"
							m:items="#{campNipoRefSesDto.listTenpoShubetu}"
							m:itemValue="code"
							m:itemLabel="name"
							m:onchange="changeTenposShu(this)">
						<option value="ALL">全店</option>
						<option value="1">前年対象店</option>
						<option value="2">予算対象店</option>
						<option value="3">新店</option>
					</select>
		          </div></td>
				 <th><span m:value="#{(isHonbuUser)? '集計区分':'支部'}"/></th>
				 <td colspan="2">
					<div class="hideArea">
					<select m:id="shukeiKbn"
							m:value="#{campNipoRefReqDto.shukeiKbn}"
							m:items="#{campNipoRefSesDto.listShukeiKbn}"
							m:itemValue="code"
							m:itemLabel="name"
							m:onchange="changeShukeiKbn(this)">
							<option value="SIBU">直営・販社含まない</option>
							<option value="AREA_DAI">直営・販社含む</option>
						</select>
					</div>
				</td>
			</tr>
			<tr>
				<th>対象期間</th>
				<td width="85px" style="border-right-width:0px;">
					<div class="hideArea">
						<select m:id="taishoKikan"
								m:value="#{campNipoRefReqDto.taishoKikan}"
								m:items="#{campNipoRefSesDto.listTaishoKikan}"
								m:itemValue="code"
								m:itemLabel="name"
								m:onchange="changeTaishoKikan(this)"
								>
							<option value="DAY">単日</option>
							<option value="TOTAL">期間合計</option>
							<option value="DAYS">期間指定</option>
						</select>
					</div>
				</td>
				<td width="*" style="width:270px;border-left-width:0px;">
					<div class="hideArea">
						<span m:inject="s:forEach"
						      m:items="#{campNipoRefReqDto.listsTaishoDt}"
						      m:var="listInfo" m:varindex="i">
							<div class="pdwn_taishoDt_#{listInfo.key}"
							     style="display:#{(listInfo.key==campNipoRefReqDto.campId) == true && campNipoRefReqDto.taishoKikan!='TOTAL'? 'inline;' : 'none;'}">
							<select class="pdwn_taishoDt_#{listInfo.key}_FROM"
								m:value="#{campNipoRefReqDto.taishoDt}"
								m:items="#{listInfo.listData}"
								m:itemValue="code"
								m:itemLabel="name"
								>
								<option value="20080501">2008/05</option>
								<option value="20080401">2008/04</option>
								<option value="20080301">2008/03</option>
								<option value="20080201">2008/02</option>
								<option value="20080101">2008/01</option>
							</select>
							<div class="pdwn_taishoKikan_DAYS"
                                 style="display:#{campNipoRefReqDto.taishoKikan=='DAYS'? 'inline;':'none;'}">〜 <select class="pdwn_taishoDt_#{listInfo.key}_TO"
								m:value="#{campNipoRefReqDto.taishoDtTo}"
								m:items="#{listInfo.listData}"
								m:itemValue="code"
								m:itemLabel="name"
								>
								<option value="20080501">2008/05</option>
								<option value="20080401">2008/04</option>
								<option value="20080301">2008/03</option>
								<option value="20080201">2008/02</option>
								<option value="20080101">2008/01</option>
							</select>
							</div>
							</div>
						</span>
					</div>
				</td>
				<th m:rendered="#{isHonbuUser}">対象支部</th>
				<td m:rendered="#{isHonbuUser}">
				<div class="hideArea">
					<div m:inject="s:forEach" m:items="#{campNipoRefReqDto.listsHyojiTaisho}" m:var="listsInfo" m:varindex="i">
					<span m:inject="s:forEach" m:items="#{listsInfo.listData}" m:var="listInfo" m:varindex="s">
						<div class="pdwn_hyojiTaisho_#{listsInfo.key}#{listInfo.key}" style="#{(listsInfo.key==campNipoRefReqDto.campId && listInfo.key==campNipoRefReqDto.shukeiKbn) == true ? '' : 'display:none;'}">
						<select m:rendered="#{listInfo.listData != null}" class="pdwn_hyojiTaisho_#{listsInfo.key}#{listInfo.key}"
							m:value="#{campNipoRefReqDto.hyojiTaisho}"
							m:items="#{listInfo.listData}"
							m:itemValue="hyojitaishoCd"
							m:itemLabel="hyojitaishoName"
							>
						    <option value="011">北海道支部</option>
						    <option value="012">東北支部</option>
						    <option value="020">新潟・群馬・栃木支部</option>
						    <option value="022">埼玉支部</option>
						    <option value="023">千葉・茨城支部</option>
						    <option value="031">東京支部</option>
						</select>
						</div>
					</span>
					</div>
				</div></td>
				<th>順位</th>
				<td style="border-right-width:0px;">
					<div class="hideArea">
						<select m:id="rankKind"
							m:value="#{campNipoRefReqDto.rankKind}"
							m:items="#{campNipoRefSesDto.listRankKind}"
							m:itemValue="code"
							m:itemLabel="name"
							>
						    <option value="KINKOSEIHI">金額構成比</option>
						    <option value="KOSU">個数</option>
						</select>
					</div>
				</td>
		<td style="border-left-width:0px;">
		<input type="button"  name="conditionForm:btnExecute"
		       m:value="#{campNipoRefReqDto.searched=='true'?'再検索':'実行'}"
		       class="operation_button" style="margin:0px;margin-left:3px;"
		       onClick="return search();" onDblClick="return false;"/>
		</td>
		</tr>
		</table>
		</td>
		<td>
			<span style="font-size:11pt;" m:value="#{'01'!=campNipoRefSesDto.userTypeCd?'※MSC＝モスストアカンパニー(旧販社)':''}"/><br/>
		</td>
		</tr>
		<tr><td>&nbsp;</td></tr>
		</table>
		<input type="hidden" id="tenpoShubetu" m:value="#{campNipoRefReqDto.tenpoShubetu}"/>
		<input type="hidden" id="taishoJoken" m:value="#{campNipoRefReqDto.taishoJoken}"/>
		<input type="hidden" id="hyojiTaisho" m:value="#{campNipoRefReqDto.hyojiTaisho}"/>
		<input type="hidden" id="taishoDt" m:value="#{campNipoRefReqDto.taishoDt}"/>
		<input type="hidden" id="taishoDtTo" m:value="#{campNipoRefReqDto.taishoDtTo}"/>
		<input type="hidden" id="zennenDataShubetu" m:value="#{campNipoRefReqDto.zennenDataShubetu}"/>
		<input type="hidden" id="view_viewId" m:value="#{campNipoRefViewDto.viewId}" />
		<input type="hidden" id="view_windowId" m:value="#{campNipoRefViewDto.windowId}"/>
		<input type="hidden" id="view_companyCd" m:value="#{campNipoRefViewDto.companyCd}"/>
		<input type="hidden" id="view_nendo" m:value="#{campNipoRefViewDto.nendo}"/>
		<input type="hidden" id="view_campId" m:value="#{campNipoRefViewDto.campId}"/>
		<input type="hidden" id="view_menuTotaledKbn" m:value="#{campNipoRefViewDto.menuTotaledKbn}"/>
		<input type="hidden" id="view_tenpoShubetu" m:value="#{campNipoRefViewDto.tenpoShubetu}"/>
		<input type="hidden" id="view_shukeiKbn" m:value="#{campNipoRefViewDto.shukeiKbn}"/>
		<input type="hidden" id="view_taishoKikan" m:value="#{campNipoRefViewDto.taishoKikan}"/>
		<input type="hidden" id="view_taishoJoken" m:value="#{campNipoRefViewDto.taishoJoken}"/>
		<input type="hidden" id="view_hyojiTaisho" m:value="#{campNipoRefViewDto.hyojiTaisho}"/>
		<input type="hidden" id="view_taishoDt" m:value="#{campNipoRefViewDto.taishoDt}"/>
		<input type="hidden" id="view_taishoDtTo" m:value="#{campNipoRefViewDto.taishoDtTo}"/>
		<input type="hidden" id="view_rankKind" m:value="#{campNipoRefViewDto.rankKind}"/>
		<input type="hidden" id="view_zennenDataShubetu" m:value="#{campNipoRefViewDto.zennenDataShubetu}"/>
		<a id="downloadCsv" m:action="#{campNipoRefCsvDownloadAction.downloadCsv}"/>
		<a id="linkUp" m:action="#{campNipoRefMiseListAction.linkUp}"/>
<div m:id="pane_waitmsg" style="display:none">
<p/><span style="font-weight:bold;">検索しています。しばらくお待ち下さい・・・</span>
</div>
<div m:rendered="#{campNipoRefViewDto.existSearchedData}" m:id="pane_result">
	<div class="element_print">
      <table>
        <tr>
	        <td>キャンペーン：<select
					m:value="#{campNipoRefViewDto.campId}"
					m:items="#{campNipoRefViewDto.listsCamp}"
					m:itemValue="campId"
					m:itemLabel="campTitle"/>
			</td>
	        <td><select
					m:value="#{campNipoRefViewDto.menuTotaledKbn}"
					m:items="#{campNipoRefSesDto.listMenuTotaled}"
					m:itemValue="code"
					m:itemLabel="name"/>
			</td>
	        <td m:rendered="#{isHonbuUser}">店舗種別：<select
					m:value="#{campNipoRefViewDto.tenpoShubetu}"
					m:items="#{campNipoRefSesDto.listTenpoShubetu}"
					m:itemValue="code"
					m:itemLabel="name"/>
			</td>
	    </tr>
      </table>
      <table>
        <tr>
	        <td><span m:value="#{(isHonbuUser)? '集計区分':'支部'}"/>：<select
					m:value="#{campNipoRefViewDto.shukeiKbn}"
					m:items="#{campNipoRefSesDto.listShukeiKbn}"
					m:itemValue="code"
					m:itemLabel="name"/>
			</td>
			<td>対象期間：<select
					m:value="#{campNipoRefViewDto.taishoKikan}"
					m:items="#{campNipoRefSesDto.listTaishoKikan}"
					m:itemValue="code"
					m:itemLabel="name"
					></select>
			</td>
		<span m:rendered="#{isHonbuUser}" m:inject="s:forEach"
		      m:items="#{campNipoRefReqDto.listsHyojiTaisho}" m:var="listsInfo" m:varindex="i">
			<span m:inject="s:forEach" m:items="#{listsInfo.listData}" m:var="listInfo" m:varindex="s">
			<td m:rendered="#{(listsInfo.key==campNipoRefViewDto.campId && listInfo.key==campNipoRefViewDto.shukeiKbn)}">対象支部：<select class="pdwn_hyojiTaisho_#{listsInfo.key}#{listInfo.key}"
				m:value="#{campNipoRefViewDto.hyojiTaisho}"
				m:items="#{listInfo.listData}"
				m:itemValue="hyojitaishoCd"
				m:itemLabel="hyojitaishoName"
				>
			    <option value="011">北海道支部</option>
			    <option value="012">東北支部</option>
			    <option value="020">新潟・群馬・栃木支部</option>
			    <option value="022">埼玉支部</option>
			    <option value="023">千葉・茨城支部</option>
			    <option value="031">東京支部</option>
			</select>
			</td>
			</span>
		</span>
	    </tr>
	  </table>
      <table>
        <tr>
	        <td>順位：<select
				m:value="#{campNipoRefViewDto.rankKind}"
				m:items="#{campNipoRefSesDto.listRankKind}"
					m:itemValue="code"
					m:itemLabel="name"
					>
				</select>
			</td>
		<div m:inject="s:forEach" m:items="#{campNipoRefSesDto.listsZennenDataShubetu}" m:var="listInfo" m:varindex="i">
	        <td m:rendered="#{listInfo.key==campNipoRefViewDto.tenpoShubetu}">前年データ種別：<select class="pdwn_zds_#{listInfo.key}"
						m:value="#{campNipoRefViewDto.zennenDataShubetu}"
						m:items="#{listInfo.listData}"
						m:itemValue="code"
						m:itemLabel="name"
						>
				</select>
			</td>
		</div>
	    </tr>
	  </table>
	</div>
    <span m:id="result" m:inject="s:forEach" m:items="#{campNipoRefViewDto.listSearchData}" m:var="uiTabSearchData" m:varindex="i">
		<div m:renderd="#{uiTabSearchData.key==campNipoRefViewDto.taishoKikan}"
		     class="view_#{uiTabSearchData.key}"
		     style="#{((campNipoRefViewDto.taishoKikan == null && i==0) || uiTabSearchData.key==campNipoRefViewDto.taishoKikan) ? '' : 'display:none;'}">
		<!--対象日モード-->
		<div class="scroll_padding_head">
			<div class="scroll_hidden margin_bottom_hidden" style="margin-top:4px;">
			<table class="hiddenBody data_table_width" style="margin-bottom:4px;">
				<tr>
					<td>
						<table class="body_table2"
						       style="#{((campNipoRefViewDto.taishoKikan == null && i==0) || uiTabSearchData.key==campNipoRefViewDto.taishoKikan) ? 'display:;' : 'display:none;'}">
							<tr class="view_header_#{uiTabSearchData.key}">
								<th>対象期間</th>
								<td><span m:converter="#{characterEncodingConverter}" m:value="#{uiTabSearchData.taishoKikan}"/>&nbsp;</td>
								<th m:rendered="#{campNipoRefViewDto.taishoJoken!='MISE'}">対象店舗数</th>
								<td m:rendered="#{campNipoRefViewDto.taishoJoken!='MISE'}" align="right" width="50px"><span m:value="#{uiTabSearchData.taishoTenpoCnt}"
								                                     m:converter="#{commonCampaignNumConverter}"/></td>
									<th m:rendered="#{isHonbuUser}">対象支部</th>
									<td m:rendered="#{isHonbuUser}" align="right"><span m:converter="#{characterEncodingConverter}" m:value="#{campNipoRefViewDto.hyojiTaishoName}"/>&nbsp;</td>
							</tr>
						</table>
					</td>
		        	<td align="right" class=" element_browser">
		        		<table class="hiddenBody">
		        		<tr><td>
						<input type="button" name="downloadBt" value="ダウンロード"
						       onClick="execDownLoad(); return false;" onDblClick="return false"/></td>
						<td><input type="checkbox" name="newWinFlg" m:passthrough="true"/>別ウィンドウに表示</td>
						</tr>
						</table>
					</td>
		        </tr>
			</table>
			<div m:rendered="#{'KINGAKU_KOSEIHI'==campNipoRefViewDto.rankKind}"
			     class="data_table_width"
			     style="text-align:right;font-weight:bold;">※「順位」は金額構成比の絶対値に基づき表示しています。</div>
			<table class="body_table2 data_table_width">
				<tr class="header_row">
					<th m:rendered="#{isBlockExit}" class="width_#{(isTotal? 'Total':'')}Block">ブロック</th>
					<th class="width_Mise">店名称</th>
					<th m:rendered="#{isTotal==false}" class="width_Menu">メニュー</th>
					<th class="width_Tenko"><span m:value="#{isDay? '天候':'日数'}"/></th>
					<th class="width_KazuKei">個数</th>
					<th class="width_MenuUriage">販売金額</th>
					<th class="width_KoseiHi">構成比</th>
					<th m:rendered="#{isTotal}" class="width_Uriage">売上</th>
					<th m:rendered="#{isTotal}" class="width_Uriage">前年売上</th>
					<th m:rendered="#{isTotal}" class="width_Hiritu">前年比</th>
					<th class="width_Tenko"><span m:value="#{isDay?'前年':'日数'}"/></th>
					<th class="width_Rank_Sibu">支部順位</th>
					<th class="width_Rank">全国順位</th>
				</tr>
			</table>
			</div>
			</div>
			<table m:rendered="#{uiTabSearchData.searchDataExist==false}" class="data_table_width" height="50px">
				<tr><td align="center" valign="middle">該当日のデータはありません。</td></tr>
			</table>
			<div class="scroll_padding_data_no">
			<div m:rendered="#{uiTabSearchData.searchDataExist}"
			     class="scroll_complete" id="campNipoScroll" style="height:#{'KINGAKU_KOSEIHI'==campNipoRefViewDto.rankKind?'362':'379'}px;">
				<table class="body_table2 data_table_width" style="border-top-width : 0px;">
			    	<span m:inject="s:forEach" m:items="#{uiTabSearchData.listData}" m:var="ui" m:varindex="e">
				      <tr class="#{ui.trCssClass} non_top_border">
					      <td m:rendered="#{isBlockExit}" class="font_size_14 nameArea width_#{(isTotal? 'Total':'')}Block">
					      	<span m:converter="#{characterEncodingConverter}" m:value="#{ui.blockName}"/></td>
						  <td class="nameArea">
						  	<a m:rendered="#{ui.miseCd != null && isTotal}" href="javaScript:void(0);"
						  	  onClick="linkUp(#{ui.miseCd}); return false;"><span m:converter="#{characterEncodingConverter}" m:value="#{(isHonbuUser? ui.miseCd: '')} #{ui.miseNameKj}"/></a>
						  	<span m:rendered="#{(ui.miseCd == null || isTotal==false)}">
						  	    <span m:rendered="#{campNipoRefViewDto.shukeiKbn == 'SIBU'}">
						  	      <span m:converter="#{characterEncodingConverter}" m:rendered="#{isHonbuUser}" m:style="#{ui.groupRowNo>1? 'color : #CFCFCF;':''}" m:value="#{(isHonbuUser? ui.miseCd: '')} #{ui.miseNameKj}"/>
						  	      <span m:converter="#{characterEncodingConverter}" m:rendered="#{campNipoRefSesDto.userTypeCd!='01'}"><span m:converter="#{characterEncodingConverter}" m:rendered="#{ui.miseCd != null}" m:style="#{ui.groupRowNo>1? 'color : #CFCFCF;':''}" m:value="#{(isHonbuUser? ui.miseCd: '')} #{ui.miseNameKj}"/><span m:converter="#{characterEncodingConverter}" m:rendered="#{ui.miseCd == null && ui.groupRowNo == 1}" m:value="#{ui.miseNameKj}"/></span>
						  	    </span>
						  	    <span m:converter="#{characterEncodingConverter}" m:rendered="#{campNipoRefViewDto.shukeiKbn != 'SIBU'}" m:style="#{ui.groupRowNo>1? 'color : #CFCFCF;':''}" m:value="#{(isHonbuUser? ui.miseCd: '')} #{ui.miseNameKjForAreaDai}"/>
						  	</span></td>
				          <td m:rendered="#{isTotal==false}" class="font_size_14 width_Menu"><span m:converter="#{characterEncodingConverter}" m:value="#{ui.menuNameKj}"/></td>
						  <td class="#{(isDay? 'cenArea':'body_num')} width_Tenko">
						  		<span m:value="#{(isDay? ui.tenkoKbnKigou:ui.eigyoDays)}"/></td>
						  <td class="body_num width_KazuKei"><span m:value="#{ui.kazuKei}" m:converter="#{commonCampaignNumConverter}"/></td>
						  <td class="body_num width_MenuUriage"><span m:value="#{ui.menuUriage}" m:converter="#{commonCampaignNumConverter}" /></td>
						  <td class="body_num width_KoseiHi hiritu"><span m:value="#{ui.kingakuKouseiHi}"/></td>
						  <td m:rendered="#{isTotal}" class="body_num width_Uriage"><span m:value="#{ui.uriage}" m:converter="#{bizreportNumericCnvt}" /></td>
						  <td m:rendered="#{isTotal}" class="body_num width_Uriage"><span m:value="#{ui.uriageZen}" m:converter="#{bizreportNumericCnvt}" /></td>
						  <td m:rendered="#{isTotal}" class="body_num width_Hiritu hiritu #{( (campNipoRefViewDto.zennenDataShubetu != 'DOGETUHOSEI'? ui.uriageZennenHi:ui.netUriageZennenHi) >= 100? '':'body_hiritu')}">
						  	<span m:value="#{(campNipoRefViewDto.zennenDataShubetu != 'DOGETUHOSEI'? ui.uriageZennenHi:ui.netUriageZennenHi)}"/></td>
						  <td class="#{(isDay? 'cenArea':'body_num')} width_Tenko"><span m:value="#{(isDay? ui.tenkoKbnZenKigou:ui.eigyoDaysZen)}"/></td>
						  <td class="body_num width_Rank_Sibu"><span m:converter="#{characterEncodingConverter}" m:rendered="#{ui.rankInSibu != null}" m:value="#{ui.rankInSibu}#{'('}#{ui.sibuTenpoCnt}#{')'}"/></td>
						  <td class="body_num width_Rank"><span m:rendered="#{ui.rankInAll != null}">
						  		<span m:value="#{ui.rankInAll}" m:converter="#{commonCampaignNumConverter}"/>(<span m:value="#{ui.allTenpoCnt}" m:converter="#{commonCampaignNumConverter}"/>)</span></td>
					</tr>
				</span>
				</table>
			</div>
			</div>
		</div>
	</span>
</div>
		<input type="text" m:id="dummyEnter" style="display:none"/>
</form>

</span>
</span>
</body>
</html>
