<html xmlns:m="http://www.seasar.org/maya" m:action="#{gyotaibetuNipoRefConditionAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<title>屋号別売上日報</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="屋号別売上日報"/>
<span m:inject="s:insert" m:name="bodyTitleName">■屋号別売上日報</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBR005V01"/>
<span m:inject = "f:param" m:name = "msg" m:value="結果が表示されるまでに時間がかかります。よろしいですか？"/>
<div m:inject="s:insert" m:name="body">

<script type="text/javascript">
<!--
// 初期設定
function bodyLoad() {
}
// 店舗種別プルダウン変更処理
function switchDisplayObj() {
	var taishoTenpo = document.nipoRefCondition.elements['nipoRefCondition:compTaishoTenpo'].selectedIndex;
	document.getElementById('nipoRefCondition:div_tenpoShuTitle').style.display="none";
	document.getElementById('nipoRefCondition:div_tenpoShu').style.display="none";

	if(taishoTenpo == 1) {
		document.getElementById('nipoRefCondition:div_tenpoShu').style.display="inline";
	}else {
		document.getElementById('nipoRefCondition:div_tenpoShuTitle').style.display="inline";
	}
}
// 対象期間プルダウン変更処理
function switchDisplayKikan() {
	document.getElementById('nipoRefCondition:div_kibetsushiteinipo').style.display="none";
	document.getElementById('div_tougetsugepo').style.display="none";
	document.getElementById('nipoRefCondition:div_tsukibetsugepo').style.display="none";
	document.getElementById('nipoRefCondition:div_kibetsukihou').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanshitei').style.display="none";

	var taishoKikan = document.nipoRefCondition.elements['nipoRefCondition:kikanTaisho'].selectedIndex;
	if(taishoKikan == 0) {
		document.getElementById('nipoRefCondition:div_kibetsushiteinipo').style.display="inline";
	}else if(taishoKikan == 1) {
		document.getElementById('div_tougetsugepo').style.display="inline";
	}else if(taishoKikan == 2) {
		document.getElementById('nipoRefCondition:div_tsukibetsugepo').style.display="inline";
	}else if(taishoKikan == 3) {
		document.getElementById('nipoRefCondition:div_kibetsukihou').style.display="inline";
	}else if(taishoKikan == 4) {
		document.getElementById('nipoRefCondition:div_kikanshitei').style.display="inline";
	}
}
// 対象期間プルダウン変更処理(オーナー用)
function switchDisplayKikanOner() {
	document.getElementById('div_kibetsushiteinipo_oner').style.display="none";
	document.getElementById('div_tougetsugepo_oner').style.display="none";
	document.getElementById('div_tsukibetsugepo_oner').style.display="none";
	document.getElementById('div_kikanshitei_oner').style.display="none";

	var kikan = document.nipoRefCondition.elements['nipoRefCondition:kikanTaishoOner'].selectedIndex;
	if( kikan == 0) {
		document.getElementById('div_kibetsushiteinipo_oner').style.display="inline";
	}else if(kikan == 1) {
		document.getElementById('div_tougetsugepo_oner').style.display="inline";
	}else if(kikan == 2) {
		document.getElementById('div_tsukibetsugepo_oner').style.display="inline";
	}else if(kikan == 3) {
		document.getElementById('div_kikanshitei_oner').style.display="inline";
	}
}
/**
 * 実行ボタン押下時処理
 */
function searchHonbu() {
		//ユーザータイプコード
		var typeCd = document.nipoRefCondition.elements['nipoRefCondition:typeCd'].value;
		if(typeCd == '01' ) {

			//店舗種別
			var shubetu = document.nipoRefCondition.elements['nipoRefCondition:compTaishoTenpo'].value;
			//集計区分
			var shukeiKbn = document.nipoRefCondition.elements['nipoRefCondition:shukeiKbnCd'].value;
			//対象店舗
			var tenpo = document.nipoRefCondition.elements['nipoRefCondition:taishoTenpoCd'].value;
			//対象期間
			var kikan = document.nipoRefCondition.elements['nipoRefCondition:kikanTaisho'].value;
			//前年データ種別
			var zdatashubetu = document.nipoRefCondition.elements['nipoRefCondition:zenDataZennenCd'].value;

			/**
			 * 下記の条件になる場合はalertを出す。（ok/cancel）
　　		 * MSG: 結果が表示されるまでに時間がかかります。よろしいですか？
			 * 店舗種別	：前年対象店
			 * 集計区分	：直営・販社を含まない
			 * 対象店舗	：FCのみ
			 * 対象期間	：期間指定
			 *
			 */
			if("1" == shubetu
				&& "SIBU_CD" == shukeiKbn
				&& "FC" == tenpo
				&& "DAYS" == kikan
				&& "HOSEI" == zdatashubetu)
			{

				if(confirm(""+document.nipoRefCondition.elements['nipoRefCondition:jyokenMsg'].value)) {
				} else {
					bodyLoad();
					return;
				}
			}
		}
	execSearch():
}
	/**
	 * 検索処理
	 */
	function execSearch(){

		document.nipoRefCondition.elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:enforcement';
		document.nipoRefCondition.submit();

	}// end of execSearch()

// 集計区分プルダウン変更処理 2008/12/09追加 SV対応
function switchShukeiKbn(elementShukeiKbn) {
	var taishoTenpo = elementShukeiKbn.selectedIndex;

	var commonClassName = "taisho_";
	if(taishoTenpo == 2) {
		dispSwitchElement("th",commonClassName, "tenpo", "none");
		dispSwitchElement("td",commonClassName, "tenpo", "none");
		dispSwitchElement("th",commonClassName, "svCd", "inline");
		dispSwitchElement("td",commonClassName, "svCd", "inline");
	}else {
		dispSwitchElement("th",commonClassName, "svCd", "none");
		dispSwitchElement("td",commonClassName, "svCd", "none");
		dispSwitchElement("th",commonClassName, "tenpo", "inline");
		dispSwitchElement("td",commonClassName, "tenpo", "inline");
	}
}

// SV検索 2008/12/09追加 SV対応
function doCallSVForm() {
    document.nipoRefCondition.target = "_self";
	document.forms['nipoRefCondition'].elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:callSvForm';
	document.forms['nipoRefCondition'].submit();
}


/**
 * 対象クラスエレメント表示切り替え処理
 */
function dispSwitchElement(targetTag, commonClassName, targetCode, status) {
	var objsDiv = document.nipoRefCondition.getElementsByTagName(targetTag);
	for (i = 0; i < objsDiv.length; i++) {
		var classNm = objsDiv[i].className;
		if(classNm.indexOf(commonClassName)>=0){
			if(classNm.indexOf(targetCode)>=0) {
				objsDiv[i].style.display = status;
			}
		}
	}
}

-->
</script>
<!-- 条件部(本部用) -->
<form m:id="nipoRefCondition" onKeyDown="return setDefaultSubmitButton('nipoRefCondition','btnExecute');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="windowId" m:value="#{nipoRefSearchParameterDto.windowId}"/>
<input type="hidden" m:id="typeCd" m:value="#{birdUserInfo.mstUser.userTypeCd}"/>
<input type="hidden" id="jyokenMsg" m:value="#{msg}"/>
<a id="enforcement" m:action="#{gyotaibetuNipoRefConditionAction.enforcement}"/>
<a id="callSvForm" m:action="#{gyotaibetuNipoRefConditionAction.callSvForm}"/>
	<table cellspacing="0" cellpadding="0" m:rendered="#{gyotaibetuNipoRefDto.birdUserInfo.mstUser.userTypeCd == '01'}">
		<tr>
		<td>
			<table class="body_table">
			<tr>
				<th nowrap=" nowrap">会社</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:value="#{nipoRefSearchParameterDto.companyCd}"
								m:items="#{nipoRefConditionDto.companyList}"
								m:itemValue="companyCd"
								m:itemLabel="companyName"/></div>
				</td>
				<th nowrap=" nowrap">店舗種別</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:value="#{nipoRefSearchParameterDto.tenpoShubetuCd}"
								m:items="#{nipoRefConditionDto.tenpoShubetuList}"
								m:id="compTaishoTenpo"
								m:itemValue="code"
								m:itemLabel="name"
								m:onchange="switchDisplayObj();"/></div>
				</td>
				<th nowrap=" nowrap">集計区分</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:id="shukeiKbnCd"
								m:value="#{nipoRefSearchParameterDto.shukeiKbnCd}"
								m:items="#{nipoRefConditionDto.shukeiKbnList}"
								m:itemValue="code"
			                    m:itemLabel="value"
			                    m:onchange="switchShukeiKbn(this);"/></div>
				</td>
				<th class="taisho_tenpo" style="#{'SV_CD'!=gyotaibetuNipoRefDto.shukeiKbnCd ? '' : 'display:none;'}" nowrap=" nowrap">対象店舗</th>
				<td class="taisho_tenpo" style="#{'SV_CD'!=gyotaibetuNipoRefDto.shukeiKbnCd ? '' : 'display:none;'}">
					<div class="hideArea">
						<select m:id="taishoTenpoCd"
								m:value="#{nipoRefSearchParameterDto.taishoTenpoCd}"
								m:items="#{nipoRefConditionDto.taishoTenpoList}"/></div>
				</td>
				<th class="taisho_svCd" style="#{'SV_CD'==gyotaibetuNipoRefDto.shukeiKbnCd ? '' : 'display:none;'}" nowrap=" nowrap">SVコード
				<input type="button" m:id="doSearchSVBtn" value="検索"
				       onclick="doCallSVForm();" ondblclick="return false;"
				       class="button_in_table height_21"/>
				</th>
				<td class="taisho_svCd" style="#{'SV_CD'==gyotaibetuNipoRefDto.shukeiKbnCd ? '' : 'display:none;'}">
					<input type="text" class="imenotuse height_11"
					       m:id="textGyotaiCondSV" m:value="#{nipoRefSearchParameterDto.svCd}"
					       maxlength="8" size="15" />
				</td>
				<td>
				</td>
			</tr>
			<tr>
				<th nowrap=" nowrap">対象期間</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.taishoKikanCd}"
								m:items="#{nipoRefConditionDto.taishoKikanList}"
								m:id="kikanTaisho"
								m:itemValue="code"
								m:itemLabel="name"
								m:onchange="switchDisplayKikan();"/></div>
				</td>
				<th nowrap=" nowrap">期間指定</th>
				<td colspan="3">
					<div class="hideArea">
						<div id="div_kibetsushiteinipo" class="div_kibetsushiteinipo" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='DAY1') == true  ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanNipo}"
									m:items="#{nipoRefConditionDto.kikanFromList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_tougetsugepo" class="div_tougetsugepo" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='APPMONTH') == true ? '' : 'display:none;'}">
							<input type="hidden" m:id="tougetsugepo" m:value="#{nipoRefSearchParameterDto.kikanCurrMonth}"/></div>
						<div id="div_tsukibetsugepo" class="div_tsukibetsugepo" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='MONTH') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanYM}"
									m:items="#{nipoRefConditionDto.kikanYMList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_kibetsukihou" class="div_kibetsukihou" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='KIBETU') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanYear}"
										m:items="#{nipoRefConditionDto.kikanYearList}"
										m:itemValue="code"
										m:itemLabel="name"/>
							年度<select m:value="#{nipoRefSearchParameterDto.kikanKibetu}"
										m:items="#{nipoRefConditionDto.kikanKibetuList}"
										m:itemValue="code"
										m:itemLabel="name"/></div>
						<div id="div_kikanshitei" class="div_kikanshitei" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='DAYS') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanFrom}"
										m:items="#{nipoRefConditionDto.kikanFromList}"
										m:itemValue="code"
										m:itemLabel="name"/>
							〜<select m:value="#{nipoRefSearchParameterDto.kikanTo}"
										m:items="#{nipoRefConditionDto.kikanToList}"
										m:itemValue="code"
										m:itemLabel="name"/></div></div>
				</td>
				<th nowrap=" nowrap">前年データ種別</th>
				<td>
					<div class="hideArea">
						<div id="div_tenpoShuTitle" class="div_tenpoShuTitle" style="#{(gyotaibetuNipoRefDto.tenpoShubetuCd != '1') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.zenDataZennenOthCd}"
									m:items="#{nipoRefConditionDto.zenDataZennenOthList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_tenpoShu" class="div_tenpoShu" style="#{(gyotaibetuNipoRefDto.tenpoShubetuCd == '1') == true ? '' : 'display:none;'}">
							<select m:id="zenDataZennenCd"
							        m:value="#{nipoRefSearchParameterDto.zenDataZennenCd}"
									m:items="#{nipoRefConditionDto.zenDataZennenList}"
									m:itemValue="code"
									m:itemLabel="name"/></div></div>
				</td>
			</tr>
			</table>
		</td>
		<td align="center" valign="bottom">
			<input type="button" m:id="btnExecute" value="実行"
			       onClick="searchHonbu(); return false;" onDblClick="return false;" style="margin:2px;"/>
		</td>
	</tr>
	</table>

<input type="text" m:id="dummyText" m:style="display:none;"/>
</form>
<!-- 条件部(オーナー用) -->
<form m:id="nipoRefOnerCondition" onKeyDown="return setDefaultSubmitButton('nipoRefOnerCondition','btnExecute');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="windowId" m:value="#{nipoRefSearchParameterDto.windowId}"/>
<input type="hidden" m:id="typeCd" m:value="#{birdUserInfo.mstUser.userTypeCd}"/>
<a id="enforcement" m:action="#{gyotaibetuNipoRefConditionAction.enforcement}"/>
	<table cellspacing="0" cellpadding="0" m:rendered="#{gyotaibetuNipoRefDto.birdUserInfo.mstUser.userTypeCd == '02'}">
		<tr>
		<td>
			<table class="body_table">
			<tr>
				<th nowrap=" nowrap">会社</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.companyCd}"
								m:items="#{nipoRefConditionDto.companyList}"
								m:itemValue="code"
								m:itemLabel="name"/></div>
				</td>
				<th width="120px">前年データ種別</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.zenDataZennenOthCd}"
								m:items="#{nipoRefConditionDto.zenDataZennenOthList}"
								m:itemValue="code"
								m:itemLabel="name"/></div>
				</td>
				<th nowrap=" nowrap">対象期間</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.taishoKikanCd}"
								m:items="#{nipoRefConditionDto.taishoKikanList}"
								m:itemValue="code"
								m:itemLabel="name"
								m:id="kikanTaishoOner"
								m:onchange="switchDisplayKikanOner();"/></div>
				</td>
				<th nowrap=" nowrap">期間指定</th>
				<td width="240px" colspan="3">
					<div class="hideArea">
						<div id="div_kibetsushiteinipo_oner" class="div_kibetsushiteinipo_oner" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='DAY1') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanNipo}"
									m:items="#{nipoRefConditionDto.kikanFromList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_tougetsugepo_oner" class="div_tougetsugepo_oner" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='APPMONTH') == true ? '' : 'display:none;'}">
							<input type="hidden" m:id="tougetsugepo_oner" m:value="#{nipoRefSearchParameterDto.kikanCurrMonth}"/></div>
						<div id="div_tsukibetsugepo_oner" class="div_tsukibetsugepo_oner" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='MONTH') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanYM}"
									m:items="#{nipoRefConditionDto.kikanYMList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_kikanshitei_oner" class="div_kikanshitei_oner" style="#{(gyotaibetuNipoRefDto.taishoKikanCd=='DAYS') == true ? '' : 'display:none;'}">
							<table style="border-width:0px;padding:0px;border-collapse:collapse;">
								<tr><td style="border-width:0px;padding:0px;">
							<select m:value="#{nipoRefSearchParameterDto.kikanFrom}"
										m:items="#{nipoRefConditionDto.kikanFromList}"
										m:itemValue="code"
										m:itemLabel="name"/></td>
							<td style="border-width:0px;padding:0px;">〜</td>
							<td style="border-width:0px;padding:0px;"><select m:value="#{nipoRefSearchParameterDto.kikanTo}"
										m:items="#{nipoRefConditionDto.kikanToList}"
										m:itemValue="code"
										m:itemLabel="name"/></td>
							</tr></table></div></div>
				</td>
			</tr>
			</table>
		</td>
		<td align="center" valign="bottom">
			<input type="button" m:id="btnExecute"  value="実行"
			       onClick="execSearch(); return false;" onDblClick="return false;" style="margin:2px;"/>
		</td>
	</tr>
	</table>

<input type="text" m:id="dummyText" m:style="display:none;"/>
</form>
</div>
</body>
</html>
