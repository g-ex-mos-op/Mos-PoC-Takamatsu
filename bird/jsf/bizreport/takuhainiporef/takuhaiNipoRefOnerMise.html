<html xmlns:m="http://www.seasar.org/maya" m:action="#{takuhaiNipoRefOnerMiseAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<title>宅配売上日報</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="宅配売上日報"/>
<span m:inject="s:insert" m:name="bodyTitleName">■宅配売上日報</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBR003V04"/>
<div m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
.data_table_width {
    width:98%;
}
.width_shubetu {
    width:92px;
}
.width_nisu {
    width:40px;
}
.width_hiritu {
    width:65px;
}
.width_uriage {
    width:130px;
}
.width_kensu {
    width:75px;
}

-->
</style>

<script type="text/javascript">
<!--
// 初期設定
function bodyLoad() {
	loadScroll("nipoRefScroll"+document.nipoRefCondition.elements['nipoRefCondition:subTagKbn'].value, 332);
}

//タブ切り替え処理
function changeNipoTab(subTagKbn) {
	changeTabArea(subTagKbn);
	document.nipoRefCondition.elements['nipoRefCondition:subTagKbn'].value = subTagKbn;
	bodyLoad();
}
// 対象期間プルダウン変更処理
function switchDisplayKikanOner() {
	document.getElementById('nipoRefCondition:div_kikanNipo').style.display="none";
	document.getElementById('div_kikanCurrMonth').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanYM').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanSitei').style.display="none";

	var taishoKikan = document.nipoRefCondition.elements['nipoRefCondition:kikanTaishoOner'].selectedIndex;
	if(taishoKikan == 0) {
		document.getElementById('nipoRefCondition:div_kikanNipo').style.display="inline";
	}else if(taishoKikan == 1) {
		document.getElementById('div_kikanCurrMonth').style.display="inline";
	}else if(taishoKikan == 2) {
		document.getElementById('nipoRefCondition:div_kikanYM').style.display="inline";
	}else if(taishoKikan == 3) {
		document.getElementById('nipoRefCondition:div_kikanSitei').style.display="inline";
	}
}
// サブミット処理
function execSubmit() {
	if (document.nipoRefCondition.elements['nipoRefCondition:newwin'] == null) {
		document.nipoRefCondition.target = "_self";
		return;
	}
	// 別ウィンドウフラグ
	var flg = document.nipoRefCondition.elements['nipoRefCondition:newwin'].checked;
  	var flg2= document.nipoRefCondition.elements['nipoRefCondition:newWindowFlg'].value;
	if (flg && flg2 == '1') {
		document.nipoRefCondition.elements['nipoRefCondition:newWindowFlg'].value = "";
		document.nipoRefCondition.target = "_blank";
	}
}
// 店リンク押下処理
function setLinkInfo(miseCd) {
	document.nipoRefCondition.elements['nipoRefCondition:miseCd'].value = miseCd;
	document.nipoRefCondition.elements['nipoRefCondition:isUseCommonDto'].value = '1';
	document.nipoRefCondition.target = "_blank";
	document.forms['nipoRefCondition'].elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:selectMiseLink';
	document.forms['nipoRefCondition'].submit();
	return;
}
// ダウンロード
function downloadCsv() {
	document.nipoRefCondition.target = "_self";
	document.forms['nipoRefCondition'].elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:downloadCsv';
	document.forms['nipoRefCondition'].submit();
	return;
}
/**
 * 別ウィンドウ処理
 */
function initWindow() {
	//別ウィンドウのチェック
	var isChecked = false;
	if(document.nipoRefCondition.elements['nipoRefCondition:newwin'] != null){
	    isChecked = document.nipoRefCondition.elements['nipoRefCondition:newwin'].checked;
		document.nipoRefCondition.elements['nipoRefCondition:newWindowFlg'].value=isChecked;
		if(isChecked) {
			document.nipoRefCondition.target = "_blank";
			return;
		}
	}
	document.nipoRefCondition.target = "_self";
}
/**
 * 画面タブ起動処理
 */
function callScreenTab(targetTab){
	//別ウィンドウのチェック
	initWindow();
	document.nipoRefCondition.elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:'+targetTab;
	document.forms['nipoRefCondition'].submit();
}
function search() {
	initWindow();
	document.forms['nipoRefCondition'].elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:reSearch';
	document.forms['nipoRefCondition'].submit();
	return;
}

-->
</script>
<form m:id="nipoRefCondition" target="_self" onsubmit="execSubmit();">
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" m:id="windowId" m:value="#{nipoRefSearchParameterDto.windowId}"/>
	<input type="hidden" m:id="newWindowFlg" value="#{takuhaiNipoRefOnerMiseAction.newWindowFlg}"/>
	<input type="hidden" m:value="#{nipoRefSearchParameterDto.researchFlg}"/>
	<input type="hidden" m:id="miseCd" m:value="#{takuhaiNipoRefOnerMiseAction.miseCd}"/>
	<input type="hidden" m:id="isUseCommonDto" m:value="1"/>
	<a m:id="eigyonipo" m:action="#{takuhaiNipoRefOnerMiseAction.goEigyoNipo}"/>
	<a m:id="yago" m:action="#{takuhaiNipoRefOnerMiseAction.goYago}"/>
	<a m:id="moscard" m:action="#{takuhaiNipoRefOnerMiseAction.callMoscard}"/>
	<a m:id="netorder" m:action="#{takuhaiNipoRefOnerMiseAction.callNetorder}"/>
	<a m:id="selectMiseLink" m:action="#{takuhaiNipoRefOnerMiseAction.selectedMise}"/>
	<a m:id="downloadCsv" m:action="#{takuhaiNipoRefOnerMiseAction.downloadCsvOner}"/>
	<a m:id="reSearch" m:action="#{takuhaiNipoRefOnerMiseAction.reSearch}"/>
	<table class="hiddenBody element_browser" style="margin-bottom:4px;">
		<tr>
		<td>
		<!-- 条件部 -->
		<table class="body_table">
		<tr>
			<th nowrap=" nowrap">会社</th>
			<td>
				<div class="hideArea">
					<select class="condition_field"
					    m:id="companyCd"
						m:value="#{nipoRefSearchParameterDto.companyCd}"
						m:items="#{nipoRefConditionDto.companyList}"
					m:itemValue="companyCd"
					m:itemLabel="companyName"/></div>
			</td>
			<th nowrap=" nowrap">前年データ種別</th>
			<td>
				<div class="hideArea">
					<select m:value="#{nipoRefSearchParameterDto.zenDataZennenOthCd}"
					    m:id="zenDataOnerCd"
						m:items="#{nipoRefConditionDto.zenDataZennenOthList}"
						m:itemValue="code"
						m:itemLabel="name"/></div>
			</td>
			<th nowrap=" nowrap">対象期間</th>
			<td>
				<div class="hideArea">
					<select m:value="#{nipoRefSearchParameterDto.taishoKikanCd}"
						m:items="#{nipoRefConditionDto.taishoKikanList}"
						m:itemValue="code"
						m:itemLabel="name"
						m:id="kikanTaishoOner"
						m:onchange="switchDisplayKikanOner();"/></div>
			</td>
			<th nowrap=" nowrap">期間指定</th>
			<td>
				<div class="hideArea">
					<div id="div_kikanNipo" class="div_kikanNipo"
					 style="#{(nipoRefSearchParameterDto.taishoKikan1Day) == true  ? '' : 'display:none;'}">
						<select m:value="#{nipoRefSearchParameterDto.kikanNipo}"
								m:items="#{nipoRefConditionDto.kikanFromList}"
								m:id="kikanNipo"
								m:itemValue="code"
								m:itemLabel="name"/></div>
					<div id="div_kikanCurrMonth" class="div_kikanCurrMonth" style="display:none;" ></div>
					<div id="div_kikanYM" class="div_kikanYM" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='MONTH') == true ? '' : 'display:none;'}">
						<select m:value="#{nipoRefSearchParameterDto.kikanYM}"
								m:items="#{nipoRefConditionDto.kikanYMList}"
								m:id="kikanYM"
								m:itemValue="code"
								m:itemLabel="name"/></div>
					<div id="div_kikanSitei" class="div_kikanSitei" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='DAYS') == true  ? '' : 'display:none;'}">
						<table style="border-width:0px;padding:0px;border-collapse:collapse;">
								<tr><td style="border-width:0px;padding:0px;">
							<select m:value="#{nipoRefSearchParameterDto.kikanFrom}"
									m:items="#{nipoRefConditionDto.kikanFromList}"
									m:id="kikanFrom"
									m:itemValue="code"
									m:itemLabel="name"/></td>
						<td style="border-width:0px;padding:0px;">〜</td>
						<td style="border-width:0px;padding:0px;"><select m:value="#{nipoRefSearchParameterDto.kikanTo}"
									m:items="#{nipoRefConditionDto.kikanToList}"
									m:id="kikanTo"
									m:itemValue="code"
									m:itemLabel="name"/></td>
						</tr></table></div></div>
			</td>
		</tr>
		</table>
		</td>
		<td valign="bottom">
			<input type="button"
				m:value="#{nipoRefSearchParameterDto.researchFlg=='true'?'再検索':'実行'}" style="margin:2px;"
				onclick="search();" onDblClick="return false;"/>
		</td>
	</tr>
	</table>
 	<input type="hidden" m:value="#{nipoRefResultParameterDto.windowId}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.companyCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.companyName}"/>
 	<input type="hidden" m:value="#{nipoRefResultParameterDto.tenpoShubetuCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.shukeiKbnCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.taishoTenpoCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.taishoKikanCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.zenDataZennenCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.zenDataZennenOthCd}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanNipo}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanCurrMonth}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanYM}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanYear}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanKibetu}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanFrom}"/>
	<input type="hidden" m:value="#{nipoRefResultParameterDto.kikanTo}"/>
	<input type="hidden" m:id="subTagKbn" m:value="#{nipoRefResultParameterDto.subTagKbn}"/>
	<!-- 結果情報 -->
	<input type="hidden" m:value="#{takuhaiNipoRefResultDto.existDataFlg}"/>
	<input type="hidden" m:value="#{takuhaiNipoRefResultDto.kansanFlg}"/>
	<!-- 対象店舗数、ダウンロード、別ウィンドウ -->
	<div class="scroll_padding_head">
	<div m:rendered="#{takuhaiNipoRefResultDto.existDataFlg==true}"
	     class="scroll_hidden" style="margin-bottom:4px;">
	<!-- 印刷用(検索結果条件部) -->
	<table class="element_print">
		<tr>
			<td>会社：<select m:passthrough="true"><option m:passthrough="true"><span m:converter="#{characterEncodingConverter}" m:value="#{nipoRefResultParameterDto.companyName}"/></option></select></td>
			<td>前年データ種別：<select m:passthrough="true"><option m:passthrough="true"><span m:converter="#{characterEncodingConverter}" m:value="#{nipoRefResultParameterDto.zennenDataShubetuName}"/></option></select></td>
			<td>対象期間：<select m:passthrough="true"><option m:passthrough="true"><span m:converter="#{characterEncodingConverter}" m:value="#{nipoRefResultParameterDto.labelTaishoKikan}"/></option></select></td>
			<td>期間指定：<span m:rendered="#{nipoRefResultParameterDto.existKikanSiteiFrom}">
						<select m:passthrough="true"><option m:passthrough="true"><span m:converter="#{characterEncodingConverter}" m:value="#{nipoRefResultParameterDto.labelKikanSiteiFrom}"/></option></select>
						<span m:rendered="#{nipoRefResultParameterDto.taishoKikanCd=='KIBETU'}">年度</span>
						<span m:rendered="#{nipoRefResultParameterDto.taishoKikanCd=='DAYS'}">〜</span></span>
					  <span m:rendered="#{nipoRefResultParameterDto.existKikanSiteiTo}">
					  	<select m:passthrough="true"><option m:passthrough="true"><span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{nipoRefResultParameterDto.labelKikanSiteiTo}" escape="false"/></option></select></span></td>
		</tr>
	</table>
	<div style="width:98%;">
		<table class="body_table2" style="float:left;">
			<tr><th>宅配対象店舗数</th>
			    <td width="110px"
			        class="body_num"><span m:value="#{takuhaiNipoRefResultDto.tenpoCount}"
				                               m:converter="#{numericConverter}"/></td></tr>
		</table>
		<table class="hiddenBody element_browser" style="float:right;">
			<tr><td><input type="button" onclick="downloadCsv();" style="margin-right:5px;"
			                value="ダウンロード"/></td>
			    <td><input type="checkbox" m:id="newwin"
			               checked="#{takuhaiNipoRefOnerMiseAction.newWindowFlg}"/>別ウィンドウに表示</td>
			</tr>
		</table>
	</div>
	</div>
	</div>
	<div style="clear:both;"/>
	<!-- サブタグ -->
	<div class="scroll_padding_head">
	<div class="scroll_hidden element_browser">
	<table cellspacing="0" cellpadding="0">
		<tr>
			<td width="150px" class="body_non_active_tab">
				<a href="javascript:void(0);"
				    onClick="callScreenTab('eigyonipo');return false;" onDblClick="return false;">
					営業日報</a></td>
			<td width="150px" class="body_active_tab">宅配売上</td>
			<td width="150px" class="body_non_active_tab">
				<a href="javascript:void(0);"
				    onClick="callScreenTab('yago');return false;" onDblClick="return false;">
					屋号別売上</a></td>
			<td width="150px" class="body_non_active_tab" m:rendered="#{nipoRefConditionDto.accessMoscard && nipoRefResultParameterDto.mosCompany}">
				<a href="javascript:void(0);"
				    onClick="callScreenTab('moscard');return false;" onDblClick="return false;">
					MOS CARD</a>
			</td>
			<td  m:rendered="#{nipoRefConditionDto.accessNetorder && nipoRefResultParameterDto.mosCompany}" width="150px" class="body_non_active_tab element_browser">
					<a href="javascript:void(0);"
				    onClick="callScreenTab('netorder');return false;" onDblClick="return false;">
					ネット注文</a>
			</td>
		</tr>
	</table>
	</div>
	</div>
	<!-- 一覧サブタグ -->
	<div m:rendered="#{takuhaiNipoRefResultDto.existDataFlg}">
	<div class="scroll_padding_head">
		<div class="scroll_hidden element_browser margin_bottom_hidden">
		<table cellspacing="0" cellpadding="0" class="data_table_width tab_area">
		<tr style="height:5px;"><td></td></tr>
		<tr><td>
			<table cellspacing="0" cellpadding="0">
				<tr>
					<td class="body_#{nipoRefResultParameterDto.subTagKbn=='0'?'':'non_'}active_cell tab_change_area_0" width="125px">
						<a href="javascript:changeNipoTab('0');" m:passthrough="true">売上</a></td>
					<td class="body_#{nipoRefResultParameterDto.subTagKbn=='1'?'':'non_'}active_cell  tab_change_area_1" width="125px">
						<a href="javascript:changeNipoTab('1');" m:passthrough="true">件数</a></td>
				</tr>
			</table>
		</td></tr>
		<tr style="height:5px" class="body_caption"><td/></tr>
		</table>
		</div>
		</div>
		<!--売上サブタブ-->
		<div class="#{nipoRefResultParameterDto.subTagKbn=='0'?'':'in'}visible_tab tab_change_area_0">
			<span class="element_print">【売上】</span>
			<div class="scroll_padding_head">
			<div class="scroll_hidden margin_bottom_hidden">
			<table class="body_table2 data_table_width">
				<tr class="header_row">
					<th width="*">店舗名</th>
					<th class="width_shubetu">種別</th>
					<th class="width_nisu">宅配<BR/>日数</th>
					<th class="width_uriage">売上</th>
					<th width="8%">前年比<BR/>(売上)</th>
					<th class="width_uriage">宅配売上</th>
					<th width="80px">前年比<br/><font style="font-size:11pt;">(宅配売上)</font></th>
					<th width="8%">構成比<BR/>(売上)</th>
					<th width="9%">宅配平均<BR/>売上</th>
				</tr>
			</table>
			</div>
			</div>
			<div class="scroll_padding_data_no">
			<div id="nipoRefScroll0" class="scroll_complete">
				<table class="body_table2 data_table_width" style="border-top-width:0px">
					<div m:inject="s:forEach" m:items="#{takuhaiNipoRefResultDto.miseRstList}" m:var="e" m:varindex="i">
					<tr m:class="#{e.rClass} non_top_border">
						<td width="*" style="font-weight:bold;"><!-- 店舗名 -->
							<span m:converter="#{characterEncodingConverter}" m:value="#{e.dispMiseName}"/></td>
						<!-- 種別 -->
						<td class="width_shubetu"><span m:converter="#{characterEncodingConverter}" m:value="#{e.takuDetailName}"/></td>
						<!-- 宅配日数 -->
						<td class="width_nisu body_num"><span m:value="#{e.eigyoDaystaku}" m:converter="#{numericConverter}"/></td>
						<!-- 売上 -->
						<td class="width_uriage body_num"><span m:value="#{e.uriage}" m:converter="#{bizreportNumericCnvt}"/></td>
						<!-- 前年比(売上) -->
						<td width="8%" m:class="#{e.zenHiUriTdClass}"><span m:value="#{e.zenHiUriage}" m:converter="#{numericConverterDec}"/></td>
						<!-- 宅配売上 -->
						<td class="width_uriage body_num"><span m:value="#{e.uriageTaku}" m:converter="#{numericConverter}"/></td>
						<!-- 前年比(宅配売上) -->
						<td width="80px" m:class="#{e.zenHiUriTakuTdClass}"><span m:value="#{e.zenHiUriageTaku}" m:converter="#{numericConverterDec}"/></td>
						<!-- 構成比 -->
						<td width="8%" m:class="#{e.kouseiHiUriTdClass}"><span m:value="#{e.kouseiHiUri}" m:converter="#{numericConverterDec}"/></td>
						<!-- 宅配平均売上 -->
						<td width="9%" m:class="body_num"><span m:value="#{e.takuHeikinUri}" m:converter="#{numericConverter}"/></td>
					</tr>
					</div>
				</table>
			</div>
			</div>
		</div>
		<!-- 件数サブタグ -->
		<div class="#{nipoRefResultParameterDto.subTagKbn=='1'?'':'in'}visible_tab tab_change_area_1">
			<span class="element_print">【件数】</span>
			<div class="scroll_padding_head">
			<div class="scroll_hidden margin_bottom_hidden">
			<table class="body_table2 data_table_width">
				<tr class="header_row">
					<th width="*">店舗名</th>
					<th class="width_shubetu">種別</th>
					<th class="width_nisu">宅配<BR/>日数</th>
					<th width="79px">客数</th>
					<th width="7%">前年比<BR/>(客数)</th>
					<th class="width_kensu">宅配件数</th>
					<th width="80px">前年比<br/><font style="font-size:11pt;">(宅配件数)</font></th>
					<th width="55px">構成比<br/><font style="font-size:11pt;">(件数)</font></th>
					<th class="width_kensu">宅配平均<BR/>件数</th>
					<th class="width_kensu">客単価</th>
					<th class="width_hiritu">前年比<BR/><font style="font-size:11pt;">(客単価)</font></th>
				</tr>
			</table>
			</div>
			</div>
			<div class="scroll_padding_data_no">
			<div id="nipoRefScroll1" class="scroll_complete">
				<table class="body_table2 data_table_width" style="border-top-width:0px">
					<div m:inject="s:forEach" m:items="#{takuhaiNipoRefResultDto.miseRstList}" m:var="e" m:varindex="i">
					<tr m:class="#{e.rClass} non_top_border">
						<!-- 店舗名 -->
						<td width="*" style="font-weight:bold;">
							<span m:converter="#{characterEncodingConverter}" m:value="#{e.dispMiseName}"/></td>
						<!-- 種別 -->
						<td class="width_shubetu"><span m:converter="#{characterEncodingConverter}" m:value="#{e.takuDetailName}"/></td>
						<!-- 宅配日数 -->
						<td class="width_nisu body_num"><span m:value="#{e.eigyoDaystaku}" m:converter="#{numericConverter}"/></td>
						<!-- 客数 -->
						<td width="79px" m:class="body_num"><span m:value="#{e.kyakusu}" m:converter="#{numericConverter}"/></td>
						<!-- 前年比(客数) -->
						<td width="7%" m:class="#{e.zenHiKyaTdClass}"><span m:value="#{e.zenHiKyakusu}" m:converter="#{numericConverterDec}"/></td>
						<!-- 宅配件数 -->
						<td class="width_kensu body_num"><span m:value="#{e.kyakusuTaku}" m:converter="#{numericConverter}"/></td>
						<!-- 前年比(宅配件数) -->
						<td width="80px" m:class="#{e.zenHiKyaTakuTdClass}"><span m:value="#{e.zenHiKyakusuTaku}" m:converter="#{numericConverterDec}"/></td>
						<!-- 構成比 -->
						<td width="55px" m:class="#{e.kouseiHiKyaTdClass}"><span m:value="#{e.kouseiHiKyaku}" m:converter="#{numericConverterDec}"/></td>
						<!-- 宅配平均件数 -->
						<td class="width_kensu body_num"><span m:value="#{e.takuHeikinKyakusu}" m:converter="#{numericConverter}"/></td>
						<!-- 客単価 -->
						<td class="width_kensu body_num"><span m:value="#{e.kyakuTanka}" m:converter="#{numericConverter}"/></td>
						<!-- 前年比<BR/>(客単価) -->
						<td class="width_hiritu #{e.zenKyakuTankaTdClass}"><span m:value="#{e.zenHiKyakuTanka}" m:converter="#{numericConverterDec}"/></td>
					</tr>
					</div>
				</table>
			</div>
			</div>
		</div>
	</div>
	<input type="text" m:id="dummyText" m:style="display:none;"/>
</form>
</div>
</body>
</html>
