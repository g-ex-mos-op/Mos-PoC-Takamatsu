SELECT MAX(BD30.COMPANY_CD) AS COMPANY_CD
,    MAX(BD30.MISE_CD)      AS MISE_CD
,    BD30.EIGYO_DT
,    MAX(UP_FLG)       AS UP_FLG
,    MAX(UP_DT)        AS UP_DT
,    MAX(BATUP_DT)     AS BATUP_DT
,    MAX(UP_NO)        AS UP_NO
,    SUM(CASE WHEN BD31.U001_KAIKEI_KEN_2  IS NULL THEN BD30.KAIKEI_KEN_2  ELSE BD31.U001_KAIKEI_KEN_2  END) AS U001_KAIKEI_KEN_2 
,    SUM(CASE WHEN BD31.U002_KAIKEI_KIN_2  IS NULL THEN BD30.KAIKEI_KIN_2  ELSE BD31.U002_KAIKEI_KIN_2  END) AS U002_KAIKEI_KIN_2 
,    SUM(CASE WHEN BD31.U003_KAIKEI_KEN_3  IS NULL THEN BD30.KAIKEI_KEN_3  ELSE BD31.U003_KAIKEI_KEN_3  END) AS U003_KAIKEI_KEN_3 
,    SUM(CASE WHEN BD31.U004_KAIKEI_KIN_3  IS NULL THEN BD30.KAIKEI_KIN_3  ELSE BD31.U004_KAIKEI_KIN_3  END) AS U004_KAIKEI_KIN_3 
,    SUM(CASE WHEN BD31.U005_KAIKEI_KEN_4  IS NULL THEN BD30.KAIKEI_KEN_4  ELSE BD31.U005_KAIKEI_KEN_4  END) AS U005_KAIKEI_KEN_4 
,    SUM(CASE WHEN BD31.U006_KAIKEI_KIN_4  IS NULL THEN BD30.KAIKEI_KIN_4  ELSE BD31.U006_KAIKEI_KIN_4  END) AS U006_KAIKEI_KIN_4 
,    SUM(CASE WHEN BD31.U007_KAIKEI_KEN_5  IS NULL THEN BD30.KAIKEI_KEN_5  ELSE BD31.U007_KAIKEI_KEN_5  END) AS U007_KAIKEI_KEN_5 
,    SUM(CASE WHEN BD31.U008_KAIKEI_KIN_5  IS NULL THEN BD30.KAIKEI_KIN_5  ELSE BD31.U008_KAIKEI_KIN_5  END) AS U008_KAIKEI_KIN_5 
,    SUM(CASE WHEN BD31.U009_KAIKEI_KEN_6  IS NULL THEN BD30.KAIKEI_KEN_6  ELSE BD31.U009_KAIKEI_KEN_6  END) AS U009_KAIKEI_KEN_6 
,    SUM(CASE WHEN BD31.U010_KAIKEI_KIN_6  IS NULL THEN BD30.KAIKEI_KIN_6  ELSE BD31.U010_KAIKEI_KIN_6  END) AS U010_KAIKEI_KIN_6 
,    SUM(CASE WHEN BD31.U011_KAIKEI_KEN_7  IS NULL THEN BD30.KAIKEI_KEN_7  ELSE BD31.U011_KAIKEI_KEN_7  END) AS U011_KAIKEI_KEN_7 
,    SUM(CASE WHEN BD31.U012_KAIKEI_KIN_7  IS NULL THEN BD30.KAIKEI_KIN_7  ELSE BD31.U012_KAIKEI_KIN_7  END) AS U012_KAIKEI_KIN_7 
,    SUM(CASE WHEN BD31.U013_KAIKEI_KEN_8  IS NULL THEN BD30.KAIKEI_KEN_8  ELSE BD31.U013_KAIKEI_KEN_8  END) AS U013_KAIKEI_KEN_8 
,    SUM(CASE WHEN BD31.U014_KAIKEI_KIN_8  IS NULL THEN BD30.KAIKEI_KIN_8  ELSE BD31.U014_KAIKEI_KIN_8  END) AS U014_KAIKEI_KIN_8 
,    SUM(CASE WHEN BD31.U015_KAIKEI_KEN_9  IS NULL THEN BD30.KAIKEI_KEN_9  ELSE BD31.U015_KAIKEI_KEN_9  END) AS U015_KAIKEI_KEN_9 
,    SUM(CASE WHEN BD31.U016_KAIKEI_KIN_9  IS NULL THEN BD30.KAIKEI_KIN_9  ELSE BD31.U016_KAIKEI_KIN_9  END) AS U016_KAIKEI_KIN_9 
,    SUM(CASE WHEN BD31.U017_KAIKEI_KEN_10 IS NULL THEN BD30.KAIKEI_KEN_10 ELSE BD31.U017_KAIKEI_KEN_10 END) AS U017_KAIKEI_KEN_10
,    SUM(CASE WHEN BD31.U018_KAIKEI_KIN_10 IS NULL THEN BD30.KAIKEI_KIN_10 ELSE BD31.U018_KAIKEI_KIN_10 END) AS U018_KAIKEI_KIN_10
,    SUM(CASE WHEN BD31.U019_KAIKEI_KEN_11 IS NULL THEN BD30.KAIKEI_KEN_11 ELSE BD31.U019_KAIKEI_KEN_11 END) AS U019_KAIKEI_KEN_11
,    SUM(CASE WHEN BD31.U020_KAIKEI_KIN_11 IS NULL THEN BD30.KAIKEI_KIN_11 ELSE BD31.U020_KAIKEI_KIN_11 END) AS U020_KAIKEI_KIN_11
,    SUM(CASE WHEN BD31.U021_KAIKEI_KEN_12 IS NULL THEN BD30.KAIKEI_KEN_12 ELSE BD31.U021_KAIKEI_KEN_12 END) AS U021_KAIKEI_KEN_12
,    SUM(CASE WHEN BD31.U022_KAIKEI_KIN_12 IS NULL THEN BD30.KAIKEI_KIN_12 ELSE BD31.U022_KAIKEI_KIN_12 END) AS U022_KAIKEI_KIN_12
,    SUM(CASE WHEN BD31.U023_KAIKEI_KEN_13 IS NULL THEN BD30.KAIKEI_KEN_13 ELSE BD31.U023_KAIKEI_KEN_13 END) AS U023_KAIKEI_KEN_13
,    SUM(CASE WHEN BD31.U024_KAIKEI_KIN_13 IS NULL THEN BD30.KAIKEI_KIN_13 ELSE BD31.U024_KAIKEI_KIN_13 END) AS U024_KAIKEI_KIN_13
,    SUM(CASE WHEN BD31.U025_KAIKEI_KEN_14 IS NULL THEN BD30.KAIKEI_KEN_14 ELSE BD31.U025_KAIKEI_KEN_14 END) AS U025_KAIKEI_KEN_14
,    SUM(CASE WHEN BD31.U026_KAIKEI_KIN_14 IS NULL THEN BD30.KAIKEI_KIN_14 ELSE BD31.U026_KAIKEI_KIN_14 END) AS U026_KAIKEI_KIN_14
,    SUM(CASE WHEN BD31.U027_KAIKEI_KEN_15 IS NULL THEN BD30.KAIKEI_KEN_15 ELSE BD31.U027_KAIKEI_KEN_15 END) AS U027_KAIKEI_KEN_15
,    SUM(CASE WHEN BD31.U028_KAIKEI_KIN_15 IS NULL THEN BD30.KAIKEI_KIN_15 ELSE BD31.U028_KAIKEI_KIN_15 END) AS U028_KAIKEI_KIN_15
,    SUM(CASE WHEN BD31.U029_KAIKEI_KEN_16 IS NULL THEN BD30.KAIKEI_KEN_16 ELSE BD31.U029_KAIKEI_KEN_16 END) AS U029_KAIKEI_KEN_16
,    SUM(CASE WHEN BD31.U030_KAIKEI_KIN_16 IS NULL THEN BD30.KAIKEI_KIN_16 ELSE BD31.U030_KAIKEI_KIN_16 END) AS U030_KAIKEI_KIN_16
,    SUM(CASE WHEN BD31.U031_KAIKEI_KEN_17 IS NULL THEN BD30.KAIKEI_KEN_17 ELSE BD31.U031_KAIKEI_KEN_17 END) AS U031_KAIKEI_KEN_17
,    SUM(CASE WHEN BD31.U032_KAIKEI_KIN_17 IS NULL THEN BD30.KAIKEI_KIN_17 ELSE BD31.U032_KAIKEI_KIN_17 END) AS U032_KAIKEI_KIN_17
,    SUM(CASE WHEN BD31.U033_KAIKEI_KEN_18 IS NULL THEN BD30.KAIKEI_KEN_18 ELSE BD31.U033_KAIKEI_KEN_18 END) AS U033_KAIKEI_KEN_18
,    SUM(CASE WHEN BD31.U034_KAIKEI_KIN_18 IS NULL THEN BD30.KAIKEI_KIN_18 ELSE BD31.U034_KAIKEI_KIN_18 END) AS U034_KAIKEI_KIN_18
,    SUM(CASE WHEN BD31.U035_KAIKEI_KEN_19 IS NULL THEN BD30.KAIKEI_KEN_19 ELSE BD31.U035_KAIKEI_KEN_19 END) AS U035_KAIKEI_KEN_19
,    SUM(CASE WHEN BD31.U036_KAIKEI_KIN_19 IS NULL THEN BD30.KAIKEI_KIN_19 ELSE BD31.U036_KAIKEI_KIN_19 END) AS U036_KAIKEI_KIN_19
,    SUM(CASE WHEN BD31.U037_KAIKEI_KEN_20 IS NULL THEN BD30.KAIKEI_KEN_20 ELSE BD31.U037_KAIKEI_KEN_20 END) AS U037_KAIKEI_KEN_20
,    SUM(CASE WHEN BD31.U038_KAIKEI_KIN_20 IS NULL THEN BD30.KAIKEI_KIN_20 ELSE BD31.U038_KAIKEI_KIN_20 END) AS U038_KAIKEI_KIN_20
,    SUM(CASE WHEN BD31.U039_KAIKEI_KEN_21 IS NULL THEN BD30.KAIKEI_KEN_21 ELSE BD31.U039_KAIKEI_KEN_21 END) AS U039_KAIKEI_KEN_21
,    SUM(CASE WHEN BD31.U040_KAIKEI_KIN_21 IS NULL THEN BD30.KAIKEI_KIN_21 ELSE BD31.U040_KAIKEI_KIN_21 END) AS U040_KAIKEI_KIN_21
,    SUM(CASE WHEN BD31.U041_KAIKEI_KEN_22 IS NULL THEN BD30.KAIKEI_KEN_22 ELSE BD31.U041_KAIKEI_KEN_22 END) AS U041_KAIKEI_KEN_22
,    SUM(CASE WHEN BD31.U042_KAIKEI_KIN_22 IS NULL THEN BD30.KAIKEI_KIN_22 ELSE BD31.U042_KAIKEI_KIN_22 END) AS U042_KAIKEI_KIN_22
,    SUM(CASE WHEN BD31.U043_KAIKEI_KEN_23 IS NULL THEN BD30.KAIKEI_KEN_23 ELSE BD31.U043_KAIKEI_KEN_23 END) AS U043_KAIKEI_KEN_23
,    SUM(CASE WHEN BD31.U044_KAIKEI_KIN_23 IS NULL THEN BD30.KAIKEI_KIN_23 ELSE BD31.U044_KAIKEI_KIN_23 END) AS U044_KAIKEI_KIN_23
,    SUM(CASE WHEN BD31.U045_KAIKEI_KEN_24 IS NULL THEN BD30.KAIKEI_KEN_24 ELSE BD31.U045_KAIKEI_KEN_24 END) AS U045_KAIKEI_KEN_24
,    SUM(CASE WHEN BD31.U046_KAIKEI_KIN_24 IS NULL THEN BD30.KAIKEI_KIN_24 ELSE BD31.U046_KAIKEI_KIN_24 END) AS U046_KAIKEI_KIN_24
,    SUM(CASE WHEN BD31.U047_KAIKEI_KEN_25 IS NULL THEN BD30.KAIKEI_KEN_25 ELSE BD31.U047_KAIKEI_KEN_25 END) AS U047_KAIKEI_KEN_25
,    SUM(CASE WHEN BD31.U048_KAIKEI_KIN_25 IS NULL THEN BD30.KAIKEI_KIN_25 ELSE BD31.U048_KAIKEI_KIN_25 END) AS U048_KAIKEI_KIN_25
,    SUM(CASE WHEN BD31.U049_KAIKEI_KEN_26 IS NULL THEN BD30.KAIKEI_KEN_26 ELSE BD31.U049_KAIKEI_KEN_26 END) AS U049_KAIKEI_KEN_26
,    SUM(CASE WHEN BD31.U050_KAIKEI_KIN_26 IS NULL THEN BD30.KAIKEI_KIN_26 ELSE BD31.U050_KAIKEI_KIN_26 END) AS U050_KAIKEI_KIN_26
,    SUM(CASE WHEN BD31.U051_KAIKEI_KEN_27 IS NULL THEN BD30.KAIKEI_KEN_27 ELSE BD31.U051_KAIKEI_KEN_27 END) AS U051_KAIKEI_KEN_27
,    SUM(CASE WHEN BD31.U052_KAIKEI_KIN_27 IS NULL THEN BD30.KAIKEI_KIN_27 ELSE BD31.U052_KAIKEI_KIN_27 END) AS U052_KAIKEI_KIN_27
,    SUM(CASE WHEN BD31.U053_KAIKEI_KEN_28 IS NULL THEN BD30.KAIKEI_KEN_28 ELSE BD31.U053_KAIKEI_KEN_28 END) AS U053_KAIKEI_KEN_28
,    SUM(CASE WHEN BD31.U054_KAIKEI_KIN_28 IS NULL THEN BD30.KAIKEI_KIN_28 ELSE BD31.U054_KAIKEI_KIN_28 END) AS U054_KAIKEI_KIN_28
,    SUM(CASE WHEN BD31.U055_KAIKEI_KEN_29 IS NULL THEN BD30.KAIKEI_KEN_29 ELSE BD31.U055_KAIKEI_KEN_29 END) AS U055_KAIKEI_KEN_29
,    SUM(CASE WHEN BD31.U056_KAIKEI_KIN_29 IS NULL THEN BD30.KAIKEI_KIN_29 ELSE BD31.U056_KAIKEI_KIN_29 END) AS U056_KAIKEI_KIN_29
,    SUM(CASE WHEN BD31.U057_KAIKEI_KEN_30 IS NULL THEN BD30.KAIKEI_KEN_30 ELSE BD31.U057_KAIKEI_KEN_30 END) AS U057_KAIKEI_KEN_30
,    SUM(CASE WHEN BD31.U058_KAIKEI_KIN_30 IS NULL THEN BD30.KAIKEI_KIN_30 ELSE BD31.U058_KAIKEI_KIN_30 END) AS U058_KAIKEI_KIN_30
,    SUM(CASE WHEN BD31.U059_KAIKEI_KEN_31 IS NULL THEN BD30.KAIKEI_KEN_31 ELSE BD31.U059_KAIKEI_KEN_31 END) AS U059_KAIKEI_KEN_31
,    SUM(CASE WHEN BD31.U060_KAIKEI_KIN_31 IS NULL THEN BD30.KAIKEI_KIN_31 ELSE BD31.U060_KAIKEI_KIN_31 END) AS U060_KAIKEI_KIN_31
,    SUM(CASE WHEN BD31.U061_KAIKEI_KEN_32 IS NULL THEN BD30.KAIKEI_KEN_32 ELSE BD31.U061_KAIKEI_KEN_32 END) AS U061_KAIKEI_KEN_32
,    SUM(CASE WHEN BD31.U062_KAIKEI_KIN_32 IS NULL THEN BD30.KAIKEI_KIN_32 ELSE BD31.U062_KAIKEI_KIN_32 END) AS U062_KAIKEI_KIN_32
,    SUM(CASE WHEN BD31.U063_KAIKEI_KEN_33 IS NULL THEN BD30.KAIKEI_KEN_33 ELSE BD31.U063_KAIKEI_KEN_33 END) AS U063_KAIKEI_KEN_33
,    SUM(CASE WHEN BD31.U064_KAIKEI_KIN_33 IS NULL THEN BD30.KAIKEI_KIN_33 ELSE BD31.U064_KAIKEI_KIN_33 END) AS U064_KAIKEI_KIN_33
,    SUM(CASE WHEN BD31.U065_KAIKEI_KEN_34 IS NULL THEN BD30.KAIKEI_KEN_34 ELSE BD31.U065_KAIKEI_KEN_34 END) AS U065_KAIKEI_KEN_34
,    SUM(CASE WHEN BD31.U066_KAIKEI_KIN_34 IS NULL THEN BD30.KAIKEI_KIN_34 ELSE BD31.U066_KAIKEI_KIN_34 END) AS U066_KAIKEI_KIN_34
,    SUM(CASE WHEN BD31.U067_KAIKEI_KEN_35 IS NULL THEN BD30.KAIKEI_KEN_35 ELSE BD31.U067_KAIKEI_KEN_35 END) AS U067_KAIKEI_KEN_35
,    SUM(CASE WHEN BD31.U068_KAIKEI_KIN_35 IS NULL THEN BD30.KAIKEI_KIN_35 ELSE BD31.U068_KAIKEI_KIN_35 END) AS U068_KAIKEI_KIN_35
,    SUM(CASE WHEN BD31.U069_KAIKEI_KEN_36 IS NULL THEN BD30.KAIKEI_KEN_36 ELSE BD31.U069_KAIKEI_KEN_36 END) AS U069_KAIKEI_KEN_36
,    SUM(CASE WHEN BD31.U070_KAIKEI_KIN_36 IS NULL THEN BD30.KAIKEI_KIN_36 ELSE BD31.U070_KAIKEI_KIN_36 END) AS U070_KAIKEI_KIN_36
,    SUM(CASE WHEN BD31.U071_KAIKEI_KEN_37 IS NULL THEN BD30.KAIKEI_KEN_37 ELSE BD31.U071_KAIKEI_KEN_37 END) AS U071_KAIKEI_KEN_37
,    SUM(CASE WHEN BD31.U072_KAIKEI_KIN_37 IS NULL THEN BD30.KAIKEI_KIN_37 ELSE BD31.U072_KAIKEI_KIN_37 END) AS U072_KAIKEI_KIN_37
,    SUM(CASE WHEN BD31.U073_KAIKEI_KEN_38 IS NULL THEN BD30.KAIKEI_KEN_38 ELSE BD31.U073_KAIKEI_KEN_38 END) AS U073_KAIKEI_KEN_38
,    SUM(CASE WHEN BD31.U074_KAIKEI_KIN_38 IS NULL THEN BD30.KAIKEI_KIN_38 ELSE BD31.U074_KAIKEI_KIN_38 END) AS U074_KAIKEI_KIN_38
,    SUM(CASE WHEN BD31.U075_KAIKEI_KEN_39 IS NULL THEN BD30.KAIKEI_KEN_39 ELSE BD31.U075_KAIKEI_KEN_39 END) AS U075_KAIKEI_KEN_39
,    SUM(CASE WHEN BD31.U076_KAIKEI_KIN_39 IS NULL THEN BD30.KAIKEI_KIN_39 ELSE BD31.U076_KAIKEI_KIN_39 END) AS U076_KAIKEI_KIN_39
,    SUM(CASE WHEN BD31.U077_KAIKEI_KEN_40 IS NULL THEN BD30.KAIKEI_KEN_40 ELSE BD31.U077_KAIKEI_KEN_40 END) AS U077_KAIKEI_KEN_40
,    SUM(CASE WHEN BD31.U078_KAIKEI_KIN_40 IS NULL THEN BD30.KAIKEI_KIN_40 ELSE BD31.U078_KAIKEI_KIN_40 END) AS U078_KAIKEI_KIN_40
,    SUM(CASE WHEN BD31.U079_KAIKEI_KEN_41 IS NULL THEN BD30.KAIKEI_KEN_41 ELSE BD31.U079_KAIKEI_KEN_41 END) AS U079_KAIKEI_KEN_41
,    SUM(CASE WHEN BD31.U080_KAIKEI_KIN_41 IS NULL THEN BD30.KAIKEI_KIN_41 ELSE BD31.U080_KAIKEI_KIN_41 END) AS U080_KAIKEI_KIN_41
,    SUM(CASE WHEN BD31.U081_KAIKEI_KEN_42 IS NULL THEN BD30.KAIKEI_KEN_42 ELSE BD31.U081_KAIKEI_KEN_42 END) AS U081_KAIKEI_KEN_42
,    SUM(CASE WHEN BD31.U082_KAIKEI_KIN_42 IS NULL THEN BD30.KAIKEI_KIN_42 ELSE BD31.U082_KAIKEI_KIN_42 END) AS U082_KAIKEI_KIN_42
,    SUM(CASE WHEN BD31.U083_KAIKEI_KEN_43 IS NULL THEN BD30.KAIKEI_KEN_43 ELSE BD31.U083_KAIKEI_KEN_43 END) AS U083_KAIKEI_KEN_43
,    SUM(CASE WHEN BD31.U084_KAIKEI_KIN_43 IS NULL THEN BD30.KAIKEI_KIN_43 ELSE BD31.U084_KAIKEI_KIN_43 END) AS U084_KAIKEI_KIN_43
,    SUM(CASE WHEN BD31.U085_KAIKEI_KEN_44 IS NULL THEN BD30.KAIKEI_KEN_44 ELSE BD31.U085_KAIKEI_KEN_44 END) AS U085_KAIKEI_KEN_44
,    SUM(CASE WHEN BD31.U086_KAIKEI_KIN_44 IS NULL THEN BD30.KAIKEI_KIN_44 ELSE BD31.U086_KAIKEI_KIN_44 END) AS U086_KAIKEI_KIN_44
,    SUM(CASE WHEN BD31.U087_KAIKEI_KEN_45 IS NULL THEN BD30.KAIKEI_KEN_45 ELSE BD31.U087_KAIKEI_KEN_45 END) AS U087_KAIKEI_KEN_45
,    SUM(CASE WHEN BD31.U088_KAIKEI_KIN_45 IS NULL THEN BD30.KAIKEI_KIN_45 ELSE BD31.U088_KAIKEI_KIN_45 END) AS U088_KAIKEI_KIN_45
,    SUM(CASE WHEN BD31.U089_KAIKEI_KEN_46 IS NULL THEN BD30.KAIKEI_KEN_46 ELSE BD31.U089_KAIKEI_KEN_46 END) AS U089_KAIKEI_KEN_46
,    SUM(CASE WHEN BD31.U090_KAIKEI_KIN_46 IS NULL THEN BD30.KAIKEI_KIN_46 ELSE BD31.U090_KAIKEI_KIN_46 END) AS U090_KAIKEI_KIN_46
,    SUM(CASE WHEN BD31.U091_KAIKEI_KEN_47 IS NULL THEN BD30.KAIKEI_KEN_47 ELSE BD31.U091_KAIKEI_KEN_47 END) AS U091_KAIKEI_KEN_47
,    SUM(CASE WHEN BD31.U092_KAIKEI_KIN_47 IS NULL THEN BD30.KAIKEI_KIN_47 ELSE BD31.U092_KAIKEI_KIN_47 END) AS U092_KAIKEI_KIN_47
,    SUM(CASE WHEN BD31.U093_KAIKEI_KEN_48 IS NULL THEN BD30.KAIKEI_KEN_48 ELSE BD31.U093_KAIKEI_KEN_48 END) AS U093_KAIKEI_KEN_48
,    SUM(CASE WHEN BD31.U094_KAIKEI_KIN_48 IS NULL THEN BD30.KAIKEI_KIN_48 ELSE BD31.U094_KAIKEI_KIN_48 END) AS U094_KAIKEI_KIN_48
,    SUM(CASE WHEN BD31.U095_KAIKEI_KEN_49 IS NULL THEN BD30.KAIKEI_KEN_49 ELSE BD31.U095_KAIKEI_KEN_49 END) AS U095_KAIKEI_KEN_49
,    SUM(CASE WHEN BD31.U096_KAIKEI_KIN_49 IS NULL THEN BD30.KAIKEI_KIN_49 ELSE BD31.U096_KAIKEI_KIN_49 END) AS U096_KAIKEI_KIN_49
,    SUM(CASE WHEN BD31.U097_KAIKEI_KEN_50 IS NULL THEN BD30.KAIKEI_KEN_50 ELSE BD31.U097_KAIKEI_KEN_50 END) AS U097_KAIKEI_KEN_50
,    SUM(CASE WHEN BD31.U098_KAIKEI_KIN_50 IS NULL THEN BD30.KAIKEI_KIN_50 ELSE BD31.U098_KAIKEI_KIN_50 END) AS U098_KAIKEI_KIN_50
,    SUM(CASE WHEN BD31.U099_KAIKEI_KEN_51 IS NULL THEN BD30.KAIKEI_KEN_51 ELSE BD31.U099_KAIKEI_KEN_51 END) AS U099_KAIKEI_KEN_51
,    SUM(CASE WHEN BD31.U100_KAIKEI_KIN_51 IS NULL THEN BD30.KAIKEI_KIN_51 ELSE BD31.U100_KAIKEI_KIN_51 END) AS U100_KAIKEI_KIN_51
,    SUM(CASE WHEN BD31.U101_KAIKEI_KEN_52 IS NULL THEN BD30.KAIKEI_KEN_52 ELSE BD31.U101_KAIKEI_KEN_52 END) AS U101_KAIKEI_KEN_52
,    SUM(CASE WHEN BD31.U102_KAIKEI_KIN_52 IS NULL THEN BD30.KAIKEI_KIN_52 ELSE BD31.U102_KAIKEI_KIN_52 END) AS U102_KAIKEI_KIN_52
,    SUM(CASE WHEN BD31.U103_KAIKEI_KEN_53 IS NULL THEN BD30.KAIKEI_KEN_53 ELSE BD31.U103_KAIKEI_KEN_53 END) AS U103_KAIKEI_KEN_53
,    SUM(CASE WHEN BD31.U104_KAIKEI_KIN_53 IS NULL THEN BD30.KAIKEI_KIN_53 ELSE BD31.U104_KAIKEI_KIN_53 END) AS U104_KAIKEI_KIN_53
,    SUM(CASE WHEN BD31.U105_KAIKEI_KEN_54 IS NULL THEN BD30.KAIKEI_KEN_54 ELSE BD31.U105_KAIKEI_KEN_54 END) AS U105_KAIKEI_KEN_54
,    SUM(CASE WHEN BD31.U106_KAIKEI_KIN_54 IS NULL THEN BD30.KAIKEI_KIN_54 ELSE BD31.U106_KAIKEI_KIN_54 END) AS U106_KAIKEI_KIN_54
,    SUM(CASE WHEN BD31.U107_KAIKEI_KEN_55 IS NULL THEN BD30.KAIKEI_KEN_55 ELSE BD31.U107_KAIKEI_KEN_55 END) AS U107_KAIKEI_KEN_55
,    SUM(CASE WHEN BD31.U108_KAIKEI_KIN_55 IS NULL THEN BD30.KAIKEI_KIN_55 ELSE BD31.U108_KAIKEI_KIN_55 END) AS U108_KAIKEI_KIN_55
,    SUM(CASE WHEN BD31.U109_KAIKEI_KEN_56 IS NULL THEN BD30.KAIKEI_KEN_56 ELSE BD31.U109_KAIKEI_KEN_56 END) AS U109_KAIKEI_KEN_56
,    SUM(CASE WHEN BD31.U110_KAIKEI_KIN_56 IS NULL THEN BD30.KAIKEI_KIN_56 ELSE BD31.U110_KAIKEI_KIN_56 END) AS U110_KAIKEI_KIN_56
,    SUM(CASE WHEN BD31.U111_KAIKEI_KEN_57 IS NULL THEN BD30.KAIKEI_KEN_57 ELSE BD31.U111_KAIKEI_KEN_57 END) AS U111_KAIKEI_KEN_57
,    SUM(CASE WHEN BD31.U112_KAIKEI_KIN_57 IS NULL THEN BD30.KAIKEI_KIN_57 ELSE BD31.U112_KAIKEI_KIN_57 END) AS U112_KAIKEI_KIN_57
,    SUM(CASE WHEN BD31.U113_KAIKEI_KEN_58 IS NULL THEN BD30.KAIKEI_KEN_58 ELSE BD31.U113_KAIKEI_KEN_58 END) AS U113_KAIKEI_KEN_58
,    SUM(CASE WHEN BD31.U114_KAIKEI_KIN_58 IS NULL THEN BD30.KAIKEI_KIN_58 ELSE BD31.U114_KAIKEI_KIN_58 END) AS U114_KAIKEI_KIN_58
,    SUM(CASE WHEN BD31.U115_KAIKEI_KEN_59 IS NULL THEN BD30.KAIKEI_KEN_59 ELSE BD31.U115_KAIKEI_KEN_59 END) AS U115_KAIKEI_KEN_59
,    SUM(CASE WHEN BD31.U116_KAIKEI_KIN_59 IS NULL THEN BD30.KAIKEI_KIN_59 ELSE BD31.U116_KAIKEI_KIN_59 END) AS U116_KAIKEI_KIN_59
,    SUM(CASE WHEN BD31.U117_KAIKEI_KEN_60 IS NULL THEN BD30.KAIKEI_KEN_60 ELSE BD31.U117_KAIKEI_KEN_60 END) AS U117_KAIKEI_KEN_60
,    SUM(CASE WHEN BD31.U118_KAIKEI_KIN_60 IS NULL THEN BD30.KAIKEI_KIN_60 ELSE BD31.U118_KAIKEI_KIN_60 END) AS U118_KAIKEI_KIN_60
,    SUM(CASE WHEN BD31.U119_KAIKEI_KEN_61 IS NULL THEN BD30.KAIKEI_KEN_61 ELSE BD31.U119_KAIKEI_KEN_61 END) AS U119_KAIKEI_KEN_61
,    SUM(CASE WHEN BD31.U120_KAIKEI_KIN_61 IS NULL THEN BD30.KAIKEI_KIN_61 ELSE BD31.U120_KAIKEI_KIN_61 END) AS U120_KAIKEI_KIN_61
,    SUM(CASE WHEN BD31.U121_KAIKEI_KEN_62 IS NULL THEN BD30.KAIKEI_KEN_62 ELSE BD31.U121_KAIKEI_KEN_62 END) AS U121_KAIKEI_KEN_62
,    SUM(CASE WHEN BD31.U122_KAIKEI_KIN_62 IS NULL THEN BD30.KAIKEI_KIN_62 ELSE BD31.U122_KAIKEI_KIN_62 END) AS U122_KAIKEI_KIN_62
,    SUM(CASE WHEN BD31.U123_KAIKEI_KEN_63 IS NULL THEN BD30.KAIKEI_KEN_63 ELSE BD31.U123_KAIKEI_KEN_63 END) AS U123_KAIKEI_KEN_63
,    SUM(CASE WHEN BD31.U124_KAIKEI_KIN_63 IS NULL THEN BD30.KAIKEI_KIN_63 ELSE BD31.U124_KAIKEI_KIN_63 END) AS U124_KAIKEI_KIN_63
,    SUM(CASE WHEN BD31.U125_KAIKEI_KEN_64 IS NULL THEN BD30.KAIKEI_KEN_64 ELSE BD31.U125_KAIKEI_KEN_64 END) AS U125_KAIKEI_KEN_64
,    SUM(CASE WHEN BD31.U126_KAIKEI_KIN_64 IS NULL THEN BD30.KAIKEI_KIN_64 ELSE BD31.U126_KAIKEI_KIN_64 END) AS U126_KAIKEI_KIN_64
,    SUM(CASE WHEN BD31.U127_KAIKEI_KEN_65 IS NULL THEN BD30.KAIKEI_KEN_65 ELSE BD31.U127_KAIKEI_KEN_65 END) AS U127_KAIKEI_KEN_65
,    SUM(CASE WHEN BD31.U128_KAIKEI_KIN_65 IS NULL THEN BD30.KAIKEI_KIN_65 ELSE BD31.U128_KAIKEI_KIN_65 END) AS U128_KAIKEI_KIN_65
,    SUM(CASE WHEN BD31.U129_KAIKEI_KEN_66 IS NULL THEN BD30.KAIKEI_KEN_66 ELSE BD31.U129_KAIKEI_KEN_66 END) AS U129_KAIKEI_KEN_66
,    SUM(CASE WHEN BD31.U130_KAIKEI_KIN_66 IS NULL THEN BD30.KAIKEI_KIN_66 ELSE BD31.U130_KAIKEI_KIN_66 END) AS U130_KAIKEI_KIN_66
,    SUM(CASE WHEN BD31.U131_KAIKEI_KEN_67 IS NULL THEN BD30.KAIKEI_KEN_67 ELSE BD31.U131_KAIKEI_KEN_67 END) AS U131_KAIKEI_KEN_67
,    SUM(CASE WHEN BD31.U132_KAIKEI_KIN_67 IS NULL THEN BD30.KAIKEI_KIN_67 ELSE BD31.U132_KAIKEI_KIN_67 END) AS U132_KAIKEI_KIN_67
,    SUM(CASE WHEN BD31.U133_KAIKEI_KEN_68 IS NULL THEN BD30.KAIKEI_KEN_68 ELSE BD31.U133_KAIKEI_KEN_68 END) AS U133_KAIKEI_KEN_68
,    SUM(CASE WHEN BD31.U134_KAIKEI_KIN_68 IS NULL THEN BD30.KAIKEI_KIN_68 ELSE BD31.U134_KAIKEI_KIN_68 END) AS U134_KAIKEI_KIN_68
,    SUM(CASE WHEN BD31.U135_KAIKEI_KEN_69 IS NULL THEN BD30.KAIKEI_KEN_69 ELSE BD31.U135_KAIKEI_KEN_69 END) AS U135_KAIKEI_KEN_69
,    SUM(CASE WHEN BD31.U136_KAIKEI_KIN_69 IS NULL THEN BD30.KAIKEI_KIN_69 ELSE BD31.U136_KAIKEI_KIN_69 END) AS U136_KAIKEI_KIN_69
,    SUM(CASE WHEN BD31.U137_KAIKEI_KEN_70 IS NULL THEN BD30.KAIKEI_KEN_70 ELSE BD31.U137_KAIKEI_KEN_70 END) AS U137_KAIKEI_KEN_70
,    SUM(CASE WHEN BD31.U138_KAIKEI_KIN_70 IS NULL THEN BD30.KAIKEI_KIN_70 ELSE BD31.U138_KAIKEI_KIN_70 END) AS U138_KAIKEI_KIN_70
,    SUM(CASE WHEN BD31.U139_KAIKEI_KEN_71 IS NULL THEN BD30.KAIKEI_KEN_71 ELSE BD31.U139_KAIKEI_KEN_71 END) AS U139_KAIKEI_KEN_71
,    SUM(CASE WHEN BD31.U140_KAIKEI_KIN_71 IS NULL THEN BD30.KAIKEI_KIN_71 ELSE BD31.U140_KAIKEI_KIN_71 END) AS U140_KAIKEI_KIN_71
,    SUM(CASE WHEN BD31.U141_KAIKEI_KEN_72 IS NULL THEN BD30.KAIKEI_KEN_72 ELSE BD31.U141_KAIKEI_KEN_72 END) AS U141_KAIKEI_KEN_72
,    SUM(CASE WHEN BD31.U142_KAIKEI_KIN_72 IS NULL THEN BD30.KAIKEI_KIN_72 ELSE BD31.U142_KAIKEI_KIN_72 END) AS U142_KAIKEI_KIN_72
,    SUM(CASE WHEN BD31.U143_KAIKEI_KEN_73 IS NULL THEN BD30.KAIKEI_KEN_73 ELSE BD31.U143_KAIKEI_KEN_73 END) AS U143_KAIKEI_KEN_73
,    SUM(CASE WHEN BD31.U144_KAIKEI_KIN_73 IS NULL THEN BD30.KAIKEI_KIN_73 ELSE BD31.U144_KAIKEI_KIN_73 END) AS U144_KAIKEI_KIN_73
,    SUM(CASE WHEN BD31.U145_KAIKEI_KEN_74 IS NULL THEN BD30.KAIKEI_KEN_74 ELSE BD31.U145_KAIKEI_KEN_74 END) AS U145_KAIKEI_KEN_74
,    SUM(CASE WHEN BD31.U146_KAIKEI_KIN_74 IS NULL THEN BD30.KAIKEI_KIN_74 ELSE BD31.U146_KAIKEI_KIN_74 END) AS U146_KAIKEI_KIN_74
,    SUM(CASE WHEN BD31.U147_KAIKEI_KEN_75 IS NULL THEN BD30.KAIKEI_KEN_75 ELSE BD31.U147_KAIKEI_KEN_75 END) AS U147_KAIKEI_KEN_75
,    SUM(CASE WHEN BD31.U148_KAIKEI_KIN_75 IS NULL THEN BD30.KAIKEI_KIN_75 ELSE BD31.U148_KAIKEI_KIN_75 END) AS U148_KAIKEI_KIN_75
,    SUM(CASE WHEN BD31.U149_KAIKEI_KEN_76 IS NULL THEN BD30.KAIKEI_KEN_76 ELSE BD31.U149_KAIKEI_KEN_76 END) AS U149_KAIKEI_KEN_76
,    SUM(CASE WHEN BD31.U150_KAIKEI_KIN_76 IS NULL THEN BD30.KAIKEI_KIN_76 ELSE BD31.U150_KAIKEI_KIN_76 END) AS U150_KAIKEI_KIN_76
,    SUM(CASE WHEN BD31.U151_KAIKEI_KEN_77 IS NULL THEN BD30.KAIKEI_KEN_77 ELSE BD31.U151_KAIKEI_KEN_77 END) AS U151_KAIKEI_KEN_77
,    SUM(CASE WHEN BD31.U152_KAIKEI_KIN_77 IS NULL THEN BD30.KAIKEI_KIN_77 ELSE BD31.U152_KAIKEI_KIN_77 END) AS U152_KAIKEI_KIN_77
,    SUM(CASE WHEN BD31.U153_KAIKEI_KEN_78 IS NULL THEN BD30.KAIKEI_KEN_78 ELSE BD31.U153_KAIKEI_KEN_78 END) AS U153_KAIKEI_KEN_78
,    SUM(CASE WHEN BD31.U154_KAIKEI_KIN_78 IS NULL THEN BD30.KAIKEI_KIN_78 ELSE BD31.U154_KAIKEI_KIN_78 END) AS U154_KAIKEI_KIN_78
,    SUM(CASE WHEN BD31.U155_KAIKEI_KEN_79 IS NULL THEN BD30.KAIKEI_KEN_79 ELSE BD31.U155_KAIKEI_KEN_79 END) AS U155_KAIKEI_KEN_79
,    SUM(CASE WHEN BD31.U156_KAIKEI_KIN_79 IS NULL THEN BD30.KAIKEI_KIN_79 ELSE BD31.U156_KAIKEI_KIN_79 END) AS U156_KAIKEI_KIN_79
,    SUM(CASE WHEN BD31.U157_KAIKEI_KEN_80 IS NULL THEN BD30.KAIKEI_KEN_80 ELSE BD31.U157_KAIKEI_KEN_80 END) AS U157_KAIKEI_KEN_80
,    SUM(CASE WHEN BD31.U158_KAIKEI_KIN_80 IS NULL THEN BD30.KAIKEI_KIN_80 ELSE BD31.U158_KAIKEI_KIN_80 END) AS U158_KAIKEI_KIN_80
,    SUM(CASE WHEN BD31.U159_KAIKEI_KEN_81 IS NULL THEN BD30.KAIKEI_KEN_81 ELSE BD31.U159_KAIKEI_KEN_81 END) AS U159_KAIKEI_KEN_81
,    SUM(CASE WHEN BD31.U160_KAIKEI_KIN_81 IS NULL THEN BD30.KAIKEI_KIN_81 ELSE BD31.U160_KAIKEI_KIN_81 END) AS U160_KAIKEI_KIN_81
,    SUM(CASE WHEN BD31.U161_KAIKEI_KEN_82 IS NULL THEN BD30.KAIKEI_KEN_82 ELSE BD31.U161_KAIKEI_KEN_82 END) AS U161_KAIKEI_KEN_82
,    SUM(CASE WHEN BD31.U162_KAIKEI_KIN_82 IS NULL THEN BD30.KAIKEI_KIN_82 ELSE BD31.U162_KAIKEI_KIN_82 END) AS U162_KAIKEI_KIN_82
,    SUM(CASE WHEN BD31.U163_KAIKEI_KEN_83 IS NULL THEN BD30.KAIKEI_KEN_83 ELSE BD31.U163_KAIKEI_KEN_83 END) AS U163_KAIKEI_KEN_83
,    SUM(CASE WHEN BD31.U164_KAIKEI_KIN_83 IS NULL THEN BD30.KAIKEI_KIN_83 ELSE BD31.U164_KAIKEI_KIN_83 END) AS U164_KAIKEI_KIN_83
,    SUM(CASE WHEN BD31.U165_KAIKEI_KEN_84 IS NULL THEN BD30.KAIKEI_KEN_84 ELSE BD31.U165_KAIKEI_KEN_84 END) AS U165_KAIKEI_KEN_84
,    SUM(CASE WHEN BD31.U166_KAIKEI_KIN_84 IS NULL THEN BD30.KAIKEI_KIN_84 ELSE BD31.U166_KAIKEI_KIN_84 END) AS U166_KAIKEI_KIN_84
,    SUM(CASE WHEN BD31.U167_KAIKEI_KEN_85 IS NULL THEN BD30.KAIKEI_KEN_85 ELSE BD31.U167_KAIKEI_KEN_85 END) AS U167_KAIKEI_KEN_85
,    SUM(CASE WHEN BD31.U168_KAIKEI_KIN_85 IS NULL THEN BD30.KAIKEI_KIN_85 ELSE BD31.U168_KAIKEI_KIN_85 END) AS U168_KAIKEI_KIN_85
,    SUM(CASE WHEN BD31.U169_KAIKEI_KEN_86 IS NULL THEN BD30.KAIKEI_KEN_86 ELSE BD31.U169_KAIKEI_KEN_86 END) AS U169_KAIKEI_KEN_86
,    SUM(CASE WHEN BD31.U170_KAIKEI_KIN_86 IS NULL THEN BD30.KAIKEI_KIN_86 ELSE BD31.U170_KAIKEI_KIN_86 END) AS U170_KAIKEI_KIN_86
,    SUM(CASE WHEN BD31.U171_KAIKEI_KEN_87 IS NULL THEN BD30.KAIKEI_KEN_87 ELSE BD31.U171_KAIKEI_KEN_87 END) AS U171_KAIKEI_KEN_87
,    SUM(CASE WHEN BD31.U172_KAIKEI_KIN_87 IS NULL THEN BD30.KAIKEI_KIN_87 ELSE BD31.U172_KAIKEI_KIN_87 END) AS U172_KAIKEI_KIN_87
,    SUM(CASE WHEN BD31.U173_KAIKEI_KEN_88 IS NULL THEN BD30.KAIKEI_KEN_88 ELSE BD31.U173_KAIKEI_KEN_88 END) AS U173_KAIKEI_KEN_88
,    SUM(CASE WHEN BD31.U174_KAIKEI_KIN_88 IS NULL THEN BD30.KAIKEI_KIN_88 ELSE BD31.U174_KAIKEI_KIN_88 END) AS U174_KAIKEI_KIN_88
,    SUM(CASE WHEN BD31.U175_KAIKEI_KEN_89 IS NULL THEN BD30.KAIKEI_KEN_89 ELSE BD31.U175_KAIKEI_KEN_89 END) AS U175_KAIKEI_KEN_89
,    SUM(CASE WHEN BD31.U176_KAIKEI_KIN_89 IS NULL THEN BD30.KAIKEI_KIN_89 ELSE BD31.U176_KAIKEI_KIN_89 END) AS U176_KAIKEI_KIN_89
,    SUM(CASE WHEN BD31.U177_KAIKEI_KEN_90 IS NULL THEN BD30.KAIKEI_KEN_90 ELSE BD31.U177_KAIKEI_KEN_90 END) AS U177_KAIKEI_KEN_90
,    SUM(CASE WHEN BD31.U178_KAIKEI_KIN_90 IS NULL THEN BD30.KAIKEI_KIN_90 ELSE BD31.U178_KAIKEI_KIN_90 END) AS U178_KAIKEI_KIN_90
,    MAX(BD31.FIRST_USER) AS FIRST_USER 
,    MAX(BD31.FIRST_PGM)  AS FIRST_PGM 
,    MAX(BD31.FIRST_TMSP) AS FIRST_TMSP 
,    MAX(BD31.LAST_USER)  AS LAST_USER 
,    MAX(BD31.LAST_PGM)   AS LAST_PGM
,    MAX(BD31.LAST_TMSP)  AS LAST_TMSP

FROM
    BD30KKAD BD30
    LEFT JOIN BD31KKUP BD31
        ON(UP_DT = /*sysData*/'20120803'
           AND BD31.UP_FLG <> '2'
           AND BD31.COMPANY_CD = BD30.COMPANY_CD
           AND BD31.MISE_CD = BD30.MISE_CD
           AND BD31.EIGYO_DT = BD30.EIGYO_DT
           )
WHERE BD30.COMPANY_CD = /*companyCd*/'00'
AND   BD30.MISE_CD = /*miseCd*/'01236'
AND   SUBSTR(BD30.EIGYO_DT, 1, 6) = /*targetYM*/'201207'

GROUP BY ROLLUP (BD30.EIGYO_DT)

ORDER BY EIGYO_DT