SELECT 
	MISE_CD 
  , MISE_NAME_KJ
  , COMPANY_CD
FROM
	((SELECT DISTINCT  BM01.MISE_CD
	   , 			BM01.MISE_NAME_KJ
	   ,            BM01.COMPANY_CD
	   ,            BM01.CLOSE_DT 
	FROM    BM01TENM as BM01,
		  BM11ONER as BM11
	WHERE BM01.ONER_CD = /*onerCd*/'36478' 
	AND BM01.COMPANY_CD = /*companyCd*/'00'
	AND BM01.CLOSE_DT >= /*sysDate*/'20060823'
	AND BM01.OPEN_DT <= /*sysDate*/'20060823'
	AND BM01.COMPANY_CD = BM11.COMPANY_CD 
	AND BM01.ONER_CD =  BM11.ONER_CD 
	ORDER BY BM01.MISE_CD)
	UNION ALL
	(SELECT DISTINCT BM01.MISE_CD
	   ,            (RTRIM(BM01.MISE_NAME_KJ) CONCAT '(CLOSE)') AS MISE_NAME_KJ
	   ,            BM01.COMPANY_CD	
         ,            BM01.CLOSE_DT
	FROM   BM01TENM as BM01,
	       BM11ONER as BM11
	WHERE BM01.ONER_CD = /*onerCd*/'36478' 
	AND BM01.COMPANY_CD = /*companyCd*/'00'
	AND (BM01.CLOSE_DT < /*sysDate*/'20060823' 
	     OR BM01.OPEN_DT > /*sysDate*/'20060823')
	AND BM01.COMPANY_CD = BM11.COMPANY_CD 
	AND BM01.ONER_CD =  BM11.ONER_CD 
	ORDER BY BM01.MISE_CD)) as TBL
ORDER BY CLOSE_DT DESC, MISE_CD	