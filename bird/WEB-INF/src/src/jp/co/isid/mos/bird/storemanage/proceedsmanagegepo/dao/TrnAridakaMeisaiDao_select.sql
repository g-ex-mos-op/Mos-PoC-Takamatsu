SELECT
    BD30.EIGYO_DT,
    MAX(BD30.COMPANY_CD) AS COMPANY_CD,
	/*IF miseCd != null && miseCd.equals("") == false && miseCd.equals("99999") == false */
	    MAX(BM01.MISE_NAME_KJ) || 
	    CASE WHEN MAX(BM01.CLOSE_DT) <= /*sysDate*/'20070228' THEN '(CLOSE)'
	        ELSE ''
	    END  AS TAISHO_NAME,
	--ELSE
	    '‘S“X' AS TAISHO_NAME,
	/*END*/    SUM(BD30.KAIKEI_KEN_2) AS KAIKEI_KEN_2,
    SUM(BD30.KAIKEI_KIN_2) AS KAIKEI_KIN_2,
    SUM(BD30.KAIKEI_KEN_3) AS KAIKEI_KEN_3,
    SUM(BD30.KAIKEI_KIN_3) AS KAIKEI_KIN_3,
    SUM(BD30.KAIKEI_KEN_4) AS KAIKEI_KEN_4,
    SUM(BD30.KAIKEI_KIN_4) AS KAIKEI_KIN_4,
    SUM(BD30.KAIKEI_KEN_5) AS KAIKEI_KEN_5,
    SUM(BD30.KAIKEI_KIN_5) AS KAIKEI_KIN_5,
    SUM(BD30.KAIKEI_KEN_6) AS KAIKEI_KEN_6,
    SUM(BD30.KAIKEI_KIN_6) AS KAIKEI_KIN_6,
    SUM(BD30.KAIKEI_KEN_7) AS KAIKEI_KEN_7,
    SUM(BD30.KAIKEI_KIN_7) AS KAIKEI_KIN_7,
    SUM(BD30.KAIKEI_KEN_8) AS KAIKEI_KEN_8,
    SUM(BD30.KAIKEI_KIN_8) AS KAIKEI_KIN_8,
    SUM(BD30.KAIKEI_KEN_9) AS KAIKEI_KEN_9,
    SUM(BD30.KAIKEI_KIN_9) AS KAIKEI_KIN_9,
    SUM(BD30.KAIKEI_KEN_10) AS KAIKEI_KEN_10,
    SUM(BD30.KAIKEI_KIN_10) AS KAIKEI_KIN_10,
    SUM(BD30.KAIKEI_KEN_11) AS KAIKEI_KEN_11,
    SUM(BD30.KAIKEI_KIN_11) AS KAIKEI_KIN_11,
    SUM(BD30.KAIKEI_KEN_12) AS KAIKEI_KEN_12,
    SUM(BD30.KAIKEI_KIN_12) AS KAIKEI_KIN_12,
    SUM(BD30.KAIKEI_KEN_13) AS KAIKEI_KEN_13,
    SUM(BD30.KAIKEI_KIN_13) AS KAIKEI_KIN_13,
    SUM(BD30.KAIKEI_KEN_14) AS KAIKEI_KEN_14,
    SUM(BD30.KAIKEI_KIN_14) AS KAIKEI_KIN_14,
    SUM(BD30.KAIKEI_KEN_15) AS KAIKEI_KEN_15,
    SUM(BD30.KAIKEI_KIN_15) AS KAIKEI_KIN_15,
    SUM(BD30.KAIKEI_KEN_16) AS KAIKEI_KEN_16,
    SUM(BD30.KAIKEI_KIN_16) AS KAIKEI_KIN_16,
    SUM(BD30.KAIKEI_KEN_17) AS KAIKEI_KEN_17,
    SUM(BD30.KAIKEI_KIN_17) AS KAIKEI_KIN_17,
    SUM(BD30.KAIKEI_KEN_18) AS KAIKEI_KEN_18,
    SUM(BD30.KAIKEI_KIN_18) AS KAIKEI_KIN_18,
    SUM(BD30.KAIKEI_KEN_19) AS KAIKEI_KEN_19,
    SUM(BD30.KAIKEI_KIN_19) AS KAIKEI_KIN_19,
    SUM(BD30.KAIKEI_KEN_20) AS KAIKEI_KEN_20,
    SUM(BD30.KAIKEI_KIN_20) AS KAIKEI_KIN_20,
    SUM(BD30.KAIKEI_KEN_21) AS KAIKEI_KEN_21,
    SUM(BD30.KAIKEI_KIN_21) AS KAIKEI_KIN_21,
    SUM(BD30.KAIKEI_KEN_22) AS KAIKEI_KEN_22,
    SUM(BD30.KAIKEI_KIN_22) AS KAIKEI_KIN_22,
    SUM(BD30.KAIKEI_KEN_23) AS KAIKEI_KEN_23,
    SUM(BD30.KAIKEI_KIN_23) AS KAIKEI_KIN_23,
    SUM(BD30.KAIKEI_KEN_24) AS KAIKEI_KEN_24,
    SUM(BD30.KAIKEI_KIN_24) AS KAIKEI_KIN_24,
    SUM(BD30.KAIKEI_KEN_25) AS KAIKEI_KEN_25,
    SUM(BD30.KAIKEI_KIN_25) AS KAIKEI_KIN_25,
    SUM(BD30.KAIKEI_KEN_26) AS KAIKEI_KEN_26,
    SUM(BD30.KAIKEI_KIN_26) AS KAIKEI_KIN_26,
    SUM(BD30.KAIKEI_KEN_27) AS KAIKEI_KEN_27,
    SUM(BD30.KAIKEI_KIN_27) AS KAIKEI_KIN_27,
    SUM(BD30.KAIKEI_KEN_28) AS KAIKEI_KEN_28,
    SUM(BD30.KAIKEI_KIN_28) AS KAIKEI_KIN_28,
    SUM(BD30.KAIKEI_KEN_29) AS KAIKEI_KEN_29,
    SUM(BD30.KAIKEI_KIN_29) AS KAIKEI_KIN_29,
    SUM(BD30.KAIKEI_KEN_30) AS KAIKEI_KEN_30,
    SUM(BD30.KAIKEI_KIN_30) AS KAIKEI_KIN_30,
    SUM(BD30.KAIKEI_KEN_31) AS KAIKEI_KEN_31,
    SUM(BD30.KAIKEI_KIN_31) AS KAIKEI_KIN_31,
    SUM(BD30.KAIKEI_KEN_32) AS KAIKEI_KEN_32,
    SUM(BD30.KAIKEI_KIN_32) AS KAIKEI_KIN_32,
    SUM(BD30.KAIKEI_KEN_33) AS KAIKEI_KEN_33,
    SUM(BD30.KAIKEI_KIN_33) AS KAIKEI_KIN_33,
    SUM(BD30.KAIKEI_KEN_34) AS KAIKEI_KEN_34,
    SUM(BD30.KAIKEI_KIN_34) AS KAIKEI_KIN_34,
    SUM(BD30.KAIKEI_KEN_35) AS KAIKEI_KEN_35,
    SUM(BD30.KAIKEI_KIN_35) AS KAIKEI_KIN_35,
    SUM(BD30.KAIKEI_KEN_36) AS KAIKEI_KEN_36,
    SUM(BD30.KAIKEI_KIN_36) AS KAIKEI_KIN_36,
    SUM(BD30.KAIKEI_KEN_37) AS KAIKEI_KEN_37,
    SUM(BD30.KAIKEI_KIN_37) AS KAIKEI_KIN_37,
    SUM(BD30.KAIKEI_KEN_38) AS KAIKEI_KEN_38,
    SUM(BD30.KAIKEI_KIN_38) AS KAIKEI_KIN_38,
    SUM(BD30.KAIKEI_KEN_39) AS KAIKEI_KEN_39,
    SUM(BD30.KAIKEI_KIN_39) AS KAIKEI_KIN_39,
    SUM(BD30.KAIKEI_KEN_40) AS KAIKEI_KEN_40,
    SUM(BD30.KAIKEI_KIN_40) AS KAIKEI_KIN_40,
    SUM(BD30.KAIKEI_KEN_41) AS KAIKEI_KEN_41,
    SUM(BD30.KAIKEI_KIN_41) AS KAIKEI_KIN_41,
    SUM(BD30.KAIKEI_KEN_42) AS KAIKEI_KEN_42,
    SUM(BD30.KAIKEI_KIN_42) AS KAIKEI_KIN_42,
    SUM(BD30.KAIKEI_KEN_43) AS KAIKEI_KEN_43,
    SUM(BD30.KAIKEI_KIN_43) AS KAIKEI_KIN_43,
    SUM(BD30.KAIKEI_KEN_44) AS KAIKEI_KEN_44,
    SUM(BD30.KAIKEI_KIN_44) AS KAIKEI_KIN_44,
    SUM(BD30.KAIKEI_KEN_45) AS KAIKEI_KEN_45,
    SUM(BD30.KAIKEI_KIN_45) AS KAIKEI_KIN_45,
    SUM(BD30.KAIKEI_KEN_46) AS KAIKEI_KEN_46,
    SUM(BD30.KAIKEI_KIN_46) AS KAIKEI_KIN_46,
    SUM(BD30.KAIKEI_KEN_47) AS KAIKEI_KEN_47,
    SUM(BD30.KAIKEI_KIN_47) AS KAIKEI_KIN_47,
    SUM(BD30.KAIKEI_KEN_48) AS KAIKEI_KEN_48,
    SUM(BD30.KAIKEI_KIN_48) AS KAIKEI_KIN_48,
    SUM(BD30.KAIKEI_KEN_49) AS KAIKEI_KEN_49,
    SUM(BD30.KAIKEI_KIN_49) AS KAIKEI_KIN_49,
    SUM(BD30.KAIKEI_KEN_50) AS KAIKEI_KEN_50,
    SUM(BD30.KAIKEI_KIN_50) AS KAIKEI_KIN_50,
    SUM(BD30.KAIKEI_KEN_51) AS KAIKEI_KEN_51,
    SUM(BD30.KAIKEI_KIN_51) AS KAIKEI_KIN_51,
    SUM(BD30.KAIKEI_KEN_52) AS KAIKEI_KEN_52,
    SUM(BD30.KAIKEI_KIN_52) AS KAIKEI_KIN_52,
    SUM(BD30.KAIKEI_KEN_53) AS KAIKEI_KEN_53,
    SUM(BD30.KAIKEI_KIN_53) AS KAIKEI_KIN_53,
    SUM(BD30.KAIKEI_KEN_54) AS KAIKEI_KEN_54,
    SUM(BD30.KAIKEI_KIN_54) AS KAIKEI_KIN_54,
    SUM(BD30.KAIKEI_KEN_55) AS KAIKEI_KEN_55,
    SUM(BD30.KAIKEI_KIN_55) AS KAIKEI_KIN_55,
    SUM(BD30.KAIKEI_KEN_56) AS KAIKEI_KEN_56,
    SUM(BD30.KAIKEI_KIN_56) AS KAIKEI_KIN_56,
    SUM(BD30.KAIKEI_KEN_57) AS KAIKEI_KEN_57,
    SUM(BD30.KAIKEI_KIN_57) AS KAIKEI_KIN_57,
    SUM(BD30.KAIKEI_KEN_58) AS KAIKEI_KEN_58,
    SUM(BD30.KAIKEI_KIN_58) AS KAIKEI_KIN_58,
    SUM(BD30.KAIKEI_KEN_59) AS KAIKEI_KEN_59,
    SUM(BD30.KAIKEI_KIN_59) AS KAIKEI_KIN_59,
    SUM(BD30.KAIKEI_KEN_60) AS KAIKEI_KEN_60,
    SUM(BD30.KAIKEI_KIN_60) AS KAIKEI_KIN_60,
    SUM(BD30.KAIKEI_KEN_61) AS KAIKEI_KEN_61,
    SUM(BD30.KAIKEI_KIN_61) AS KAIKEI_KIN_61,
    SUM(BD30.KAIKEI_KEN_62) AS KAIKEI_KEN_62,
    SUM(BD30.KAIKEI_KIN_62) AS KAIKEI_KIN_62,
    SUM(BD30.KAIKEI_KEN_63) AS KAIKEI_KEN_63,
    SUM(BD30.KAIKEI_KIN_63) AS KAIKEI_KIN_63,
    SUM(BD30.KAIKEI_KEN_64) AS KAIKEI_KEN_64,
    SUM(BD30.KAIKEI_KIN_64) AS KAIKEI_KIN_64,
    SUM(BD30.KAIKEI_KEN_65) AS KAIKEI_KEN_65,
    SUM(BD30.KAIKEI_KIN_65) AS KAIKEI_KIN_65,
    SUM(BD30.KAIKEI_KEN_66) AS KAIKEI_KEN_66,
    SUM(BD30.KAIKEI_KIN_66) AS KAIKEI_KIN_66,
    SUM(BD30.KAIKEI_KEN_67) AS KAIKEI_KEN_67,
    SUM(BD30.KAIKEI_KIN_67) AS KAIKEI_KIN_67,
    SUM(BD30.KAIKEI_KEN_68) AS KAIKEI_KEN_68,
    SUM(BD30.KAIKEI_KIN_68) AS KAIKEI_KIN_68,
    SUM(BD30.KAIKEI_KEN_69) AS KAIKEI_KEN_69,
    SUM(BD30.KAIKEI_KIN_69) AS KAIKEI_KIN_69,
    SUM(BD30.KAIKEI_KEN_70) AS KAIKEI_KEN_70,
    SUM(BD30.KAIKEI_KIN_70) AS KAIKEI_KIN_70,
    SUM(BD30.KAIKEI_KEN_71) AS KAIKEI_KEN_71,
    SUM(BD30.KAIKEI_KIN_71) AS KAIKEI_KIN_71,
    SUM(BD30.KAIKEI_KEN_72) AS KAIKEI_KEN_72,
    SUM(BD30.KAIKEI_KIN_72) AS KAIKEI_KIN_72,
    SUM(BD30.KAIKEI_KEN_73) AS KAIKEI_KEN_73,
    SUM(BD30.KAIKEI_KIN_73) AS KAIKEI_KIN_73,
    SUM(BD30.KAIKEI_KEN_74) AS KAIKEI_KEN_74,
    SUM(BD30.KAIKEI_KIN_74) AS KAIKEI_KIN_74,
    SUM(BD30.KAIKEI_KEN_75) AS KAIKEI_KEN_75,
    SUM(BD30.KAIKEI_KIN_75) AS KAIKEI_KIN_75,
    SUM(BD30.KAIKEI_KEN_76) AS KAIKEI_KEN_76,
    SUM(BD30.KAIKEI_KIN_76) AS KAIKEI_KIN_76,
    SUM(BD30.KAIKEI_KEN_77) AS KAIKEI_KEN_77,
    SUM(BD30.KAIKEI_KIN_77) AS KAIKEI_KIN_77,
    SUM(BD30.KAIKEI_KEN_78) AS KAIKEI_KEN_78,
    SUM(BD30.KAIKEI_KIN_78) AS KAIKEI_KIN_78,
    SUM(BD30.KAIKEI_KEN_79) AS KAIKEI_KEN_79,
    SUM(BD30.KAIKEI_KIN_79) AS KAIKEI_KIN_79,
    SUM(BD30.KAIKEI_KEN_80) AS KAIKEI_KEN_80,
    SUM(BD30.KAIKEI_KIN_80) AS KAIKEI_KIN_80,
    SUM(BD30.KAIKEI_KEN_81) AS KAIKEI_KEN_81,
    SUM(BD30.KAIKEI_KIN_81) AS KAIKEI_KIN_81,
    SUM(BD30.KAIKEI_KEN_82) AS KAIKEI_KEN_82,
    SUM(BD30.KAIKEI_KIN_82) AS KAIKEI_KIN_82,
    SUM(BD30.KAIKEI_KEN_83) AS KAIKEI_KEN_83,
    SUM(BD30.KAIKEI_KIN_83) AS KAIKEI_KIN_83,
    SUM(BD30.KAIKEI_KEN_84) AS KAIKEI_KEN_84,
    SUM(BD30.KAIKEI_KIN_84) AS KAIKEI_KIN_84,
    SUM(BD30.KAIKEI_KEN_85) AS KAIKEI_KEN_85,
    SUM(BD30.KAIKEI_KIN_85) AS KAIKEI_KIN_85,
    SUM(BD30.KAIKEI_KEN_86) AS KAIKEI_KEN_86,
    SUM(BD30.KAIKEI_KIN_86) AS KAIKEI_KIN_86,
    SUM(BD30.KAIKEI_KEN_87) AS KAIKEI_KEN_87,
    SUM(BD30.KAIKEI_KIN_87) AS KAIKEI_KIN_87,
    SUM(BD30.KAIKEI_KEN_88) AS KAIKEI_KEN_88,
    SUM(BD30.KAIKEI_KIN_88) AS KAIKEI_KIN_88,
    SUM(BD30.KAIKEI_KEN_89) AS KAIKEI_KEN_89,
    SUM(BD30.KAIKEI_KIN_89) AS KAIKEI_KIN_89,
    SUM(BD30.KAIKEI_KEN_90) AS KAIKEI_KEN_90,
    SUM(BD30.KAIKEI_KIN_90) AS KAIKEI_KIN_90
FROM
BD30KKAD BD30,
BM01TENM BM01
WHERE
 BM01.COMPANY_CD = BD30.COMPANY_CD
AND BM01.MISE_CD = BD30.MISE_CD
AND BD30.COMPANY_CD = /*companyCd*/'00'
AND BD30.EIGYO_DT LIKE /*taishoYM*/'201209' || '%'
/*IF "01".equals(userType) && limitKbn*/
            AND EXISTS (
                      SELECT * FROM BM51SVSB AS BM51
                      WHERE BM51.SV_CD = /*userId*/'00000921'
                      AND BM51.SIBU_CD = BM01.SIBU_CD)
/*END*/
/*IF "02".equals(userType) */
    AND   EXISTS(SELECT * FROM BM06UONR BM06
                 WHERE BM06.USER_ID = /*userId*/'99990003'
                 AND   BM06.COMPANY_CD = BM01.COMPANY_CD
                 AND   BM06.ONER_CD    = BM01.ONER_CD)
/*END*/
/*IF "03".equals(userType) */
    AND   EXISTS(SELECT * FROM BM07UTEN BM07
                 WHERE BM07.USER_ID    = /*userId*/'99990003'
	             AND   BM07.COMPANY_CD = BM01.COMPANY_CD
	             AND   BM07.MISE_CD    = BM01.MISE_CD)
/*END*/
/*IF miseCd != null && miseCd.equals("") == false && miseCd.equals("99999") == false */
	AND BD30.MISE_CD = /*miseCd*/'00014'
/*END*/
GROUP BY ROLLUP (BD30.EIGYO_DT)
ORDER BY BD30.EIGYO_DT