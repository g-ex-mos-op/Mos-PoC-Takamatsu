SELECT BT11.INFO_SHU AS MOTO_INFO_SHU
,      BT11.REG_DATE AS MOTO_REG_DATE
,      BT11.SEQ AS MOTO_SEQ
,      BT11.REL_INFO_SHU AS INFO_SHU
,      BT11.REL_REG_DATE AS REG_DATE
,      BT11.REL_SEQ AS SEQ
,      BT020304.TITLE
,      BT020304.FILE_NAME

FROM (
	SELECT BT12.INFO_SHU
	,      BT12.REG_DATE
	,      BT12.SEQ

	FROM (
	   SELECT REG_DATE, SEQ
	   ,      '02' AS INFO_SHU
	   FROM BT02NTCM
	   WHERE SAKUJO_FLG <> '1'
	   AND   DATE(LAST_TMSP) = /*lastTmspDt*/'2009-10-01'

	) BT020304
    ,     BT12IACP as BT12
	,    BT13IASZ as BT13
	,    BT14IAGT as BT14
	LEFT JOIN BT15IAID as BT15
         on (BT14.INFO_SHU = BT15.INFO_SHU
          AND BT14.REG_DATE = BT15.REG_DATE
          AND BT14.SEQ = BT15.SEQ
          AND BT14.GYOTAI_KBN = BT15.GYOTAI_KBN
            )
	LEFT JOIN (
		   SELECT BT16.INFO_SHU
		   ,      BT16.REG_DATE
		   ,      BT16.SEQ
		   ,      BT16.GYOTAI_KBN
		   ,      BT16.MISE_CD
		   FROM BM01TENM BM01
	       ,    BM04GTCP BM04
		   ,    (SELECT * FROM BT16IAST
	             WHERE INFO_SHU ='02'
	             AND   DATE(LAST_TMSP) = /*lastTmspDt*/'2009-10-01'
	             ) BT16

	       WHERE BM04.COMPANY_CD = BM01.COMPANY_CD
	       AND   BM04.GYOTAI_KBN = BM01.MISE_GRP1
	       AND   BT16.GYOTAI_KBN = BM04.GYOTAI_KBN
	       AND   BT16.MISE_CD    = BM01.MISE_CD
       ) as BT16
         on (BT14.INFO_SHU = BT16.INFO_SHU
          AND BT14.REG_DATE = BT16.REG_DATE
          AND BT14.SEQ = BT16.SEQ
          AND BT14.GYOTAI_KBN = BT16.GYOTAI_KBN
            )
	WHERE BT12.INFO_SHU = BT020304.INFO_SHU
    AND   BT12.REG_DATE = BT020304.REG_DATE
    AND   BT12.SEQ      = BT020304.SEQ
	AND   BT13.INFO_SHU = BT12.INFO_SHU
    AND   BT13.REG_DATE = BT12.REG_DATE
    AND   BT13.SEQ      = BT12.SEQ
    AND   BT14.INFO_SHU = BT13.INFO_SHU
    AND   BT14.REG_DATE = BT13.REG_DATE
    AND   BT14.SEQ      = BT13.SEQ
	GROUP BY BT12.INFO_SHU
	,        BT12.REG_DATE
	,        BT12.SEQ
	) ACSS
,   (
	SELECT BT12.INFO_SHU
	,      BT12.REG_DATE
	,      BT12.SEQ

	FROM (SELECT REL_INFO_SHU, REL_REG_DATE, REL_SEQ
	      FROM BT11RLFL
	      WHERE INFO_SHU = '02'
	      ) BT11
	,     BT12IACP as BT12
	,    BT13IASZ as BT13
	,    BT14IAGT as BT14
	LEFT JOIN BT15IAID as BT15
         on (BT14.INFO_SHU = BT15.INFO_SHU
          AND BT14.REG_DATE = BT15.REG_DATE
          AND BT14.SEQ = BT15.SEQ
          AND BT14.GYOTAI_KBN = BT15.GYOTAI_KBN
            )
	LEFT JOIN (
		   SELECT BT16.INFO_SHU
		   ,      BT16.REG_DATE
		   ,      BT16.SEQ
		   ,      BT16.GYOTAI_KBN
		   ,      BT16.MISE_CD
		   FROM BM01TENM BM01
	       ,    BM04GTCP BM04
		   ,    BT16IAST BT16

	       WHERE BM04.COMPANY_CD = BM01.COMPANY_CD
	       AND   BM04.GYOTAI_KBN = BM01.MISE_GRP1
	       AND   BT16.GYOTAI_KBN = BM04.GYOTAI_KBN
	       AND   BT16.MISE_CD    = BM01.MISE_CD
       ) as BT16
         on (BT14.INFO_SHU = BT16.INFO_SHU
          AND BT14.REG_DATE = BT16.REG_DATE
          AND BT14.SEQ = BT16.SEQ
          AND BT14.GYOTAI_KBN = BT16.GYOTAI_KBN
       )
	WHERE BT12.INFO_SHU = BT11.REL_INFO_SHU
    AND   BT12.REG_DATE = BT11.REL_REG_DATE
    AND   BT12.SEQ      = BT11.REL_SEQ
	AND   BT13.INFO_SHU = BT12.INFO_SHU
    AND   BT13.REG_DATE = BT12.REG_DATE
    AND   BT13.SEQ      = BT12.SEQ
    AND   BT14.INFO_SHU = BT13.INFO_SHU
    AND   BT14.REG_DATE = BT13.REG_DATE
    AND   BT14.SEQ      = BT13.SEQ
	GROUP BY BT12.INFO_SHU
	,        BT12.REG_DATE
	,        BT12.SEQ
	) REL_ACSS
,  (
   SELECT '02' AS INFO_SHU, REG_DATE, SEQ, TITLE, FILE_NAME
   FROM BT02NTCM
   WHERE SAKUJO_FLG <> '1'
 UNION
   SELECT '03' AS INFO_SHU, REG_DATE, SEQ, TITLE, FILE_NAME
   FROM BT03DOCM
   WHERE SAKUJO_FLG <> '1'
 UNION
   SELECT '04' AS INFO_SHU, REG_DATE, SEQ, TITLE, FILE_NAME
   FROM BT04FRMM
   WHERE SAKUJO_FLG <> '1'
) BT020304
,     BT11RLFL BT11

WHERE BT11.INFO_SHU = '02'
AND   BT11.INFO_SHU = ACSS.INFO_SHU
AND   BT11.REG_DATE = ACSS.REG_DATE
AND   BT11.SEQ      = ACSS.SEQ
AND   BT020304.INFO_SHU = REL_ACSS.INFO_SHU
AND   BT020304.REG_DATE = REL_ACSS.REG_DATE
AND   BT020304.SEQ      = REL_ACSS.SEQ
AND   BT020304.INFO_SHU = BT11.REL_INFO_SHU
AND   BT020304.REG_DATE = BT11.REL_REG_DATE
AND   BT020304.SEQ      = BT11.REL_SEQ

GROUP BY BT11.INFO_SHU
,        BT11.REG_DATE
,        BT11.SEQ
,        BT11.REL_INFO_SHU
,        BT11.REL_REG_DATE
,        BT11.REL_SEQ
,        BT020304.TITLE
,        BT020304.FILE_NAME

ORDER BY BT11.REG_DATE
,     BT11.SEQ
,     BT11.INFO_SHU
,     BT11.REL_INFO_SHU
,     BT11.REL_REG_DATE
,     BT11.REL_SEQ