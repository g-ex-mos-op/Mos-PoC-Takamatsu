# DN-030106-001.04 画面設計書(データ提供)

## 概要

本文書は画面設計書であり、POS集信データ提供機能に関する画面設計の内容を記載しています。本文書には8個のシートが含まれています。

## 文書情報

| 項目 | 内容 |
|------|------|
| 管理番号 | DN-030106-001.04 |
| 分類 | 画面設計書 |
| 作成者 | 作成者：ISID 宮城<br>作成日：2006/11/20 |
| 作成日 | 作成者：ISID 宮城<br>作成日：2006/11/20 |
| 更新者 | レビュー/承認者 |
| 更新日 | 更新内容 |

## 更新履歴

| BIRD ドキュメント 更新履歴 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 | BIRD ドキュメント 更新履歴 |
| 作成・更新日 | 作成・更新日 | 作成・更新日 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 更新内容 | 作成・更新者 | 作成・更新者 | 作成・更新者 | レビュー/承認者 | レビュー/承認者 | レビュー/承認者 | レビュー/承認者 | レビュー/承認日 | レビュー/承認日 | レビュー/承認日 | レビュー/承認日 |
| 41324 |  |  | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | [v.03]要求仕様シート 更新履歴を追加。提供データ分割ダウンロード対応に伴う変更追加。 | 稲田 | 稲田 | 稲田 | 衣川 | 衣川 | 衣川 | 衣川 | 41334 | 41334 | 41334 | 41334 |
| 41334 |  |  | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | [v.04]アクション、画面構成 提供データ分割ダウンロード対応に伴う変更追加。 | 衣川 | 衣川 | 衣川 | 稲田 | 稲田 | 稲田 | 稲田 | 41337 | 41337 | 41337 | 41337 |

---

---

## 機能概要

| [BIRD] |  | 要求仕様書 |  |  |  |  |  |  |  |  |  |  | 管理番号：DN-030106-001.04<br>分類　　　：要求仕様書 |  |  |  |  | 更新者：<br>更新日： |  |  |  | 作成者：ISID 宮城<br>作成日：2006/11/20 |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| 画面名 |  |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |  |  |  | フィーチャ |  | データ分析 |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| 機能の目的 |  |  |  |  |  |  |  |  |  |  |  |  |  | 想定ユーザ |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| POSから集信されたデータをテキスト形式でダウンロードする。 |  |  |  |  |  |  |  |  |  |  |  |  |  | 加盟店オーナー様【データ提供申請者のみ】 |
| →オーナー様独自のシステムにデータを取込んで管理・分析等に用いることができる。 |  |  |  |  |  |  |  |  |  |  |  |  |  | 本部ユーザ様 |

| 機能の概要 |
|------|
| 指定した日付の集信データをテキスト形式でダウンロードする。 |

| ※ＰＯＳから集信された形式（テキスト形式）でダウンロードされる。 |
|------|

| 補足説明（用語説明、業務ルールなど） |
|------|
| 対象となる日付・・・・・・前月１日までさかのぼることが可能。 |
| データ保持期間内は何度でも集信可。 |
| ※営業日ベースでデータが格納される。（エラーによる再集信のものも該当営業日にセットされる） |

| ※PJ-050290-001.06 移植系画面統廃合検討.xls |  |  |
|------|------|------|
| ご要望 |  | 現行仕様を踏襲する。 |
| 備考 |  | 集信データについては、15種別対応のメニュー別売上（区分30）が追加になる。 |

---

## 既存画面

内容なし

---

## 画面レイアウト

| [BIRD] |  | 画面設計書 |  |  |  |  |  |  |  |  |  |  | 管理番号：DN-030106-001.01<br>分類　　　：要求仕様書 |  |  |  |  | 更新者：<br>更新日： |  |  |  | 作成者：ISID 宮城<br>作成日：2006/11/20 |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| 画面レイアウト |  |  |  | 画面ID |  | BDT01 |  | 画面名 |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| ビューID |  | BDT01V01 |  |  |  |  | ビュー名 |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |  |  | 備考 |
| JSF名 |  | posDataForm |  |  |  |  | CSS名 |  | body.css |  |  |  |  |  |  |  |  |  |  |  |  |  |

|  | ■POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | ※本部ユーザのとき |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | オーナー指定欄があります |
|  | ※前月１日まで遡って検索することができます。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  | データ保持期間内は何度でも集信できます。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  | オーナー | オーナー | オーナー |  |  |  | データ集信日 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

|  | 集信データレイアウト |  |  | [PDF] |
|------|------|------|------|------|

|  | ■POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | ※オーナーユーザのとき |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | オーナー指定欄はありません |
|  | ※前月１日まで遡って検索することができます。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  | データ保持期間内は何度でも集信できます。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
|  | データ集信日 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |

|  | 集信データレイアウト |  |  | [PDF] |
|------|------|------|------|------|

---

## 要求仕様

| [BIRD]　要求仕様書 |
|------|

| 画面名 |  | POS集信データ提供 |  |  |  |  | フィーチャ | データ分析 |
|------|------|------|------|------|------|------|------|------|
| NO | カテゴリ | 要求番号 | 仕様番号 | 優先 | 分類 | 内容 | 追加変更日 | 備考 |
| 1 | 条件の設定 | ＦRQ0101 |  | A | 要求 | 指定した日に集信されたデータをダウンロードしたい |  |  |
|  |  | ＦRQ0101 |  |  | 理由 | 必要なデータだけを取り込む必要があるため |  |  |
|  |  | ＦRQ0101 |  |  | 説明 |  |  |  |
|  |  | ＦRQ0101 | SP010101 | A | 仕様 | 条件部分には、「実行」ボタンと、データ集信日選択プルダウンを表示する。 |  |  |
|  |  | ＦRQ0101 | SP010102 | A | 仕様 | データ集信日選択プルダウンには、前月1日から本日（システム日付）までの日付を降順で表示する。 |  |  |
|  |  | ＦRQ0101 | SP010103 | A | 仕様 | データ集信日選択プルダウンの初期表示として、本日（システム日付）の日付を選択して表示する。 |  |  |
|  |  | ＦRQ0101 | SP010104 | A | 仕様 | 条件部分の上部に、「※前月１日まで遡って検索することができます。データ保持期間内は何度でも集信できます。  」という注意書きを表示する。 |  |  |
|  |  | ＦRQ0101 | SP010105 | A | 仕様 | 「実行」ボタン押下時、選択した日に集信されたデータが存在しない場合、注意書きの上部に「該当するデータが存在しません。」とメッセージを表示し、自画面を再表示する。このとき、データ集信日選択プルダウンは、「実行」ボタン押下前の選択状況を反映して表示する。 |  |  |
|  |  | ＦRQ0101 | SP010106 | A | 仕様 | 「実行」ボタン押下時、選択した日に集信されたデータが存在する場合、選択した日に集信されたデータファイルのダウンロードを開始する。 |  |  |
|  |  | ＦRQ0102 |  | A | 要求 | 本部ユーザも当機能を使えるようにしたい。 |  |  |
|  |  | ＦRQ0102 |  |  | 理由 | 本部からも、代行でダウンロードを行ったり、画面の確認を行う必要があるため。 |  |  |
|  |  | ＦRQ0102 |  |  | 説明 |  |  |  |
|  |  | ＦRQ0102 | SP010201 | A | 仕様 | 本部ユーザの場合、条件部にオーナー項目を設け、オーナーコードを指定できるようにする。 |  |  |
|  |  | ＦRQ0102 | SP010202 | A | 仕様 | （本部ユーザの場合）オーナー欄の「検索」ボタンを押下すると、オーナー検索フォーム（共通）に遷移し、検索フォームでオーナーを決定した時はそのオーナーの状態で条件画面に直接遷移する。。 |  |  |
|  |  |  | SP010203 | A | 仕様 | （本部ユーザの場合）オーナー入力欄が空欄であれば、「オーナーコードは必須です。」とメッセージを表示し、画面を再表示する。 | 2006/12/13<br>追加 | 設計時考慮もれ、他の画面と統一 |
|  |  |  | SP010203 | A | 仕様 | （本部ユーザの場合）オーナー入力欄に存在しないオーナーが入力されていた場合、「オーナーコードが存在しません。」とメッセージを表示し、画面を再表示する。また、オーナー入力欄にフォーカスをあてる | 2006/12/13<br>追加 | 設計時考慮もれ、他の画面と統一 |
|  |  | ＦRQ0103 |  | A | 要求 | 集信したデータのレイアウトをダウンロードできるようにしてほしい。なお、このときセキュリティを考慮してほしい。 |  |  |
|  |  | ＦRQ0103 |  |  | 理由 | 自社システムでデータを利用するために、ダウンロードできるデータのフォーマットが必要になるため。 |  |  |
|  |  | ＦRQ0103 |  |  | 説明 |  |  |  |
|  |  | ＦRQ0103 | SP010301 | A | 仕様 | 条件部分の下部に、「集信データレイアウト［PDF］」リンクを設ける |  |  |
|  |  | ＦRQ0103 | SP010302 | A | 仕様 | 「集信データレイアウト」リンクを押下すると、集信データのレイアウトファイルのダウンロード開始する。 |  | レイアウトのPDFファイルは全ユーザ共通のもの（固定）です。 |
|  |  | ＦRQ0103 | SP010303 | A | 仕様 | ダウンロードは、直接アドレス指定で行うのではなく、アクションを介して認証されたクライアントのみファイルをダウンロードできるようにする。 |  |  |
| 2 | データファイルの作成 | ＦRQ0201 |  | A | 要求 | ファイル内のデータのフォーマットを統一してほしい |  |  |
|  |  | ＦRQ0201 |  |  | 理由 | データファイルが、オーナーユーザの自社システムで利用されるため |  |  |
|  |  | ＦRQ0201 |  |  | 説明 | テーブルはBT51POSDを使用します。 |  |  |
|  |  | ＦRQ0201 | SP020101 | A | 仕様 | データファイルの名称は、"POS_REC.DAT""P4_REC.DAT"とする。 | 41324 | ファイル名が異なっていたため、修正 |
|  |  | ＦRQ0201 | SP020102 | A | 仕様 | データファイルでは、条件部で指定した日に作成された、オーナーの保有店舗の集信データを一行ごとに記述する。（1データごとに改行） |  |  |
|  |  |  | SP020103 | A | 仕様 | ファイルに記述する対象はデータ項目のみとする。 |  | データは""で囲まず、生のまま記述します。 |
|  |  | ＦRQ0201 | SP020104 | A | 仕様 | データのソート順は、作成日、店コード、データ区分、データNoとする。 |  |  |
|  |  | ＦRQ0201 | SP020105 | A | 仕様 | 一行に表示するデータが512バイトに満たなかった場合、512バイトになるように後ろに半角スペースを挿入したうえでファイルに記述する。<br>→全行が512バイトになるようにする。 |  |  |
|  |  | ＦRQ0202 |  | A | 要求 | 特定のオーナーコード（※１）を指定して、実行した場合、支部ごとに分割されたDATファイルをZIPファイルに圧縮して、ダウンロードできるようにしたい。<br>※分割対象オーナーはDBに保持し、追加可能なようにする。 | 41324 |  |
|  |  | ＦRQ0202 |  |  | 理由 | 2013/1の販社統合により、1社あたりのファイル容量が大きくなり、販社側で別システムに取り込むことができなくなったため、分割したい。 | 41324 |  |
|  |  | ＦRQ0202 |  |  | 説明 | 2013/1の販社統合により、統合されたモスストアカンパニー（オーナーコード：37006）は3つの支社にまたがっており、支社は支部で管理されている【例】支部コード：076 北日本支社 | 41324 |  |
|  |  | ＦRQ0202 | SP010401 | A | 仕様 | 分割対象のオーナーが指定された場合は、支部ごとに分割したDATファイルをZIPファイルに圧縮したファイルをダウンロードできるようにする。<br>1)所属する支部ごとにDATファイルを作成する（DATファイルの仕様はＦRQ0201の通り）。<br>　DATファイル名：｛支部名称｝_P4_REC.DAT<br>3)1)を1つのZIPファイルに圧縮する。<br>  ZIPファイル名：P4_REC.ZIP | 41324 |  |

---

## 画面構成

| [BIRD] |  | 画面設計書 |  |  |  |  |  |  |  |  |  |  | 管理番号：DN-030106-001.01<br>分類　　　：要求仕様書 |  |  |  |  | 更新者：ASPAC 衣川<br>更新日：2013/03/01 |  |  |  | 作成者：ISID 宮城<br>作成日：2006/11/20 |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| 画面構成 |  |  |  | 画面ID |  | BDT001 |  | 画面名 |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 機能概要 |  |  | ＰＯＳ集計データのダウンロードを行う。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 構成概要 |  |  |
| パッケージルート |  |  | jp.co.isid.mos.bird.analysis.posdata |  |  |  |  |  |  |  |  |  | 画面タイプ |  | 検索エンジン型 |  |  | テーブル |  | テーブル名（テーブルID） |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  | ＰＯＳ集信データ　（BT51POSD） |
|  |  | view |  |  |  | action |  |  |  | logic |  |  |  |  | dao |  |  | テーブル |  | 店統合マスタ　（BM01TENM） |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  | ZIP対象オーナー(BC36ZIPO) |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  | 支部マスタ(BM10GSIB) |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  |  |
|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | テーブル |  |  |

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | 2013/03/01 Zipダウンロード機能追加 |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

---

## アクション

| [BIRD] |  | 画面設計書 |  |  |  |  |  |  |  |  |  |  | 管理番号：DN-030106-001.04<br>分類　　　：要求仕様書 |  |  |  |  | 更新者：ASPAC 衣川<br>更新日：2013/03/01 |  |  |  | 作成者：ISID 宮城<br>作成日：2006/11/20 |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| アクション |  |  |  | 画面ID |  | BDT001 |  | 画面名 |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| ビュー名 |  | ＰＯＳ集信データ提供画面 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| アクションID |  | BDT001A01 |  |  | アクション名 |  | 初期処理 |  |  |  |  |  |  |  |  |  | 遷移先ビュー |  |  | 呼出し元（null） |
| 事前条件 |  |  |  |  |  |  |  |  | 処理概要 |  |  |  |  |  |  |  |  |  |  |  |
| ログインユーザが【ＰＯＳ集信データ提供】機能のアクセス権限を持っていること |  |  |  |  |  |  |  |  | １．セッションから、ログインユーザ関連情報と日付関連情報を取得する。 |  |  |  |  |  |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  | ２．データ集信日リストを作成する。 |
|------|------|------|------|------|------|------|------|------|------|

|  |  |  |  |  |  |  |  |  | ３．取得した情報を条件部DTOに設定する |
|------|------|------|------|------|------|------|------|------|------|

|  |  |  |  |  |  |  |  |  | ４．オーナー検索画面から戻った場合 |  |
|------|------|------|------|------|------|------|------|------|------|------|
| 事後条件 |  |  |  |  |  |  |  |  |  | オーナー検索画面で選択したオーナーコードをセットする。 |
| 自画面へ遷移する。 |  |  |  |  |  |  |  |  |  |  |

| アクションID |  | BDT001A02 |  |  | アクション名 |  | 集信データ取得 |  |  |  |  |  |  |  |  |  | 遷移先ビュー |  |  | 呼出し元（null） |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 事前条件 |  |  |  |  |  |  |  |  | 処理概要 |  |  |  |  |  |  |  |  |  |  |  |
| ＰＯＳ集信データ提供画面が正しく表示されていること |  |  |  |  |  |  |  |  | １．画面で入力されたオーナーコード、データ集信日を取得する |  |  |  |  |  |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  | 1-1.LOGIC【Zip対象オーナーチェック】を実行し、戻り値がtrueの場合は下記の処理を行います。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | <-- 2013/03/01 ADD xkinu |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  |  |  |  |  |  |  |  | パラメータ： | DTO【Sesshon情報】.オーナーコード |  |  |  |  |  |  |  |  |  |  |  |  |  |  | <-- 2013/03/01 ADD xkinu |
|  |  |  |  |  |  |  |  |  |  | 1.zipダウンロード処理を実行します。 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | <-- 2013/03/01 ADD xkinu |
|  |  |  |  |  |  |  |  |  |  | 2.リターンします。(処理終了) |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | <-- 2013/03/01 ADD xkinu |

|  |  |  |  |  |  |  |  |  | ２．ロジック【ＰＯＳ集信データの取得】を実行する |  |
|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  |  |  |  |  |  |  |  | パラメータ：オーナーコード　／　データ集信日　／　会社コード |

|  |  |  |  |  |  |  |  |  | ３．検索結果のＤＡＴＡをファイル出力する。 |
|------|------|------|------|------|------|------|------|------|------|


### 事後条件

| 事後条件 |  |  |  |  |  |  |  |  |  | ファイル名： |  | POS_REC.DAT |
|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 正常終了時及びエラー時は、自画面へ遷移する。 |  |  |  |  |  |  |  |  |  |  |  |  |

| アクションID |  | BDT001A03 |  |  | アクション名 |  | オーナー検索 |  |  |  |  |  |  |  |  |  | 遷移先ビュー |  |  | 呼出し元（null） |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 事前条件 |  |  |  |  |  |  |  |  | 処理概要 |  |  |  |  |  |  |  |  |  |  |  |
| ＰＯＳ集信データ提供画面が正しく表示されていること |  |  |  |  |  |  |  |  | １．オーナー情報DＴＯを初期化する。 |  |  |  |  |  |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  | ２．オーナー情報DＴＯに会社コードをセットする。 |
|------|------|------|------|------|------|------|------|------|------|

|  |  |  |  |  |  |  |  |  | ３．オーナー検索画面へ遷移する。 |
|------|------|------|------|------|------|------|------|------|------|


### 事後条件

| 事後条件 |
|------|
| 正常終了時及びエラー時は、自画面へ遷移する。 |

| アクションID |  | BDT001A04 |  |  | アクション名 |  | PDFダウンロード |  |  |  |  |  |  |  |  |  | 遷移先ビュー |  |  | 呼出し元（null） |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 事前条件 |  |  |  |  |  |  |  |  | 処理概要 |  |  |  |  |  |  |  |  |  |  |  |
| ＰＯＳ集信データ提供画面が正しく表示されていること |  |  |  |  |  |  |  |  | １．PDFファイル情報をセットする。 |  |  |  |  |  |  |  |  |  |  |  |

|  |  |  |  |  |  |  |  |  |  | ファイル名： |  | P5集信ファイルレイアウト.pdf |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  |  |  |  |  |  |  |  | パス： |  | C:\\eclipse3.1\\data\\file\\bunsho　（共通クラスから取得） |  |
|  |  |  |  |  |  |  |  |  |  | コンテキストタイプ： |  |  | application/pdf |

|  |  |  |  |  |  |  |  |  | ２．PDFファイルのダウンロードを行う。 |
|------|------|------|------|------|------|------|------|------|------|
| 事後条件 |  |  |  |  |  |  |  |  |  |
| 正常終了時及びエラー時は、自画面へ遷移する。 |  |  |  |  |  |  |  |  |  |

| メソッド定義 | ZIPファイルダウンロード処理 |  |  |  |  |  |  |  |  |  |  |  |  | 修飾子 | private |  |  | 戻り値 | void |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| 引数 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 項目名 |  |  |  |  |  | データタイプ |  |  |  | 内容 |  |  |  |  |  |  |  |  |  |  |  |  |  | 必須 | 初期値 |
|  |  |  |  |  |  | 無し |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  | ○ |  |


### リターン

| リターン |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|
| 名称 |  |  |  |  |  | データタイプ |  |  |  | 内容 |
|  |  |  |  |  |  | void |  |  |  |  |

| １．ContentTypeへLOGIC【Zip用データ取得】.コンテントタイプ取得の戻り値を設定します。 |
|------|

| ２．LOGIC【Zip用データ取得】.ファイル名をエンコードした値を取得し、その名称をHttpServletResponseのヘッダーへ設定します。 |  |  |  |  |  |  |
|------|------|------|------|------|------|------|
|  | エンコード："Windows-31j" |  |  |  |  | charasetName:"ISO8859_1" |

| ３．LOGIC【Zip用データ取得】.実行を行い、戻り値List[[支部別出力データ]]を取得します。 |  |  |
|------|------|------|
|  | パラメータ： | DTO【Sesshon情報】.オーナーコード |

| ４．Zipファイルのダウンロード処理を行います。 |  |
|------|------|
|  | 1.ダウンロードされるZipファイルへ処理３のList[[支部別出力データ]]から支部別のDATファイルを圧縮します。 |

|  |  | 注意： | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 |  |  |  |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
|  |  |  | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 |
|  |  |  | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 | ファイル名に日本語を使用する可能性が有るので、<br>java.util.zip.ZipInputStreamではなく、org.apache.tools.zip.ZipOutputStreamを使用します。 |

| ５．処理４でIOExceptionが発生した場合、下記のExceptionを発生させます。 |  |  |  |
|------|------|------|------|
|  |  | Exception： | MSG【F0101】("zipファイル作成中", "", 発生したIOException); |

| ６．処理終了 |
|------|

---

## コンポーネント一覧

| [BIRD] |  | 画面設計書 |  |  |  |  |  |  |  |  |  |  | 管理番号：DN-030106-001.01<br>分類　　　：要求仕様書 |  |  |  |  | 更新者：<br>更新日： |  |  |  | 作成者：ISID 宮城<br>作成日：2006/11/20 |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|

| コンポーネント一覧 |  |  |  | 画面ID |  | BDT001 |  | 画面名 |  | POS集信データ提供 |  |  |  |  |  |  |  |  |  |
|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|------|
| ビュー名 |  | ＰＯＳ集信データ提供画面 |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| 項目名 |  |  | 編集 | 表示 | データタイプ |  | 桁数 | コントロール |  | 初期値 |  |  | 必須 | 対応プロパティ・アクション |  |  |  |  | 備考 |
| 条件エリア |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| オーナー |  |  | ○ | ○ | 文字列 |  |  | テキスト |  |  |  |  | ○ | ＰＯＳ集信データ提供DTO.オーナーコード |  |  |  |  | オーナーの時は表示無し |
| 検索 |  |  | × | ○ |  |  |  | ボタン |  |  |  |  | ○ | アクション【オーナー検索】を実行 |  |  |  |  |  |
| データ集信日 |  |  | ○ | ○ | 文字列 |  |  | プルダウン |  | リストの先頭値 |  |  | ○ | ＰＯＳ集信データ提供DTO.データ集信日 |  |  |  |  |  |
| 実行 |  |  | × | ○ |  |  |  | ボタン |  |  |  |  | ○ | アクション【集信データ取得】を実行 |  |  |  |  |  |
| ＰＤＦリンク |  |  | × | ○ |  |  |  | ボタン |  |  |  |  | ○ | アクション【ＰＤＦダウンロード】を実行 |  |  |  |  |  |


---

## 読み取りが難しかった項目

- .xls形式のため、画像・図形の抽出ができませんでした。元のExcelファイルを参照してください。

- 結合セルのレイアウトが完全に再現できなかった箇所がある可能性があります。

- 複雑なレイアウトの表は、元のExcelファイルと照合して確認してください。


## 不明点・不明瞭な点

- 空欄になっている項目については、意図的な省略か記載漏れか確認が必要です。

- 用語や略語の意味が不明確な箇所は、関連ドキュメントを参照してください。
