<html xmlns:m="http://www.seasar.org/maya" m:action="#{loginAction.loginInit}">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<meta http-equiv="Content-Style-Type" content="text/css">
		<meta http-equiv="Pragma" content="no-cache">
		<meta http-equiv="Expires" content="-1">
		<meta name="robots" content="noindex">
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/trident/body.css?#{loginAction.requestTime}"/>
<link rel="stylesheet" type="text/css" href="#{request.contextPath}/css/trident/main.css?#{loginAction.requestTime}"/>
<script type="text/javascript" src="#{request.contextPath}/js/bird.js"></script>
<title>ログイン</title>
<style type = "text/css">
<!--
html, body {
  font-family           : ＭＳ Ｐゴシック;
}
.text_field{
		width:142px;
		height:22px;
	}
/* 選択されたタブの表示設定 */
.visible_msg, .visible_info {
	display			   : inline;
}
/* 選択されていないタブの表示設定 */
.invisible_msg, .invisible_info{
	display			   : none;
}

.msgHidden{
    display:none;
}
-->
</style>
<script type="text/javascript">
<!--
var an = navigator.appName;
var av = navigator.appVersion;
var ua = window.navigator.userAgent;
var appMinorVersion = navigator.appMinorVersion;
var endorseVersion = ["MSIE 7.", "MSIE 8.", "MSIE 9."];
var versionUp = ["MSIE 5.", "MSIE 6."];
var userVersion = null;
var ieCheck = false;
var isVersionUp = false;
function getOs() {
	var os = "N/A";
	if (ua.match(/Win(dows )?NT 6\.2/)) {
		os = "Windows 8";				// Windows 8 の処理
	}
	else if (ua.match(/Win(dows )?NT 6\.1/)) {
		os = "Windows 7";				// Windows 7 の処理
	}
	else if (ua.match(/Win(dows )?NT 6\.0/)) {
		os = "Windows Vista";				// Windows Vista の処理
	}
	else if (ua.match(/Win(dows )?NT 5\.2/)) {
		os = "Windows Server 2003";			// Windows Server 2003 の処理
	}
	else if (ua.match(/Win(dows )?(NT 5\.1|XP)/)) {
		os = "Windows XP";				// Windows XP の処理
	}
	else if (ua.match(/Win(dows)? (9x 4\.90|ME)/)) {
		os = "Windows ME";				// Windows ME の処理
	}
	else if (ua.match(/Win(dows )?(NT 5\.0|2000)/)) {
		os = "Windows 2000";				// Windows 2000 の処理
	}
	else if (ua.match(/Win(dows )?98/)) {
		os = "Windows 98";				// Windows 98 の処理
	}
	else if (ua.match(/Win(dows )?NT( 4\.0)?/)) {
		os = "Windows NT";				// Windows NT の処理
	}
	else if (ua.match(/Win(dows )?95/)) {
		os = "Windows 95";				// Windows 95 の処理
	}
	else if (ua.match(/Mac|PPC/)) {
		os = "Mac OS";					// Macintosh の処理
	}
	else if (ua.match(/Linux/)) {
		os = "Linux";					// Linux の処理
	}
	else if (ua.match(/(Free|Net|Open)BSD/)) {
		os = RegExp.$1 + "BSD";				// BSD 系の処理
	}
	else if (ua.match(/SunOS/)) {
		os = "Solaris";					// Solaris の処理
	}
	else {
		os = "N/A";					// 上記以外 OS の処理
	}
	return os;
}
/**
 * 推奨ブラウザバージョンチェック
 */
function checkBrowserVersion() {
    document.getElementById('login:win8msg').className="invisible_msg";

    //OSバージョン取得(Windouws8+IE10の場合、互換設定サイトに誘導）
	var os = getOs();
    if("Windows 8"==os){
        document.getElementById('login:win8msg').className = "visible_msg";
    	if (av.indexOf("MSIE 10.", 0) >= 0) {
	    	var msg = document.msgForm.msgIEVersion1.value;
	    	    msg = msg+ "<br/>" +document.msgForm.msgIEVersion2.value;
	    	    msg = msg+ "<br/>" +document.msgForm.msgIEOverVersion1.value;
	    	    msg = msg+ "<br/>" +document.msgForm.msgIEOverVersion2.value;
			//ブラウザチェックインフォメーション表示
			dispInfo(msg, document.urlForm.win8Url.value);
			return;
    	}
	    document.login.elements["login:userId"].focus();
		return;
    }
	//IE上位バージョンの場合
    if (av.indexOf("MSIE 10.", 0) >= 0) {
	   	var msg = document.msgForm.msgIEVersion1.value;
	   	    msg = msg+ "<br/>" +document.msgForm.msgIEVersion2.value;
    	    msg = msg+ "<br/>" +document.msgForm.msgIEOverVersion1.value;
    	    msg = msg+ "<br/>" +document.msgForm.msgIEOverVersion2.value;
		//ブラウザチェックインフォメーション表示
		dispInfo(msg, document.urlForm.infomationUrl.value);
		return;
    }
	if(appMinorVersion){
		for(i=0; i<endorseVersion.length; i++) {
			ieCheck = ( av.indexOf(endorseVersion[i],0) != -1 );
			if ( ieCheck ) {
			    userVersion = endorseVersion[i];
				if ( "MSIE 6."==endorseVersion[i] ) {
					ieCheck = (appMinorVersion.indexOf("SP",0) != -1 );
				}
				break;
			}
		}
	}
	// チェック対象の場合
	if ( !ieCheck ) {
		for (i=0; i<versionUp.length; i++) {
			if(av.indexOf(versionUp[i], 0) >= 0) {
			    isVersionUp = true;
			    break;
			}
		}
		if (isVersionUp) {
            var ua = window.navigator.userAgent;
		    //IE6の場合
			if ( av.indexOf("MSIE 6.") >=0 ) {
			    //OS　WindowsME・Windows2000・WindowsMe
			    if (os.indexOf("ME") >=0  || os.indexOf("2000") >=0 ) {
			    	var msg = document.msgForm.msgOs1_1.value;
			    	    msg = msg+ "\n" +document.msgForm.msgOs1_2.value;
					alert(msg);
			    }
			    else if (ua.indexOf("SV1") == -1) {
			        //Windows XP Service Pack 2インストール推奨メッセージ
			    	var msg = document.msgForm.msgIEVersion1.value+document.msgForm.msgIEVersion2.value;;
			    	    msg = msg+ "\n" +document.msgForm.msgSp1_2.value;
					if(confirm(msg)) {
						document.sp2Form.submit();
					}
			    }
			    else {
			    	//Internet Explorer7のインストール推奨メッセージ
			    	var msg = document.msgForm.msgIEVersion1.value+document.msgForm.msgIEVersion2.value;;
			    	    msg = msg+ "\n" +document.msgForm.msgVersionUp2.value;
					if(confirm(msg)) {
						document.browserUpdateForm.submit();
					}
				}
				return;
			}
			else {
		    	var msg = document.msgForm.msgOs1_1.value;
		    	    msg = msg+ "\n" +document.msgForm.msgOs1_2.value;
				alert(msg);
				return;
			}
		}// end of if (isVersionUp)
		alert(document.login.elements["login:browserCheckMsg"].value);
	}//end of if ( !ieCheck )

	//ユーザーIDへフォーカス
    document.login.elements["login:userId"].focus();
}
function clearForm(formobj) {
    for (i = 0; i < formobj.elements.length; i++) {
        if (formobj.elements[i].type == "text" || formobj.elements[i].type == "password") {
            formobj.elements[i].value = "";
        }
    }
    document.login.elements["login:userId"].focus();
}
function winopen( url ) {
  if (an.indexOf("Microsoft",0) != -1 && av.indexOf("4",0) != -1) {
    newwin1 = window.open(url,"MOUSEDLG","toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=no,resizable=no,width=550,height=250");
  } else {
    if(an.indexOf("Netscape",0) != -1 && av.indexOf("4",0) != -1) {
      newwin1 = window.open(url,"MOUSEDLG","toolbar=no,location=no,directories=no,status,menubar=no,scrollbars=no,resizable=no,width=550,height=250");
    } else {
    	newwin1 = window.open(url,"MOUSEDLG","toolbar=no,location=no,directories=no,status,menubar=no,scrollbars=no,resizable=no,width=550,height=300");
    }
  }
}
/**
 * onLoad処理
 */
function load(){
	var inHtml = document.getElementById("errormsg").innerHTML;
	inHtml = inHtml.replace("<ul>","</br>").replace("</ul>","");
	var newNode = document.createElement("DIV");
	newNode.innerHTML  = inHtml;
	var oldNode = document.getElementById("errormsg");
	oldNode.parentNode.replaceChild(newNode,oldNode);
	//ユーザーIDへフォーカス
	document.login.elements["login:userId"].focus();
	if(inHtml.indexOf("<ul>", 0) < 0 && inHtml.indexOf("<UL>", 0)) {
		//以下の推奨バージョンかブラウザバージョンチェックを行います。
		//checkBrowserVersion();
		return;
	}
	return;
}
/**
  * ブラウザチェックインフォメーション表示
  * ポップアップブロック対応 ADD 2013/04/25
  */
function dispInfo(message, callUrl) {
	document.getElementById("confirmMsg").innerHTML = message;
	document.callForm.elements['callForm:callSiteUrl'].value=callUrl;
	document.login.elements["login:userId"].blur();
	document.login.elements["login:password"].blur();
	document.getElementById("login_area").className = "invisible_info";
	document.getElementById("info_area").className = "visible_info";
	document.callForm.obt.focus();

}
/**
  * ブラウザチェックインフォメーション閉じる
  * ポップアップブロック対応 ADD 2013/04/25
  */
function closeInfo() {
	document.getElementById("login_area").className = "visible_info";
	document.getElementById("info_area").className = "invisible_info";
	document.background = "";
}
/**
  * 外部サイト呼出し
  * ポップアップブロック対応 ADD 2013/04/25
  */
function callSite() {
	document.callForm.elements['callForm:__link_clicked__'].value='callForm:callSite';
	document.callForm.target="_blank";
	document.callForm.submit();
	closeInfo();
	return false;

}

//-->
</script>
</head>

<body onLoad="load();">
<span m:inject="f:param" m:name="layoutTitle" m:value="Home"/>
<span m:inject="f:param" m:name="pageKeyVal" m:value="login"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BPO000V01"/>

<img style="margin:10px" m:inject="h:graphicImage" m:url="/images/bird.gif"/>
<div align="center">
	<img m:inject="h:graphicImage" m:url="/images/login.gif"/>
	<table width="300" cellspacing="0" cellpadding="0" style="margin-top:8px;">
	  <tr><td class="body_caption">■ログイン</td></tr>
	</table>
	<div id="errormsg" align="center" valign="middle" style="line-height:18px;" class = "msgHidden">
	  <font color=red><b><span m:inject="h:messages" m:globalOnly="false" m:showDetail="false"/></b></font>
	  <font color=red><b><span m:converter="#{characterEncodingConverter}" m:inject="h:outputText" m:value="#{loginDto.msgSessionError}" escape="false"/></b></font>
	</div>
	<form id="login">
	<input type="hidden" m:id="browserCheckMsg" m:value="#{loginAction.browserCheckMsg}" m:passthrough="true"/>
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="hidden" m:id="pageKey" m:value="#{pageKeyVal}" />
	<!--span m:value="#{layoutTitle}"/-->
	<div id="login_area">
	<table class="body_table" width="300"  style="margin-top:18px;margin-bottom:45px;">
	  <tr>
	    <th class="body_header1">ユーザーID</th>
	    <td class="body_field">
	    	<input class="imenotuse text_field" m:id="userId" type="text" m:maxlength="8" m:value="#{loginDto.userId}">
	    		<span m:inject="s:validator" m:binding="#{hankakuEisujiValidator}" />
	    	</input>
	    </td>
	  </tr>
	  <tr>
	    <th class="body_header1">パスワード</th>
	    <td class="body_field">
	    	<input class="imenotuse text_field" m:id="password" type="password" m:maxlength="10" m:value="#{loginDto.userPswd}"/>
	    </td>
	  </tr>
	</table>
	<p/>
	<p/>
	<input type="submit" value="ログイン" m:action="#{loginAction.login}"/>
	&nbsp;
	<input type="button" value="リセット" onclick="clearForm(this.form);"/>
	&nbsp;
	<input type="button" VALUE="マウスで入力" onClick="winopen('#{request.contextPath}/jsf/portal/login/mouseLoginDlg.html')"/>
	&nbsp;
	<input type="button" value="パスワード変更" m:action="#{loginAction.changePassword}"/><br/>
	<div id="win8msg" class="invisible_msg" style="width:345px;margin-top:30px;font-size:11pt;text-align  : left;"  m:passthrough="true">
	Windows８にてe-mosslesを閲覧される場合は、<br/>「デスクトップ」モードへの切り替えをお願いいたします。
	</div>
	</div>
	</form>

	<!--ポップアップブロック対応 ADD 2013/04/25 START-->
	<style type = "text/css">
	<!--
	.info_btn {
		width:90px;
		height:30px;
		margin-right:20px
	}
	.info_message_area {
		width:380px;font-size:15px;
		margin-top:15px;
		margin-left:75px;
		font-family: 'MS UI Gothic',sans-serif;
		line-height:23px;
	}
	.batsu_btn {
		margin-right:8px;
		filter:xray();
	}
	-->
	</style>
	<table id="info_area" width="496px" height="268px" background="#{request.contextPath}/images/loginimg_ie10.png?#{loginAction.requestTime}" class="invisible_info" style="margin-top:18px;">
		<tr style="height:35px;"><td>&nbsp;</td></tr>
		<tr style="height:25px;" align="right">
			<td><input type="image" class="batsu_btn"
			    src="#{request.contextPath}/images/batsu_onblur.png?#{loginAction.requestTime}" alt="閉じる" title="閉じる" onclick="closeInfo();document.login.elements['login:userId'].focus();"/></td></tr>
		<tr style="height:135px;" valign="top">
			<!--メッセージ-->
			<td><div id="confirmMsg" class="info_message_area"/></td></tr>
		<tr style="height:55px;">
			<td valign="middle" align="right">
			<input type="button" id="obt" value="OK" onClick="callSite();return false;" ondblclick="return false;" class="info_btn"/>
			<input type="button" value="キャンセル" onclick="closeInfo();document.login.elements['login:userId'].focus();" class="info_btn"/>
			</td>
		</tr>
		<tr style="height:*;"></tr>
	</table>
	<form id="callForm">
		<input type="hidden" id="callSiteUrl" m:value="#{loginAction.callSiteUrl}"/>
		<a id="callSite" m:action="#{loginAction.callSite}"/>
		<input type="text" m:id="dummyText" m:style="display:none;"/>
	</form>
	<!--ポップアップブロック対応 ADD 2013/04/25 END -->
</div><!--<div align="center"> -->
</body>
</html>
