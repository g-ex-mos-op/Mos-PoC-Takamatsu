<html xmlns:m="http://www.seasar.org/maya" m:action="#{ownerSearchAction.initialize}" m:extends="/jsf/layout/layout.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title></title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="オーナー選択"/>
<span m:inject="s:insert" m:name="bodyTitleName">■オーナー選択</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="s:insert" m:name="naviarea" m:src="/jsf/commonform/ownersearch/ownerSearchFormNavi.html"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCO006V01"/>
<span m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
	.body_table2, body_table {
		width:770px;
	}
	.scroll_area {
		width:789px;
		height:310px;
	}
-->
</style>
<SCRIPT LANGUAGE="javascript">
<!--

function loadSibuList(){
    //支部選択
	document.forms['ownerSearch'].elements['ownerSearch:__link_clicked__'].value='ownerSearch:loadSibuList';
	document.forms['ownerSearch'].submit();
	return false;
}

function selectOwner(index){
    //オーナー決定
	document.forms['ownerSearch'].elements['ownerSearch:index'].value=index;
	document.forms['ownerSearch'].elements['ownerSearch:__link_clicked__'].value='ownerSearch:selectOwner';
	document.forms['ownerSearch'].submit();
	return false;
}

function clearForm(formobj) {
    for (i = 0; i < formobj.elements.length; i++) {
        if (formobj.elements[i].type == "text") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "textarea") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "file") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "password") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "checkbox") {
            formobj.elements[i].checked = formobj.elements[i].defaultChecked;
            formobj.elements[i].checked = false;
        } else if (formobj.elements[i].type == "radio") {
            formobj.elements[i].checked = formobj.elements[i].defaultChecked;
        } else if (formobj.elements[i].type == "select-one") {
            for (j = 0; j < formobj.elements[i].options.length; j++) {
                formobj.elements[i].options[j].selected = formobj.elements[i].options[j].defaultSelected;
            }
            formobj.elements[i].selectedIndex = -1;
            formobj.elements[i].selectedIndex = 0;
        } else if (formobj.elements[i].type == "select-multiple") {
            for (j = 0; j < formobj.elements[i].options.length; j++) {
                formobj.elements[i].options[j].selected = formobj.elements[i].options[j].defaultSelected;
            }
            formobj.elements[i].selectedIndex = -1;
        }
    }
}

function checkInfo() {

	var endNum,sortNum;
	var endFlg,sortFlg;

	endNum = document.ownerSearch.end.length;
	sortNum = document.ownerSearch.sort.length;

	for(i = 0; i < endNum; i++ ) {
		endFlg = document.ownerSearch.end[i].checked;
		if( endFlg ) {
			document.ownerSearch.elements['ownerSearch:inEnd'].value = document.ownerSearch.end[i].value;
			break;
		}
	}

	for( i = 0; i < sortNum; i++ ) {
		sortFlg = document.ownerSearch.sort[i].checked;
		if( sortFlg ) {
			document.ownerSearch.elements['ownerSearch:sortSeq'].value = document.ownerSearch.sort[i].value;
			break;
		}
	}

}

function bodyLoad() {
	var endNum,sortNum;
	var endVal,sortVal;

	endNum = document.ownerSearch.end.length;
	sortNum = document.ownerSearch.sort.length;

	for( i = 0; i < endNum; i++ ) {
		closeVal = document.ownerSearch.elements['ownerSearch:inEnd'].value;
		if ( closeVal == document.ownerSearch.end[i].value ) {
			document.ownerSearch.end[i].checked = true;
			break;
		}
	}

	for( i = 0; i < sortNum; i++ ) {
		sortVal = document.ownerSearch.elements['ownerSearch:sortSeq'].value;
		if ( sortVal == document.ownerSearch.sort[i].value ) {
			document.ownerSearch.sort[i].checked = true;
			break;
		}
	}

	naviLoad();
}
//-->
</SCRIPT>
<form m:id="ownerSearch">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>

<input type="hidden" m:value="#{ownerSearchConditionDto.windowId}"/>
<input type="hidden" m:id="inEnd"   name="inEnd"   m:value="#{recentConditionDto.inEnd}"/>
<input type="hidden" m:id="sortSeq" name="sortSeq" m:value="#{recentConditionDto.sortSeq}"/>
<input type="hidden" m:value="#{recentConditionDto.resultDispSize}"/>

<a id="selectOwner" m:action="#{ownerSearchAction.select}"/>
<input type="hidden" m:id="index" m:value="#{ownerSearchAction.index}"/>

<div class="operation_pane">
<input type="submit" value="検索"   m:action="#{ownerSearchAction.search}" onclick="checkInfo();"/>&nbsp;&nbsp;
<input type="submit" value="戻る"   m:action="#{ownerSearchAction.cancel}"/>&nbsp;&nbsp;
<input type="button" value="クリア" onclick="clearForm(this.form);"/>&nbsp;&nbsp;
</div>

<table class="body_table" style="margin-top:5px;">
  <tr>
    <th width="115px">会社</th>
    <td width="265px">
      <div class="hideArea">
        <select m:id="companyCd"
                m:value="#{recentConditionDto.kaisyaCd}"
                m:items="#{ownerSearchConditionDto.companyList}"
                m:itemValue="companyCd"
                m:itemLabel="companyName"
                m:onChange="loadSibuList()">
            <option value="">選択</option>
            <option value="">MOS</option>
        </select>
      </div>
	<a id="loadSibuList" m:action="#{ownerSearchAction.loadSibuList}"/>
    </td>
    <th width="100px">
      支部
    </th>
    <td width="285px">
      <div class="hideArea">
        <select m:value="#{recentConditionDto.sibuCd}"
                m:items="#{ownerSearchConditionDto.sibuList}"
                m:itemValue="sibuCd"
                m:itemLabel="sibuName"
                m:nullLabel=" ">
            <option value=""> </option>
            <option value="">MOS</option>
        </select>
      </div>
    </td>
  </tr>
  <tr>
    <th>オーナーコード</th>
    <td>
      <input type="text" m:id="onerCd" m:value="#{recentConditionDto.onerCd}" m:converter="#{codeConverterOwner}" m:size="10" m:maxlength="5" style="ime-mode:disabled"/>
    </td>
    <th>保有店コード</th>
    <td>
      <input type="text" m:id="miseCd" m:value="#{recentConditionDto.miseCd}" m:converter="#{codeConverterMise}" m:size="10" m:maxlength="5" style="ime-mode:disabled"/>
    </td>
  </tr>
  <tr>
    <th>オーナー名</th>
    <td>
      <input class="sv_name" type="text" m:id="onerNameKj" m:value="#{recentConditionDto.onerNameKj}" m:size="44" m:maxlength="40"/>
    </td>
    <th>保有店名</th>
    <td>
      <input  class="sv_name" type="text" m:id="miseNameKj" m:value="#{recentConditionDto.miseNameKj}" m:size="44" m:maxlength="40"/>
    </td>
  </tr>
  <tr>
    <th>SVコード</th>
    <td>
      <input type="text" m:id="svCd" m:value="#{recentConditionDto.svCd}" m:converter="#{codeConverterSv}" m:size="10" m:maxlength="8" style="ime-mode:disabled"/>
    </td>
    <th>SV名称</th>
    <td>
      <input  class="sv_name" type="text" m:id="svNameKj" m:value="#{recentConditionDto.svNameKj}" m:size="44" m:maxlength="40"/>
    </td>
  </tr>
  <tr>
	<th>解約オーナー</th>
	<td>
		<input type="radio" name="end" value="outEnd" m:passthrough="true" checked="checked"/>含まない&nbsp;
		<input type="radio" name="end" value="inEnd" m:passthrough="true"/>含む
	</td>
	<th>ソート順</th>
	<td>
		<input type="radio" name="sort" value="ONER_CD"  m:passthrough="true" checked="checked"/>コード順&nbsp;
		<input type="radio" name="sort" value="ONER_NAME_KNA" m:passthrough="true"/>オーナー名称順(カナ順)
	</td>
  </tr>
</table>
<span m:rendered="#{ownerSearchConditionDto.onerSearchListSize != 0}">
<table class="body_table2" style="margin-top:5px">
  <tr class="header_row">
    <th width="115px">オーナーコード</th>
    <th width="290px">オーナー名</th>
    <th width="*">オーナー名（カナ）</th>
    <th m:rendered="#{ownerSearchConditionDto.inEnd == 'inEnd'}" width="90px">解約日</th>
 </tr>
</table>
<div class="scroll_area">
	<table class="body_table2" style="border-top-width : 0px;">
	    <div m:inject="s:forEach" m:items="#{ownerSearchConditionDto.onerSearchList}" m:var="e" m:varindex="i">
	      <tr class="non_top_border">
	        <td width="115px">
	          <span m:value="#{e.onerCd}"/></td>
	        <td width="290px">
			  <a href="#" onclick="selectOwner('#{i}')">
		        <span m:converter="#{characterEncodingConverter}" m:value="#{e.onerNameKj}"/></a></td>
	        <td width="*">
	          <span m:converter="#{characterEncodingConverter}" m:value="#{e.onerNameKna}"/></td>
	        <td m:rendered="#{ownerSearchConditionDto.inEnd == 'inEnd'}" width="90px">
		          <span m:value="#{e.keiyakuEnd}" m:converter="#{documentsearchDateConverter}"/>
		        </td>
	      </tr>
	    </div>
	</table>
</div>
</span>
<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
<script type="text/javascript">
<!--
	focusElement("ownerSearch");
-->
</script>
</span>
</body>
</html>
