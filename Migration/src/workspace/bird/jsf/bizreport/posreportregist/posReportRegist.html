<html xmlns:m="http://www.seasar.org/maya" m:action="#{posReportRegistAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<title>POS速報設定登録</title>
<span m:inject="f:param" m:name="layoutTitle" m:value="POS速報設定登録"/>
<span m:inject="s:insert" m:name="bodyTitleName">■POS速報設定登録</span>
<span m:inject="f:param" m:name="onLoadName" m:value="load();"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBR007V01"/>
</head>
<body>
<span m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
.condition_body {
}
-->
</style>
<script>
<!--
function load() {
	loadScroll("posreportRegistScroll", 298);
}
-->
</script>

<form m:id="posReportRegist">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:value="#{posReportRegistDto.windowId}"/>
<a m:id="searchAction" m:action="#{posReportRegistAction.searchStore}"/>
<input type="hidden" m:id="addRow" m:value="#{posReportRegistDto.addRow}"/>
<input type="hidden" m:id="addRowIndex" m:value="#{posReportRegistDto.addRowIndex}"/>
<input type="submit" value="確認"
       m:action="#{posReportRegistAction.confirm}"
       style="margin-bottom:4px;"/>
<br/>
<div style="font-weight:bold;">
	※現在設定可能な開始日付は <span m:value="#{posReportRegistDto.possibleDtSta}"
                                    m:converter="#{dateConverterYMD}" /> 〜 <span m:value="#{posReportRegistDto.possibleDtEnd}"
                                                                                  m:converter="#{dateConverterYMD}" /> です。<br/>
<span m:rendered="#{posReportRegistDto.mstRealTimeSchedule==null}" m:value="※現在全店集信期間は設定されていません"/></div>
<table width="400px" class="body_table2" style="#{posReportRegistDto.mstRealTimeSchedule!=null?'margin-bottom:5px;':''}margin-bottom:5px;">
	<tr class="header_row">
	  <th></th>
	  <th>集信開始日</th>
	  <th>集信終了日</th>
	  <th>削除</th>
	</tr>
	<tr>
	  <th>全店対象期間</th>
	  <td align="center"><span m:value="#{posReportRegistDto.mstRealTimeSchedule==null?'-':posReportRegistDto.mstRealTimeSchedule.shuDtSta}" m:converter="#{dateConverterYMD}"/></td>
	  <td align="center"><span m:value="#{posReportRegistDto.mstRealTimeSchedule==null?'-':posReportRegistDto.mstRealTimeSchedule.shuDtEnd}" m:converter="#{dateConverterYMD}"/></td>
	  <td align="center"><span m:rendered="#{posReportRegistDto.mstRealTimeSchedule != null && posReportRegistDto.mstRealTimeSchedule.shuDtSta > birdDateInfo.sysDate}">
	  		<input type="checkbox" m:value="#{posReportRegistDto.delete}"/></span></td>
	</tr>
	<tr>
	  <th>全店対象期間(変更)</th>
	  <td align="center"><input type="text" size="14" maxlength="10"
	                            m:id="allShuDtStart" m:value="#{posReportRegistDto.shuDtStart}"
	                            class="imenotuse width_85" m:converter="#{dateConverterYMD}"/></td>
	  <td align="center"><input type="text" size="14" maxlength="10" m:id="allShuDtEnd"
	                            m:id="allShuDtEnd" m:value="#{posReportRegistDto.shuDtEnd}"
	                            class="imenotuse width_85" m:converter="#{dateConverterYMD}"/></td>
	  <td>&nbsp</td>
	</tr>
</table>

<!-- ヘッダー -->
<table width="780px" class="body_table2">
	<tr class="header_row">
	  <th width="50px">削除</th>
	  <th width="50px">SEQ</th>
	  <th width="*">対象店舗</th>
	  <th width="100px">集信開始日</th>
	  <th width="100px">集信終了日</th>
	  <th width="100px">ステータス</th>
	</tr>
</table>

<!-- レコード -->
<div class="scroll_standby" style="width:800px;" id="posreportRegistScroll">
<table width="780px" class="body_table2"
       style="border-top-width:0px">
	<span m:inject="s:forEach" m:items="#{posReportRegistDto.listPosReport}"
	      m:var="e" m:varIndex="i" m:id="listPosReport">
	<tr style="#{!e.insertFlg && e.shuDtSta > birdDateInfo.sysDate?'':'line-height:24px;'}" class="#{i==0?'non_top_border':''}">
	    <td width="50px" align="center"><span m:rendered="#{!e.insertFlg && e.shuDtSta > birdDateInfo.sysDate}"><input type="checkbox" m:id="delFlg" m:value="#{e.delFlg}" /></span></td>
	    <td width="50px" align="right"><span m:converter="#{characterEncodingConverter}" m:value="#{e.seqNo}"/></td>
	    <span m:rendered="#{!e.insertFlg}">
		    <td><span m:converter="#{characterEncodingConverter}" m:value="#{e.miseCd}" />　<span m:converter="#{characterEncodingConverter}" m:value="#{e.miseNameKj}" /></td>
		    <td align="center"><span m:value="#{e.shuDtSta}" m:converter="#{dateConverterYMD}" /></td>
		    <td align="center"><span m:value="#{e.shuDtEnd}" m:converter="#{dateConverterYMD}" /></td></span>
	    <span m:rendered="#{e.insertFlg}">
		<td width="*">
		  	  <input type="text" class="imenotuse width_50" m:id="miseCd" m:converter="#{posReportRegistCdConverter}" value="#{e.miseCd}" size="6" maxlength="5"/>
		  	  <input type="submit" value="検索" m:action="#{posReportRegistAction.searchStore}"><span m:converter="#{characterEncodingConverter}" m:inject="f:param" m:name="selectIndex" m:value="#{i}"/></input>
		    </td>
		<td width="100px" align="center"><input type="text" class="imenotuse width_78"
		               m:id="shuDtSta" value="#{e.shuDtSta}"
		               m:converter="#{dateConverterYMD}" size="14" maxlength="10"/></td>
		<td width="100px" align="center"><input type="text" class="imenotuse width_78"
		               m:id="shuDtEnd" value="#{e.shuDtEnd}"
		               m:converter="#{dateConverterYMD}" size="14" maxlength="10"/></td></span>
	    <td width="100px" align="center"><span m:converter="#{characterEncodingConverter}" m:value="#{e.haisRsltStName}"/></td>
	</tr>

	</span>

</table>

</div>
<table class="height_portal"><tr></tr></table>
<input type="submit" style="margin-top:5px;float:left;"
       value="行追加" m:action="#{posReportRegistAction.addRow}" />

	<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
<script type="text/javascript">
<!--
// 初期設定
function bodyLoad() {
	if(document.posReportRegist.elements['posReportRegist:addRow'].value == "true") {
		var addIndex = document.posReportRegist.elements['posReportRegist:addRowIndex'].value;
		var miseElementName = targetElementName('posReportRegist', 'miseCd', addIndex);
		document.posReportRegist.elements[miseElementName].focus();
	}
	else {
		focusElement('posReportRegist');
	}
	document.posReportRegist.elements['posReportRegist:addRow'].value = "false";
}
-->
</script>

</span>
</body>
</html>
