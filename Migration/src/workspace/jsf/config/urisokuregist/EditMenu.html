<html xmlns:m="http://www.seasar.org/maya" m:action="#{urisokuRegistEditAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>売上速報設定登録(編集画面)</title>
<span m:inject="f:param" m:name="layoutTitle" m:value="売上速報設定登録(編集画面)"/>
<span m:inject="s:insert" m:name="bodyTitleName">■売上速報設定登録(編集画面)</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCF007V04"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
<span m:inject = "f:param" m:name = "msg" m:value="結果が表示されるまでに時間がかかります。よろしいですか？"/>
</head>
<body>
<span m:inject="s:insert" m:name="body" >
<STYLE type="text/css">
<!--
.data_table_width {
    width:732px;
}
.col_seq {
  width:40px;
  text-align  : center;
}
.col_menu {
  width:130px;
}
.col_menuDispMoji {
  width:*;
}
//-->
</STYLE>
<script type="text/javascript">
<!--
function load(){
	var elementName = document.focusElementForm.elements["FOCUS_ELEMENT"].value;
	var selectedTabSub = document.mainForm.elements['mainForm:selectedTabSub'].value;
	var selectedSearchMenuIndex = document.mainForm.elements['mainForm:selectedSearchMenuIndex'].value;
	var objs = document.mainForm.getElementsByTagName("input");
	if(elementName == "") {
		elementName= "menuCd";
	}
	else {
		selectedSearchMenuIndex = document.focusElementForm.elements["FOCUS_ELEMENT_INDEX"].value;
	}
	var targetClassName = selectedTabSub+elementName+selectedSearchMenuIndex;
	for (i = 0; i < objs.length; i++) {
		var classNm = objs[i].className;
		if(classNm == targetClassName){
			objs[i].focus();
			break;
		}
	}
}
/**
 * 戻るボタン押下時処理
 *
 */
function back(confirmMsg){
	if(returnLoadingStatus()) {
		//実行前に確認アラートを出力
		if(confirm(confirmMsg)){
			document.mainForm.target ="_self";
			document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:back';
			document.mainForm.submit();
		}
		else {
			document.mainForm.elements['mainForm:loadingFlg'].value ="";
		}
	}
}
/**
 * 実行ボタン押下時処理
 *
 */
function confirmExec(){
	if(returnLoadingStatus()) {
		document.mainForm.target ="_self";
		document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:confirm';
		document.mainForm.submit();
	}
}

/**
 * ウィンドウロードフラグ設定処理
 *
 *
 */
function setLoadingFlg() {
	document.mainForm.elements['mainForm:loadingFlg'].value = "ON";
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function returnLoadingStatus(){
	if(isLoadingFlgOFF()) {
		setLoadingFlg();
		return true;
	}
	return false;
}
/**
 * ウィンドウロードステータス取得処理
 *
 */
function isLoadingFlgOFF(){
	return (document.mainForm.elements['mainForm:loadingFlg'].value != "ON");
}

/*
 * メインタブ切り替え
 */
function changeTab(targetTab) {
	if(returnLoadingStatus()) {
		document.mainForm.elements['mainForm:selectedTabMain'].value= targetTab;
		document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:changeTab';
		document.mainForm.target ="_self";
		document.mainForm.submit();
	}
}
function changeSubTab(targetTab) {
	document.mainForm.elements['mainForm:selectedTabSub'].value= targetTab;
	changeTabArea(targetTab);
}

/*
 * 表示ステータス変更処理
 */
function changeDisplayForView(targetTag, firstCalssNm, lastClassNm) {
	var objs = document.mainForm.getElementsByTagName(targetTag);
	for (i = 0; i < objs.length; i++) {
		var classNm = objs[i].className;
		if(classNm.substring(0,firstCalssNm.length) == firstCalssNm){
			if(classNm.substring(firstCalssNm.length, firstCalssNm.length+lastClassNm.length) == lastClassNm) {
				objs[i].style.display     = "inline";
			}else{
				objs[i].style.display   = "none";
			}
		}
	}
}
/**
 * 検索ボタン押下時処理
 *
 */
function searchMenu(selectedIndex){
	if(returnLoadingStatus()) {
		document.mainForm.target ="_self";
		document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:searchMenu';
		document.mainForm.elements['mainForm:selectedSearchMenuIndex'].value=selectedIndex;
		document.mainForm.submit();
	}
}
/**
 * 前月コピーボタン押下時処理
 *
 */
function lastMonthDataCopy(){
	if(returnLoadingStatus()) {
		document.mainForm.target ="_self";
		document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:lastMonthDataCopy';
		document.mainForm.submit();
	}
}
/**
 * 全クリアボタン押下時処理
 *
 */
function allClear(){
	if(returnLoadingStatus()) {
		document.mainForm.target ="_self";
		document.mainForm.elements['mainForm:__link_clicked__'].value='mainForm:allClear';
		document.mainForm.submit();
	}
}
//-->
</script>
<form m:id="mainForm" onKeyDown="return setDefaultSubmitButton('mainForm','btnExecute');">
	<input type="hidden" id="viewId" m:value="#{viewIdValue}" />
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" id="windowId" m:value="#{urisokuRegistReqDto.windowId}"/>
	<input type="hidden" id="selectedTabMain" m:value="#{urisokuRegistReqDto.selectedTabMain}"/>
	<input type="hidden" id="selectedTabSub" m:value="#{urisokuRegistReqDto.selectedTabSub}"/>
	<input type="hidden" id="selectedSearchMenuIndex" m:value="#{urisokuRegistReqDto.selectedSearchMenuIndex}"/>
	<input type="hidden"  m:value="#{urisokuRegistReqDto.sesstionKey}"/>
	<input type="hidden" id="loadingFlg" value="" m:passthrough="true"/>
		<a id="changeTab" m:action="#{urisokuRegistEditAction.changeTab}"/>
		<a id="confirm" m:action="#{urisokuRegistEditAction.confirm}"/>
		<a id="back" m:action="#{urisokuRegistEditAction.back}"/>
		<a id="searchMenu" m:action="#{urisokuRegistEditAction.searchMenu}"/>
		<a id="lastMonthDataCopy" m:action="#{urisokuRegistEditAction.lastMonthDataCopy}"/>
		<a id="allClear" m:action="#{urisokuRegistEditAction.allClear}"/>
	<table class="hiddenBody">
		<tr>
		<td>
		<table class="body_table2" >
		    <tr>
		      <th>対象レポート年月</th>
		      <td width="70px"><span m:value="#{urisokuRegistSesDto.taishoYm}" m:converter="#{dateConverterYM}"/></td>
		    </tr>
		</table>
		</td>
		<td>
			&nbsp;<input type="button" value="戻る" onClick="back('編集中の内容がある場合は破棄されます。よろしいですか？');" onDblClick="return false;" m:passthrough="true"/>
		</td>
		<td>
			&nbsp;<input type="button" name="mainForm:btnExecute" m:value="確認" onClick="return confirmExec();" onDblClick="return false;"/>
		</td>
		</tr>
	</table>
	<div style="margin-top:10px;" />
	<table class="data_table_width" cellspacing="0" cellpadding="0">
		<tr>
			<div m:inject="s:forEach" m:items="#{urisokuRegistSesDto.listRegistData}" m:var="uiMainTab" m:varindex="i">
	    		<th width="180px" m:rendered="#{uiMainTab.key==urisokuRegistReqDto.selectedTabMain}" class="view_tab_#{uiMainTab.key} body_active_tab select_border-top">
    		<span m:converter="#{characterEncodingConverter}" m:value="#{uiMainTab.keyName}" /></th>
	    		<th width="180px" m:rendered="#{uiMainTab.key!=urisokuRegistReqDto.selectedTabMain}" class="view_tab_#{uiMainTab.key} body_non_active_tab">
    		<a href="javaScript:void(0); return false;" onClick="changeTab('#{uiMainTab.key}'); return false;" onDblClick="return false;" m:passthrough="true" >
    		<span m:converter="#{characterEncodingConverter}" m:value="#{uiMainTab.keyName}" /></a></th>
   			</div>
		    <th></th>
		  </tr>
		<tr class="tab_area" style="height:5px;"><td colspan="5"></td></tr>
	</table>
	<table class="data_table_width  element_browser" cellspacing="0" cellpadding="0">
		<tr class="tab_area">
			<td align="left" colspan="5">
	    		<table cellspacing="0">
	    			<tr m:inject="s:forEach" m:items="#{urisokuRegistSesDto.listRegistDataMenu}" m:var="uiSubTab" m:varindex="i">
			    		<td width="80px"
			    		    class="body_#{(uiSubTab.key==urisokuRegistReqDto.selectedTabSub) ? '' : 'non_'}active_cell tab_change_area_#{uiSubTab.key} select_border-top">
		    		<a href="javaScript:changeSubTab('#{uiSubTab.key}');"  m:passthrough="true" >
		    		<span m:converter="#{characterEncodingConverter}" m:value="#{uiSubTab.keyName}" /></a>
			    		</td>
		   			</tr>
		    	</table>
		    </td>
		</tr>
		<tr class="body_caption" style="height:5px;"><td colspan="5"></td></tr>
	</table>
	<p/>
	<table class="body_table2 element_browser" width="420px">
		<tr class="header_row">
			<th class="col_seq">行数</th>
			<th class="col_menu">メニュー</th>
			<th class="col_menuDispMoji">表示文字列</th>
		</tr>
	</table>
	<div m:inject="s:forEach" m:items="#{urisokuRegistSesDto.listRegistDataMenu}" m:var="uiSubTab" m:varindex="g">
		<div class="#{uiSubTab.key==urisokuRegistReqDto.selectedTabSub? '':'in'}visible_tab tab_change_area_#{uiSubTab.key}">
		<!--印刷用-->
		<div class="element_print">
		【<span m:converter="#{characterEncodingConverter}" m:value="#{uiSubTab.keyName}"/>】<br/>
			<table class="body_table2" width="420px">
				<tr class="header_row">
					<th class="col_seq">行数</th>
					<th class="col_menu">メニュー</th>
					<th class="col_menuDispMoji">表示文字列</th>
				</tr>
			</table>
		</div>
		<table class="hiddenBody">
			<tr>
				<td>
					<div class="scroll_area" style="width:440px;height:345px;">
					<table class="body_table2" width="420px" style="border-top-width:0px;">
					    <div m:inject="s:forEach" m:items="#{uiSubTab.listData}" m:var="e" m:varindex="m">
						    <tr class="non_top_border">
						    	<td class="col_seq"><span m:converter="#{characterEncodingConverter}" m:value="#{m+1}"/></td>
						    	<td class="col_menu">&nbsp;<input type="button" value="検索" onClick="searchMenu(#{m});" m:passthrough="true"/>&nbsp;<input type="text" class="#{uiSubTab.key}menuCd#{m} input_width_menu" m:value="#{e.menuCd}" size="8" maxlength="6" style="ime-mode:disabled"/>&nbsp;</td>
						    	<td class="col_menuDispMoji"><input type="text" class="#{uiSubTab.key}dispWord#{m} input_width_menuDispMoji" m:value="#{e.dispWord}" size="40" maxlength="15" onFocus="this.style.imeMode='active';"/></td>
						    </tr>
					    </div>

					</table>
					</div>
				</td>
				<td valign="top">
			    	&nbsp;<input type="button" value="前月分コピー" onClick="lastMonthDataCopy();" m:passthrough="true"/>
			    	&nbsp;<input type="button" value="全クリア" onClick="allClear();" m:passthrough="true"/>
			    </td>
			</tr>
		</table>
		</div>
    </div>
	<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>
</body>
</html>
