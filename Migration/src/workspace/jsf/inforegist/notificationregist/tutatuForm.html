<html xmlns:m="http://www.seasar.org/maya" m:action="#{notificationRegistConditionAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title>お知らせ登録</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="お知らせ登録"/>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
<span m:inject="s:insert" m:name="bodyTitleName">■お知らせ登録</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BIF002V01"/>
<span m:inject="f:param" m:name="sysDate" m:value="#{birdDateInfo.sysDate}"/>
<span m:inject="s:insert" m:name="body">
<script type="text/javascript">
<!--
	function load(){
		loadScroll("tutatuScroll", 390);
		var elementName = document.focusElementForm.elements["FOCUS_ELEMENT"].value;
		if(elementName == "") {
			var listSize = document.notificationRegist.elements["LIST_SIZE"].value;
			var targetIndex = document.notificationRegist.elements["SELECTED_INDEX"].value;
			if(listSize>0 && targetIndex > 0) {
				//スクロールエリアの一番下へフォーカスを当てる。
				document.location.hash = "bottomscroll";
				//選択していたラジオボタンの行フォーカスを当てる。
				document.location.hash = "forcusPoint"+targetIndex;
				return;
			}
		}
		focusElement("notificationRegist");
	}

	function downLoad(index) {
		document.notificationRegist.elements["notificationRegist:downloadIndex"].value=index;
	}
//-->
</script>
<STYLE type="text/css">
<!--
table.body_table2 {
	width: 98%;
}
/** 選択ラジオボタン幅 */
.col_select {
	width: 30px;
	text-align: center;
}
/** タイトル幅 */
.col_title {
	width: *;
}
/** 関連ファイル幅 */
.col_listattachfile {
	width: 390px;
}
/** 管理番号幅 */
.col_kanrino {
	width: 95px;
}
/** 公開開始日 */
.col_pubdate {
	width: 110px;
}
/** 管理番号改行 */
.line_wrap {
	word-break:break-all;
}
-->
</STYLE>

<form m:id="notificationRegist" onKeyDown="return setDefaultSubmitButton('notificationRegist','dummyEnter');">
	<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
	<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
	<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
	<input type="hidden" name="LIST_SIZE" m:value="#{notificationRegistConditionDto.listTutatuSize}" m:passthrough="true"/>
	<input type="hidden" name="SELECTED_INDEX" m:value="#{notificationRegistConditionDto.selectedListIndex}" m:passthrough="true"/>
	<input type="hidden" m:id="downloadIndex" m:value="#{notificationRegistConditionDto.downloadIndex}"/>

	<table class="hiddenBody" style="width:98%">
		<tr>
		    <td width="100px">
		        <input type="button" value="新規登録" class="operation_button" m:action="#{notificationRegistConditionAction.goInsert}"/>&nbsp;
		    </td>
			<td width="200px" m:rendered="#{notificationRegistConditionDto.listTutatu != null}">
				<input type="button" value="編集" class="operation_button" m:action="#{notificationRegistConditionAction.goRegist}"/>&nbsp;
				<input type="button" value="削除" class="operation_button" m:action="#{notificationRegistConditionAction.goDelete}"/>&nbsp;
			</td>
			<td align="right" m:rendered="#{notificationRegistConditionDto.listTutatu != null}">
			<table border="0" CELLPADDING="1" CELLSPACING="0">
				<tr>
					<td>
						<input type="submit" id="jumpfirst" value="最初へ"
						       m:action="#{notificationRegistConditionAction.changePage}"
						       m:disabled="#{notificationRegistConditionDto.firstPage}" >
							<span m:inject="f:param" m:name="selectPageNumber" m:value="#{notificationRegistConditionDto.firstPageNumber}"/>
						</input>
					</td>
					<td>&nbsp;&nbsp;</td>
					<td>
						<input type="submit" value="前へ"
						       m:action="#{notificationRegistConditionAction.changePage}"
						       m:disabled="#{!notificationRegistConditionDto.existPreviousPage}" >
							<span m:inject="f:param" m:name="selectPageNumber" m:value="#{notificationRegistConditionDto.previousPageNumber}"/>
						</input>
					</td>
					<td>&nbsp;&nbsp;</td>
					<td>
						<input type="submit" value="次へ"
						       m:action="#{notificationRegistConditionAction.changePage}"
						       m:disabled="#{!notificationRegistConditionDto.existNextPage}" >
							<span m:inject="f:param" m:name="selectPageNumber" m:value="#{notificationRegistConditionDto.nextPageNumber}"/>
						</input>
					</td>
					<td>&nbsp;&nbsp;</td>
					<td>
						<input type="submit" value="最後へ"
						       m:action="#{notificationRegistConditionAction.changePage}"
						       m:disabled="#{notificationRegistConditionDto.lastPage}" >
							<span m:inject="f:param" m:name="selectPageNumber" m:value="#{notificationRegistConditionDto.lastPageNumber}"/>
						</input>
					</td>
					<td>&nbsp;&nbsp;</td>
					<td>
						<span m:value="#{notificationRegistConditionDto.currentPageNumber}"/>&nbsp;/&nbsp;<span m:value="#{notificationRegistConditionDto.lastPageNumber}"/>&nbsp;ページ
					</td>
				</tr>
			</table>
			</td>
		</tr>
	</table>

	<table class="hiddenBody" style="margin-top:4px;margin-bottom:4px;">
	<tr>
		<td>
			<table class="body_table">
				<tr>
					<th>カテゴリー選択</th>
					<td>
			          <div class="hideArea">
						<select class="condition_field"
						        m:id="cateId"
								m:value="#{notificationRegistConditionDto.cateId}"
								m:items="#{notificationRegistConditionDto.listCategory}"
								m:itemValue="cateId"
								m:itemLabel="cateName">
							<option value="">選択</option>
						</select>
			          </div>
					</td>
					<th>対象年月</th>
					<td>
			          <div class="hideArea">
						<select class="condition_field"
						        m:id="nengetu"
								m:value="#{notificationRegistConditionDto.nengetu}"
								m:items="#{notificationRegistConditionDto.listNengetu}"
								m:itemValue="value"
								m:itemLabel="label"
								>
							<option value="200708">2007/08</option>
							<option value="200707">2007/07</option>
							<option value="200706">2007/06</option>
						</select>
			          </div>
					</td>
					<th>管理番号</th>
					<td><input type="text" m:id="kanriNo" m:value="#{notificationRegistConditionDto.kanriNo}" class="imenotuse" maxlength="24"/></td>
				</tr>
			</table>
		</td>
		<td>
			&nbsp;<input type="button" value="検索" class="operation_button" m:action="#{notificationRegistConditionAction.search}" />
		</td>
		<td m:rendered="#{notificationRegistFormDto.todayInsertDLBt}">
			&nbsp;<input type="button" value="本日登録分ダウンロード"
			             m:action="#{notificationRegistCsvTodayInsertDataAction.downloadCsv}"
			             onClick="document.notificationRegist.elements['notificationRegist:sysDate'].value='#{sysDate}';"
			             onDblClick="return false;"/>
					<input type="hidden" m:id="sysDate" m:value="#{notificationRegistCsvDownloadDto.sysDate}"/>
		</td>
	</tr>
	</table>

	<span m:rendered="#{notificationRegistConditionDto.listTutatu != null}">
	<!-- お知らせ一覧 -->

		<div class="scroll_padding_head">
		<div class="scroll_hidden margin_bottom_hidden">
		<table class="body_table2">
		<colgroup>
			<col class="col_select"/>
			<col class="col_pubdate"/>
			<col class="col_title"/>
			<col class="col_listattachfile"/>
			<col class="col_kanrino"/>
		</colgroup>
			<tr class="header_row">
				<th>&nbsp;</th>
				<th>公開開始日</th>
				<th>タイトル/サブタイトル</th>
				<th>ファイル</th>
				<th>お知らせ<br/>管理No</th>
			</tr>
		</table>
		</div>
</div>
<div class="scroll_padding_data">
		<div class="scroll_standby" id="tutatuScroll">
			<div m:inject="s:selectOneRadio2" m:value="#{notificationRegistConditionDto.selectedListIndex}" m:required="true">
			<table class="body_table2" style="border-top-width:0px">
				<colgroup>
					<col class="col_select"/>
					<col class="col_pubdate"/>
					<col class="col_title"/>
					<col class="col_listattachfile"/>
					<col class="col_kanrino"/>
				</colgroup>
				<div m:inject="s:forEach" m:items="#{notificationRegistConditionDto.listTutatu}" m:var="e" m:varindex="i">
					<tr class="non_top_border" style="#{e.listAttachFileSize != 0?'line-height:24px;':''}">
						<td align="center"><input type="radio" m:value="#{i}"/><a name="forcusPoint#{i}"  m:passthrough="true"/></td>
						<td class="font_size_15"><span m:value="#{e.pubDate}" m:converter="#{dateCnvtSlashYMDW}"/></td>
						<td>
							<a m:action="#{notificationRegistDownloadAction.download}" onClick="downLoad(#{i})" title="#{e.fileName}">
								<span m:converter="#{characterEncodingConverter}" m:value="#{e.title}"/>
							</a>
							<br>
							<span m:converter="#{characterEncodingConverter}" m:value="#{e.subTitle}"/>
						</td>
						<td>
							<div m:rendered="#{e.listAttachFileSize != 0}">
								<div class="hideArea">
									<select class="condition_field"
											m:value="#{e.selectedAttachFileIndex}"
											m:items="#{e.listAttachFile}"
											m:itemValue="value"
											m:itemLabel="label"
											m:nullLabel="">
										<option value="">添付ファイル１</option>
									</select>
								</div>
								<input type="button" value="ダウンロード" class="operation_button" m:onclick="downLoad(#{i})" m:action="#{notificationRegistDownloadActionTenpu.download}"/>
							</div>
						</td>
						<td class="font_size_14 line_wrap"><span m:converter="#{characterEncodingConverter}" m:value="#{e.kanriNo}"/></td>
					</tr>
				</div>
			</table>
			</div>
			<a name="bottomscroll"  m:passthrough="true"/>
		</div>
	</span>
	<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>
</body>
</html>
