<html xmlns:m="http://www.seasar.org/maya" m:action="#{contactRegistEditAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<meta http-equiv="Content-Style-Type" content="text/css"/>
<title>連絡登録（編集画面）</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="連絡登録（編集画面）"/>
<span m:inject="f:param" m:name="onLoadName" m:value=""/>
<span m:inject="s:insert" m:name="bodyTitleName">■連絡登録（編集画面）</span>
<span m:inject="f:param" m:name="viewIdValue" m:value="BIF001V02"/>
<div m:inject="s:insert" m:name="body">

<SCRIPT LANGUAGE="javascript">
<!--
function downloadKanren(index) {
	document.contactRegistEdit.elements["contactRegistEdit:downloadKanrenIndex"].value=index;
}
-->
</SCRIPT>

<style type="text/css">
<!--
.field_message {
	height				: 120px;
	width				: 580px;
}
.field_title {
	width				: 450px;
}
-->
</style>
<form m:id="contactRegistEdit" enctype="multipart/form-data" onKeyDown="return setDefaultSubmitButton('contactRegistEdit','dummyEnter');">
<input type="hidden" m:id="downloadKanrenIndex" m:value="#{contactRegistDto.downloadKanrenIndex}"/>

<input type="submit" value="戻る" m:action="#{contactRegistEditAction.cancel}"/>&nbsp;
<input type="submit" value="確認" m:action="#{contactRegistEditAction.confirm}" />
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>

	<table class="body_table2" style="width:885px;margin-top:4px;border-bottom-width:0px;">
	<tr>
		<th width="160px">登録モード</th>
		<td colspan="3"><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.editModeName}"/></td>
	</tr>
	<tr>
		<th>カテゴリー</th>
		<td colspan="3" >
			<div class="hideArea">
			    <select class="field_category"
			            m:id="contactcate"
			    		m:value="#{contactRegistDto.cateId}"
	                    m:items="#{contactRegistDto.categoryList}"
	                    m:itemValue="cateId"
	                    m:itemLabel="cateName">
	                <option value="">全社</option>
	                <option value="">モスフードサービス</option>
	            </select>
			</div>
		</td>
	</tr>
	<tr>
		<th>タイトル</th>
		<td colspan="3">
			<input type="text" m:id="contactTitle"class="field_title"
			       m:value="#{contactRegistDto.title}" maxlength="40"/>
		</td>
	</tr>

	<tr>
		<th>メッセージ</th>
		<td colspan="3">
			<textarea m:id="contactmsg" class="field_message"
			          m:value="#{contactRegistDto.message}" m:converter="#{changeLineEditConverter}"/></td>
	</tr>
	<tr>
		<th rowspan="#{contactRegistDto.listKanrenBunshoSize+1}" nowrap="true">既存文書にリンク</th>
		<th style="width:20px;"></th>
		<th colspan="2">タイトル
			<input type="button" m:value="リンクファイル選択" m:action="#{contactRegistEditAction.callFormKanrenBunsho}"/>
			<input type="button" m:value="削除" m:action="#{contactRegistEditAction.deleteKanrenBunsho}"/>
		</th>
	</tr>

	<div m:inject="s:forEach" m:items="#{contactRegistDto.listKanrenBunsho}" m:var="e" m:varindex="i">
	<tr>
		<td style="width:20px;text-align:center"><input type="checkbox" m:value="#{e.checkedDoc}"/></td>
		<td colspan="2">
			<a m:action="#{contactRegistDownloadKanrenAction.download}" onClick="downloadKanren(#{i})">
				<span m:converter="#{characterEncodingConverter}" m:value="#{e.title}" m:title="#{e.fileName}"/></a></td>
	</tr>
	</div>

	<tr>
	    <th rowspan="5" width="160px">添付ファイル登録</th>
	    <th colspan="2" width="318px">添付ファイルタイトル</th>
	    <td widht="395px"></td>
	</tr>
	<tr>
	  <td colspan="2">
		<span m:rendered="#{contactRegistDto.blankIndex <= 3}">
	        <input class="width_280" type="text" m:size="53" id="uploadFileTitle"
	               m:value="#{contactRegistDto.inputTitle}" maxlength="40" />
	    </span>
		<span m:rendered="#{contactRegistDto.blankIndex >= 4}">
	        <input type="text" m:size="53" size="40" disabled="disabled" maxlength="40"/>
	    </span>
	  </td>
	  <td nowrap="true">
		<span m:rendered="#{contactRegistDto.blankIndex <= 3}">
			<span m:converter="#{characterEncodingConverter}" m:inject="x:inputFileUpload" id="uploadTenpuFile" m:value="#{contactRegistDto.uploadedFile}"
			      m:size="33"/>
	        <input type="submit" value="決定" m:action="#{contactRegistEditAction.upload}"/>
	    </span>
		<span m:rendered="#{contactRegistDto.blankIndex >= 4}">
			<input type="file" disabled="disabled" m:size="33"/>
	        <input type="submit" value="決定" disabled="disabled"/>
	    </span>
	    <input type="submit" value="削除" m:action="#{contactRegistEditAction.delete}"/>
      </td>
	</tr>
	<tr>
		<td style="width:20px;text-align:center"><input type="checkbox" m:value="#{contactRegistDto.checkAttachFile1}"/></td>
		<td width="295px"><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachName1}"/></td>
		<td width="395px"><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachFl1}"/></td>
	</tr>
	<tr>
		<td style="text-align:center"><input type="checkbox" m:value="#{contactRegistDto.checkAttachFile2}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachName2}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachFl2}"/></td>
	</tr>
	<tr>
		<td style="text-align:center"><input type="checkbox" m:value="#{contactRegistDto.checkAttachFile3}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachName3}"/></td>
		<td><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.attachFl3}"/></td>
	</tr>
</table>
<table class="body_table2" style="width:885px;border-top-width:0px;">
	<tr class="non_top_border">
		<th colspan="2" width="160px">公開開始日</th>
		<td width="300px">
			<div class="hideArea">
			    <select m:id="contactpubDate"
			    		m:value="#{contactRegistDto.pubDate}"
	                    m:items="#{contactRegistDto.listKokaiKaisi}"
	                    m:itemValue="value"
	                    m:itemLabel="label">
	            </select>
			</div>
		</td>
		<th width="75px">登録者</th>
		<td width="335px" colspan="2"><span m:converter="#{characterEncodingConverter}" m:value="#{contactRegistDto.userNameKj}">海山 太郎</span></td>
	</tr>
	<tr>
		<th rowspan="5" style="width:70px;">公開対象</th>
		<th width="87px">会社</th>
		<td colspan="2" width="378px">
		    <div m:inject="s:forEach" m:items="#{contactRegistPublicTargetDto.listTrnControlCompany}" m:var="e" m:varindex="i">
		    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.companyName}"/></div>
		    </div>
		</td>
		<td rowspan="5" width="109px">
			<input type="submit" value="公開対象選択"
		              m:action="#{contactRegistEditAction.callForm}"/></td>
		<td rowspan="5" width="223px"></td>
	</tr>
	<tr>
		<th>所属</th>
		<td colspan="2">
		    <div m:inject="s:forEach" m:items="#{contactRegistPublicTargetDto.listTrnControlShozoku}" m:var="e" m:varindex="i">
		    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.shozokuName}"/></div>
		    </div>
		</td>
	</tr>
	<tr>
		<th>業態</th>
		<td colspan="2">
		    <div m:inject="s:forEach" m:items="#{contactRegistPublicTargetDto.listTrnControlGyotai}" m:var="e" m:varindex="i">
		    	<div><span m:converter="#{characterEncodingConverter}" m:value="#{e.gyotaiKbnName}"/></div>
		    </div>
		</td>
	</tr>
	<tr>
		<th>業態別設定</th>
		<td colspan="2">
			<div m:rendered="#{contactRegistPublicTargetDto.listTrnControlGyotaiKobetuSize > 0}">有</div>
			<div m:rendered="#{contactRegistPublicTargetDto.listTrnControlGyotaiKobetuSize <= 0}">無</div>
		</td>
	</tr>
	<tr>
		<th>個店別設定</th>
		<td colspan="2">
            <div m:rendered="#{contactRegistPublicTargetDto.listTrnControlGyotaiTenpoSize > 0}">
                <span style="float:left;">有</span>
                <span style="float:right;"><input type="button"  m:value="指定店舗ダウンロード" m:action="#{contactregistCsvAction.download}"/></span>
                <span style="clear:both;"/>
            </div>
			<div m:rendered="#{contactRegistPublicTargetDto.listTrnControlGyotaiTenpoSize <= 0}">無</div>
		</td>
	</tr>
</table>

<script type="text/javascript">
<!--
	focusElement("contactRegistEdit");
-->
</script>
<input type="text" m:id="dummyEnter" style="display:none"/>

</form>
</div>
</body>
</html>
