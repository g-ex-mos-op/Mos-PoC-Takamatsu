<html xmlns:m="http://www.seasar.org/maya" m:action="#{moscardNipoRefConditionAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j"/>
<title>MOS CARD</title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="MOS CARD"/>
<span m:inject="s:insert" m:name="bodyTitleName">■MOS CARD</span>
<span m:inject="f:param" m:name="onLoadName" m:value="bodyLoad();"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BBR015V01"/>
<div m:inject="s:insert" m:name="body">
<style type="text/css">
<!--
-->
</style>

<script type="text/javascript">
<!--
// 初期設定
function bodyLoad() {
}
// 店舗種別プルダウン変更処理
function switchDisplayObj() {
	document.getElementById('nipoRefCondition:div_tenpoShuTitle').style.display="none";
	document.getElementById('nipoRefCondition:div_tenpoShu').style.display="none";

	var taishoTenpo = document.nipoRefCondition.elements['nipoRefCondition:compTaishoTenpo'].selectedIndex;
	if(taishoTenpo == 1) {
		document.getElementById('nipoRefCondition:div_tenpoShu').style.display="inline";
	} else {
		document.getElementById('nipoRefCondition:div_tenpoShuTitle').style.display="inline";
	}
}
// 対象期間プルダウン変更処理
function switchDisplayKikan() {
	document.getElementById('nipoRefCondition:div_kibetsushiteinipo').style.display="none";
	document.getElementById('div_tougetsugepo').style.display="none";
	document.getElementById('nipoRefCondition:div_tsukibetsugepo').style.display="none";
	document.getElementById('nipoRefCondition:div_kibetsukihou').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanshitei').style.display="none";

	var taishoKikan = document.nipoRefCondition.elements['nipoRefCondition:kikanTaisho'].selectedIndex;
	if(taishoKikan == 0) {
		document.getElementById('nipoRefCondition:div_kibetsushiteinipo').style.display="inline";
	}else if(taishoKikan == 1) {
		document.getElementById('div_tougetsugepo').style.display="inline";
	}else if(taishoKikan == 2) {
		document.getElementById('nipoRefCondition:div_tsukibetsugepo').style.display="inline";
	}else if(taishoKikan == 3) {
		document.getElementById('nipoRefCondition:div_kibetsukihou').style.display="inline";
	}else if(taishoKikan == 4) {
		document.getElementById('nipoRefCondition:div_kikanshitei').style.display="inline";
	}
}
// 対象期間＆前年データ種別 プルダウン変更処理(オーナー用)
function switchDisplayKikanOner(targetForm) {

    //対象期間プルダウン初期状態
	document.getElementById(nipoRefCondition:'div_kikanNipo').style.display="none";
	document.getElementById('div_kikanCurrMonth').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanYM').style.display="none";
	document.getElementById('nipoRefCondition:div_kikanSitei').style.display="none";
    document.getElementById('nipoRefCondition:div_gepocsv_oner').style.display="none";

	//前年データ種別プルダウン初期状態
	document.getElementById('div_zenData_oner').style.display="inline";

	var taishoKikan = targetForm.elements[targetForm.id+':kikanTaishoOner'].selectedIndex;
	if(taishoKikan == 0) {
		document.getElementById('nipoRefCondition:div_kikanNipo').style.display="inline";
	}else if(taishoKikan == 1) {
		document.getElementById('div_kikanCurrMonth').style.display="inline";
	}else if(taishoKikan == 2) {
		document.getElementById('nipoRefCondition:div_kikanYM').style.display="inline";
	}else if(taishoKikan == 3) {
		document.getElementById('nipoRefCondition:div_kikanSitei').style.display="inline";
	}else if(taishoKikan == 4) {
		document.getElementById('nipoRefCondition:div_gepocsv_oner').style.display="inline";

		//前年データ種別プルダウン変更処理
		document.getElementById('div_zenData_oner').style.display="none";
	}
}
// 集計区分プルダウン変更処理 2008/12/09追加 SV対応
function switchShukeiKbn(elementShukeiKbn) {
	var taishoTenpo = elementShukeiKbn.selectedIndex;

	var commonClassName = "taisho_";
	if(taishoTenpo == 2) {
		dispSwitchElement("th",commonClassName, "tenpo", "none");
		dispSwitchElement("td",commonClassName, "tenpo", "none");
		dispSwitchElement("th",commonClassName, "svCd", "inline");
		dispSwitchElement("td",commonClassName, "svCd", "inline");
	}else {
		dispSwitchElement("th",commonClassName, "svCd", "none");
		dispSwitchElement("td",commonClassName, "svCd", "none");
		dispSwitchElement("th",commonClassName, "tenpo", "inline");
		dispSwitchElement("td",commonClassName, "tenpo", "inline");
	}
}

// SV検索 2008/12/09追加 SV対応
function doCallSVForm() {
    document.nipoRefCondition.target = "_self";
	document.forms['nipoRefCondition'].elements['nipoRefCondition:__link_clicked__'].value='nipoRefCondition:callSvForm';
	document.forms['nipoRefCondition'].submit();
}


/**
 * 対象クラスエレメント表示切り替え処理
 */
function dispSwitchElement(targetTag, commonClassName, targetCode, status) {
	var objsDiv = document.nipoRefCondition.getElementsByTagName(targetTag);
	for (i = 0; i < objsDiv.length; i++) {
		var classNm = objsDiv[i].className;
		if(classNm.indexOf(commonClassName)>=0){
			if(classNm.indexOf(targetCode)>=0) {
				objsDiv[i].style.display = status;
			}
		}
	}
}

// ダウンロード(営業月報抽出)
function downloadCsvGepo(targetForm) {
	targetForm.target = "_self";
	targetForm.elements[targetForm.id+':__link_clicked__'].value=targetForm.id+':downloadCsvGepo';
	targetForm.submit();
	return;
}
/**
 * オーナー用実行ボタン押下処理
 */
function executeOnerSearch(targetForm) {
    //対象期間プルダウンで、営業月報抽出が選択されている場合、別ウィンドウ表示しない。
	var taishoKikan = targetForm.elements[targetForm.id+':kikanTaishoOner'].selectedIndex;
	if (taishoKikan == 4) {
		downloadCsvGepo(targetForm);
		return;
	}
	targetForm.elements[targetForm.id+':__link_clicked__'].value=targetForm.id+':search';
	targetForm.submit();
}

-->
</script>

<form m:id="nipoRefCondition" onkeydown="setDefaultSubmitButton('nipoRefCondition', 'btnExecute');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="windowId" m:value="#{nipoRefSearchParameterDto.windowId}"/>
<input type="hidden" m:id="typeCd" m:value="#{nipoRefConditionDto.birdUserInfo.mstUser.userTypeCd}"/>
<a id="callSvForm" m:action="#{moscardNipoRefConditionAction.callSvForm}"/>
<table m:rendered="#{'01'==nipoRefConditionDto.userTypeCd}" cellspacing="0" cellpadding="0">
	<tr>
	<td>
		<!-- 条件部プルダウン(本部用) -->
		<table class="body_table">
			<tr class="button_tr">
				<th nowrap=" nowrap">会社</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:value="#{nipoRefSearchParameterDto.companyCd}"
								m:items="#{moscardNipoRefConditionAction.moscardCompanyList}"
								m:itemValue="companyCd"
								m:itemLabel="companyName"/></div>
				</td>
				<th nowrap=" nowrap">店舗種別</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:value="#{nipoRefSearchParameterDto.tenpoShubetuCd}"
								m:items="#{nipoRefConditionDto.tenpoShubetuList}"
								m:id="compTaishoTenpo"
								m:itemValue="code"
								m:itemLabel="name"
								m:onchange="switchDisplayObj();"/></div>
				</td>
				<th nowrap=" nowrap">集計区分</th>
				<td>
					<div class="hideArea">
						<select class="condition_field"
								m:value="#{nipoRefSearchParameterDto.shukeiKbnCd}"
								m:items="#{nipoRefConditionDto.shukeiKbnList}"
								m:onchange="switchShukeiKbn(this);"/></div>
				</td>
				<th class="taisho_tenpo" style="#{nipoRefSearchParameterDto.svFlg ? 'display:none;' : ''}" nowrap=" nowrap">対象店舗</th>
				<td class="taisho_tenpo" style="#{nipoRefSearchParameterDto.svFlg ? 'display:none;' : ''}">
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.taishoTenpoCd}"
								m:items="#{nipoRefConditionDto.taishoTenpoList}"/></div>
				</td>
				<th class="taisho_svCd"
				    style="#{'SV_CD'==nipoRefSearchParameterDto.shukeiKbnCd ? '' : 'display:none;'}"
				    nowrap=" nowrap">SVコード<input type="button" m:id="doSearchSVBtn" value="検索"
				                                    onclick="doCallSVForm();" ondblclick="return false;"
				                                    class="button_in_table height_21"/></th>
				<td class="taisho_svCd" style="#{nipoRefSearchParameterDto.svFlg ? '' : 'display:none;'}">
					<input type="text" m:id="textNipoCondSV"
					       m:value="#{nipoRefSearchParameterDto.svCd}"
					       class="imenotuse height_11" maxlength="8" size="15" /></td>
			</tr>
			<tr>
				<th nowrap=" nowrap">対象期間</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.taishoKikanCd}"
								m:items="#{nipoRefConditionDto.taishoKikanList}"
								m:id="kikanTaisho"
								m:itemValue="code"
								m:itemLabel="name"
								m:onchange="switchDisplayKikan();"/></div>
				</td>
				<th nowrap=" nowrap">期間指定</th>
				<td colspan="3">
					<div class="hideArea">
						<div id="div_kibetsushiteinipo" class="div_kibetsushiteinipo" style="#{(nipoRefSearchParameterDto.taishoKikan1Day) == true  ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanNipo}"
									m:items="#{nipoRefConditionDto.kikanFromList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_tougetsugepo" class="div_tougetsugepo"></div>
						<div id="div_tsukibetsugepo" class="div_tsukibetsugepo" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='MONTH') == true  ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanYM}"
									m:items="#{nipoRefConditionDto.kikanYMList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_kibetsukihou" class="div_kibetsukihou" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='KIBETU') == true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanYear}"
										m:items="#{nipoRefConditionDto.kikanYearList}"
										m:itemValue="code"
										m:itemLabel="name"/>
							年度<select m:value="#{nipoRefSearchParameterDto.kikanKibetu}"
										m:items="#{nipoRefConditionDto.kikanKibetuList}"
										m:itemValue="code"
										m:itemLabel="name"/></div>
						<div id="div_kikanshitei" class="div_kikanshitei" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='DAYS') == true  ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.kikanFrom}"
										m:items="#{nipoRefConditionDto.kikanFromList}"
										m:itemValue="code"
										m:itemLabel="name"/>
							〜<select m:value="#{nipoRefSearchParameterDto.kikanTo}"
										m:items="#{nipoRefConditionDto.kikanToList}"
										m:itemValue="code"
										m:itemLabel="name"/></div></div>
				</td>
				<th nowrap=" nowrap">前年データ種別</th>
				<td>
					<div class="hideArea" style="float:left;">
						<div id="div_tenpoShuTitle" class="div_tenpoShuTitle"
						     style="#{nipoRefSearchParameterDto.selectedZennenTaishoTen==true ? 'display:none;' : ''}">
							<select m:value="#{nipoRefSearchParameterDto.zenDataZennenOthCd}"
									m:items="#{nipoRefConditionDto.zenDataZennenOthList}"
									m:itemValue="code"
									m:itemLabel="name"/></div>
						<div id="div_tenpoShu" class="div_tenpoShu"
						     style="#{nipoRefSearchParameterDto.selectedZennenTaishoTen==true ? '' : 'display:none;'}">
							<select m:value="#{nipoRefSearchParameterDto.zenDataZennenCd}"
									m:items="#{nipoRefConditionDto.zenDataZennenList}"
									m:itemValue="code"
									m:itemLabel="name"/></div></div>
				</td>
			</tr>
		</table>
	</td>
	<td valign="bottom">
		<input type="button" m:id="btnExecute" value="実行"
		        m:action="#{moscardNipoRefConditionAction.search}" onDblClick="return false;" style="margin:2px;"/>
	</td>
	</tr>
</table>

<input type="text" m:id="dummyText" m:style="display:none;"/>
</form>
<!-- 条件部プルダウン(オーナー用) -->
<form m:id="nipoRefOnerCondition" onkeydown="setDefaultSubmitButton('nipoRefOnerCondition', 'btnExecute');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}" />
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<input type="hidden" m:id="windowId" m:value="#{nipoRefSearchParameterDto.windowId}"/>
<input type="hidden" m:id="typeCd" m:value="#{nipoRefConditionDto.birdUserInfo.mstUser.userTypeCd}"/>
<a id="search" m:action="#{moscardNipoRefConditionAction.search}"/>
<a id="downloadCsvGepo" m:action="#{moscardNipoRefConditionAction.downloadCsvGepo}"/>
<table m:rendered="#{'02' ==nipoRefConditionDto.userTypeCd}" cellspacing="0" cellpadding="0">
	<tr>
	<td>
		<table class="body_table">
			<tr>
				<th nowrap=" nowrap">会社</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.companyCd}"
								m:items="#{nipoRefConditionDto.companyList}"
								m:itemValue="companyCd"
								m:itemLabel="companyName"/></div>
				</td>
				<th nowrap=" nowrap">前年データ種別</th>
				<td>
			<div class="hideArea">
					    <div id="div_zenData_oner" class="div_zenData_oner" style="#{'GEPOCSV'==nipoRefSearchParameterDto.taishoKikanCd?'display:none;':''}">
							<select m:value="#{nipoRefSearchParameterDto.zenDataZennenOthCd}"
									m:items="#{nipoRefConditionDto.zenDataZennenOthList}"
									m:itemValue="code"
									m:itemLabel="name"/></div></div>
				</td>
				<th nowrap=" nowrap">対象期間</th>
				<td>
					<div class="hideArea">
						<select m:value="#{nipoRefSearchParameterDto.taishoKikanCd}"
								m:items="#{nipoRefConditionDto.listOnerTaishoKikan}"
								m:itemValue="code"
								m:itemLabel="name"
								m:id="kikanTaishoOner"
								m:onchange="switchDisplayKikanOner(this.form);"/></div>
				</td>
				<th nowrap=" nowrap">期間指定</th>
				<td>
			<div class="hideArea">
				<div id="div_kikanNipo" class="div_kikanNipo" style="#{nipoRefSearchParameterDto.taishoKikan1Day ? '' : 'display:none;'}">
					<select m:value="#{nipoRefSearchParameterDto.kikanNipo}"
							m:items="#{nipoRefConditionDto.kikanFromList}"
							m:id="kikanNipo"
							m:itemValue="code"
							m:itemLabel="name"/></div>
				<div id="div_kikanCurrMonth" class="div_kikanCurrMonth"></div>
				<div id="div_kikanYM" class="div_kikanYM" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='MONTH') == true  ? '' : 'display:none;'}">
					<select m:value="#{nipoRefSearchParameterDto.kikanYM}"
							m:items="#{nipoRefConditionDto.kikanYMList}"
							m:id="kikanYM"
							m:itemValue="code"
							m:itemLabel="name"/></div>
				<div id="div_kikanSitei" class="div_kikanSitei" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='DAYS') == true  ? '' : 'display:none;'}">
					<table style="border-width:0px;padding:0px;border-collapse:collapse;">
								<tr><td style="border-width:0px;padding:0px;">
						<select m:value="#{nipoRefSearchParameterDto.kikanFrom}"
								m:items="#{nipoRefConditionDto.kikanFromList}"
								m:id="kikanFrom"
								m:itemValue="code"
								m:itemLabel="name"/></td>
					<td style="border-width:0px;padding:0px;">〜</td>
					<td style="border-width:0px;padding:0px;"><select m:value="#{nipoRefSearchParameterDto.kikanTo}"
								m:items="#{nipoRefConditionDto.kikanToList}"
								m:id="kikanTo"
								m:itemValue="code"
								m:itemLabel="name"/></td>
					</tr></table></div>
			    <div id="div_gepocsv_oner" class="div_gepocsv_oner" style="#{(nipoRefSearchParameterDto.taishoKikanCd=='GEPOCSV') ? '' : 'display:none;'}">
					<select m:value="#{nipoRefSearchParameterDto.kikanGepoYM}"
							m:items="#{nipoRefConditionDto.kikanGepoYMList}"
							m:itemValue="code"
							m:itemLabel="name"/></div></div>
				</td>
			</tr>
		</table>
	</td>
	<td valign="bottom">
		<input type="button" m:id="btnExecute"  value="#{nipoRefSearchParameterDto.researchFlg=='true'?'再検索':'実行'}"
		       onClick="executeOnerSearch(this.form);" onDblClick="return false;" style="margin:2px;"/>
	</td>
</tr>
</table>
</form>
</div>
</body>
</html>