<html xmlns:m="http://www.seasar.org/maya" m:action="#{documentSearchAction.initialize}" m:extends="/jsf/layout/layoutNoNavi.html">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-31j" />
<title></title>
</head>
<body>
<span m:inject="f:param" m:name="layoutTitle" m:value="関連文書"/>
<span m:inject="s:insert" m:name="bodyTitleName">■関連文書選択</span>
<span m:inject="f:param" m:name="onLoadName" m:value="load()"/>
<span m:inject="f:param" m:name="viewIdValue" m:value="BCO001V01"/>
<span m:inject="s:insert" m:name="body">
<STYLE type="text/css">
<!--
table.body_table2{
  width				: 98%;
}
//-->
</STYLE>
<SCRIPT LANGUAGE="javascript">
<!--
function load() {
	loadScroll("documentScroll", 380);
	focusElement('documentSearch');
}
function initCateList(){
    //カテゴリ選択
	document.forms['documentSearch'].elements['documentSearch:__link_clicked__'].value='documentSearch:loadCateList';
	document.forms['documentSearch'].submit();
	return false;
}
function initSubCateList(){
    //サブカテゴリ選択
	document.forms['documentSearch'].elements['documentSearch:__link_clicked__'].value='documentSearch:loadSubCateList';
	document.forms['documentSearch'].submit();
	return false;
}
function clearForm(formobj) {
    for (i = 0; i < formobj.elements.length; i++) {
        if (formobj.elements[i].type == "text") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "textarea") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "file") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "password") {
            formobj.elements[i].value = "";
        } else if (formobj.elements[i].type == "checkbox") {
            formobj.elements[i].checked = formobj.elements[i].defaultChecked;
            formobj.elements[i].checked = false;
        } else if (formobj.elements[i].type == "radio") {
            formobj.elements[i].checked = formobj.elements[i].defaultChecked;
        } else if (formobj.elements[i].type == "select-one") {
            for (j = 0; j < formobj.elements[i].options.length; j++) {
                formobj.elements[i].options[j].selected = formobj.elements[i].options[j].defaultSelected;
            }
            formobj.elements[i].selectedIndex = -1;
            formobj.elements[i].selectedIndex = 0;
        } else if (formobj.elements[i].type == "select-multiple") {
            for (j = 0; j < formobj.elements[i].options.length; j++) {
                formobj.elements[i].options[j].selected = formobj.elements[i].options[j].defaultSelected;
            }
            formobj.elements[i].selectedIndex = -1;
        }
    }
}
function downLoad(index) {
	document.documentSearch.elements["documentSearch:downloadIndex"].value=index;
}
//-->
</SCRIPT>
<form m:id="documentSearch" onKeyDown="return setDefaultSubmitButton('documentSearch','btnExecute');">
<input type="hidden" m:id="viewId" m:value="#{viewIdValue}"/>
<input type="hidden" m:id="initMenuId" m:value="#{menuAction.initMenuId}"/>
<input type="hidden" m:id="initSubMenuId" m:value="#{menuAction.initSubMenuId}"/>
<table cellpadding="0" cellspacing="0" width="98%">
<tr>
<td width="200px">
	<input type="button" value="戻る" m:action="#{documentSearchAction.cancel}"/>&nbsp;
	<input type="button" value="決定" m:action="#{documentSearchAction.select}" style="#{(documentSearchConditionDto.documentListSize > 0) == true ? '' : 'display:none;'}"/>
</td>
<td m:rendered="#{documentSearchConditionDto.documentListSize > 0}">
	<table width="98%" cellspacing="0" cellpadding="0">
      <tr>
		<td align="right">
			<input type="submit" value="最初へ" m:action="#{documentSearchAction.changePage}" m:disabled="#{documentSearchConditionDto.firstPage}">
				<span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentSearchConditionDto.firstPageNumber}"/>
			</input>
			<input type="submit" value="前へ" m:action="#{documentSearchAction.changePage}" m:disabled="#{!documentSearchConditionDto.existPreviousPage}">
				<span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentSearchConditionDto.previousPageNumber}"/>
			</input>
			<input type="submit" value="次へ" m:action="#{documentSearchAction.changePage}" m:disabled="#{!documentSearchConditionDto.existNextPage}">
				<span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentSearchConditionDto.nextPageNumber}"/>
			</input>
			<input type="submit" value="最後へ" m:action="#{documentSearchAction.changePage}" m:disabled="#{documentSearchConditionDto.lastPage}">
				<span m:inject="f:param" m:name="selectPageNumber" m:value="#{documentSearchConditionDto.lastPageNumber}"/>
			</input>
			&nbsp;&nbsp;
			<span m:value="#{documentSearchConditionDto.currentPageNumber}"/> / <span m:value="#{documentSearchConditionDto.lastPageNumber}"/>&nbsp;ページ
	  	</td>
	  </tr>
	</table>
</td>
</tr>
</table>

<input type="hidden" m:id="downloadIndex" m:value="#{documentSearchConditionDto.downloadIndex}"/>
	<a id="loadCateList" m:action="#{documentSearchAction.loadCateList}"/>
	<a id="loadSubCateList" m:action="#{documentSearchAction.loadSubCateList}"/>
	<table class="hiddenBody" style="margin-top:4px;">
		<tr>
			<td>
	<table class="body_table">
	  <tr>
	    <th>タイプ</th>
	    <td>
	      <div class="hideArea width_190">
	        <select class="width_120" m:value="#{documentSearchConditionDto.infoShu}"
	                m:items="#{documentSearchConditionDto.infoShuList}"
	                m:itemValue="infoShu"
	                m:itemLabel="infoShuName"
	                m:onChange="initCateList();">
	            <option value="">タイプ</option>
	        </select>
	      </div>
	    </td>
	    <th>カテゴリー</th>
	    <td>
	      <div class="hideArea width_180">
	        <select class="width_110" m:value="#{documentSearchConditionDto.cateId}"
	                m:items="#{documentSearchConditionDto.cateList}"
	                m:itemValue="cateId"
	                m:itemLabel="cateName"
	                m:nullLabel=" "
	                m:onChange="initSubCateList();">
	            <option value="">カテゴリー</option>
	        </select>
	      </div>
	    </td>
	    <th>サブカテゴリー</th>
	    <td>
	      <span m:rendered="#{documentSearchConditionDto.existListSubCate}">
	      <div class="hideArea">
	        <select m:value="#{documentSearchConditionDto.subCateId}"
	                m:items="#{documentSearchConditionDto.subCateList}"
	                m:itemValue="subCateId"
	                m:itemLabel="subCateName"
	                m:nullLabel=" " >
	            <option value="">サブカテゴリー</option>
	        </select>
	      </div>
	      </span>
	    </td>
	  </tr>
	  <tr>
	    <th>タイトル</th>
	    <td colspan="3">
			<input class="width_410" type="text" m:value="#{documentSearchConditionDto.title}"
			size="80" maxlength="80"/></td>
	    <th>対象年月</th>
	    <td>
	      <div class="hideArea">
	        <select m:value="#{documentSearchConditionDto.date}"
	                m:items="#{documentSearchConditionDto.targetDateList}"
	                m:nullLabel=" " >
	            <option value="">2007/08</option>
	        </select>
	      </div>
	    </td>
	  </tr>
	</table>
			</td>
			<td valign="bottom">
				&nbsp;<input type="button" m:id="btnExecute" value="検索" m:action="#{documentSearchAction.search}" class="operation_button"/>
			</td>
		</tr>
	</table>

	<span m:rendered="#{documentSearchConditionDto.documentListSize > 0}">
		<div class="scroll_padding_head">
		<div class="scroll_hidden margin_bottom_4">
		<table class="body_table2" style="margin-top:5px;">
		  <tr class="header_row">
		    <th width="40px">選択</th>
		    <th width="200px">カテゴリー</th>
		    <th width="200px">サブカテゴリー</th>
		    <th width="*">タイトル</th>
		  </tr>
		</table>
		</div>
		</div>
		<div class="scroll_padding_data">
		<div class="scroll_standby" id="documentScroll">
		<table class="body_table2" style="border-top-width:0px;">
		  <span m:inject="s:forEach" m:items="#{documentSearchConditionDto.documentList}" m:var="e" m:varindex="i">
		    <tr class="non_top_border">
		        <td width="40px" align="center">
		    	  <input type="checkbox" m:value="#{e.checkedDoc}"/>
		        </td>
		        <td width="200px">
		    	  <span m:converter="#{characterEncodingConverter}" m:value="#{e.cateName}"/>
		    	</td>
		        <td width="200px">
		          <span m:converter="#{characterEncodingConverter}" m:value="#{e.subCateName}"/>
		    	</td>
		        <td width="*">
		          <a m:action="#{downloadAction.download}" onClick="downLoad(#{i})">
		            <span m:converter="#{characterEncodingConverter}" m:value="#{e.title}"/>
				  </a>
		    	</td>
		    </tr>
		  </span>
		</table>
		</div>
		</div>
	</span>
<input type="text" m:id="dummyEnter" style="display:none"/>
</form>
</span>
</body>
</html>
